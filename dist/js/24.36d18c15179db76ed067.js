(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{1033:function(r,e,n){"use strict";n.r(e);var t=n(32),a=n.n(t),l=n(9),o=n(8),i=n(2),s=(n(1),n(524),n(3)),m=Object(s.a)({components:{},props:["dialogInfo","dialogFormVisible"],data:function(){return{formLabelWidth:"100px",hash:1,hashOptions:[{label:"散列",value:1},{label:"连续",value:0}],ruleForm:{uuid:"",xml:"",name:"",hash:1,step:"",start:"",end:""},rules:{xml:[{required:!0,message:"请输入xml属性字段",trigger:"blur"}],name:[{required:!0,message:"请输入释义",trigger:"blur"},{max:24,message:"文案限制24个字符，包括标点符号",trigger:"change"}],step:[{require:!0,message:"请输入范围步长",trigger:"blur"}],start:[{require:!0,message:"请输入开始范围",trigger:"blur"}],end:[{require:!0,message:"请输入结束范围",trigger:"blur"}]},dialogVisible:!1}},computed:{},methods:{submit:function(){if(!this.ruleForm.xml)return this.$message("请输入xml属性字段"),!1;if(!this.ruleForm.name)return this.$message("请输入释义"),!1;if(24<this.ruleForm.name.length)return this.$message("文案限制24个字符，包括标点符号"),!1;if(0===this.hash){if(!this.ruleForm.start)return this.$message("开始范围不能为空！"),!1;if(!this.ruleForm.end)return this.$message("结束范围不能为空！"),!1;if(!this.ruleForm.step)return this.$message("范围步长不能为空！"),!1}this.ruleForm.hash=this.hash,this.$emit("submitForm",this.dialogInfo.dialogType,this.ruleForm)},resetForm:function(r){this.$refs[r]&&(this.$refs[r].resetFields(),this.ruleForm={uuid:"",xml:"",name:"",hash:1,step:"",start:"",end:""},this.hash=0)},closeDialog:function(){this.$emit("closeDialog")}},created:function(){},mounted:function(){this.ruleForm=this.dialogInfo.form},watch:{dialogInfo:{handler:function(r){"add"==r.dialogType?this.resetForm("ruleForm"):(this.ruleForm=this.dialogInfo.form,this.hash=this.ruleForm.hash)},deep:!0},dialogFormVisible:function(r){this.dialogVisible=!!r}}},function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("el-dialog",{ref:"dialog",staticClass:"dialog-container",attrs:{title:"add"==r.dialogInfo.dialogType?"新增属性":"编辑属性",width:"50%","show-close":!0,"close-on-click-modal":!1},on:{close:r.closeDialog},model:{value:r.dialogVisible,callback:function(e){r.dialogVisible=e},expression:"dialogVisible"}},[n("div",{staticClass:"dialog-form"},[n("el-form",{ref:"ruleForm",staticClass:"formInputWidth",attrs:{rules:r.rules,model:r.ruleForm}},[n("el-form-item",{attrs:{label:"xml","label-width":r.formLabelWidth,prop:"xml"}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:r.ruleForm.xml,callback:function(e){r.$set(r.ruleForm,"xml",e)},expression:"ruleForm.xml"}})],1),r._v(" "),n("el-form-item",{attrs:{label:"释义","label-width":r.formLabelWidth,prop:"name"}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:r.ruleForm.name,callback:function(e){r.$set(r.ruleForm,"name",e)},expression:"ruleForm.name"}})],1),r._v(" "),n("el-form-item",{attrs:{label:"类型","label-width":r.formLabelWidth,prop:"hash"}},[n("el-select",{attrs:{placeholder:"请选择类型"},model:{value:r.hash,callback:function(e){r.hash=e},expression:"hash"}},r._l(r.hashOptions,function(r){return n("el-option",{key:r.value,attrs:{label:r.label,value:r.value}})}),1)],1),r._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:0===r.hash,expression:"hash ===0"}]},[n("el-form-item",{attrs:{label:"开始","label-width":r.formLabelWidth,prop:"start"}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:r.ruleForm.start,callback:function(e){r.$set(r.ruleForm,"start",e)},expression:"ruleForm.start"}})],1),r._v(" "),n("el-form-item",{attrs:{label:"结束","label-width":r.formLabelWidth,prop:"end"}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:r.ruleForm.end,callback:function(e){r.$set(r.ruleForm,"end",e)},expression:"ruleForm.end"}})],1),r._v(" "),n("el-form-item",{attrs:{label:"步长","label-width":r.formLabelWidth,prop:"step"}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:r.ruleForm.step,callback:function(e){r.$set(r.ruleForm,"step",e)},expression:"ruleForm.step"}})],1)],1)],1),r._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(){return r.resetForm("ruleForm")}}},[r._v("重置")]),r._v(" "),n("span",{staticClass:"wd"},[r._v(" ")]),r._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(){return r.submit("ruleForm")}}},[r._v("确认")])],1)],1)])},[],!1,null,"172ba57e",null).exports,d={components:{DataTable:l.a,TabPage:o.a,attributeForm:m},data:function(){var r=new Date;return{detailData:{},deviceOptions:[{value:"ALL",name:"ALL"},{value:"iPhone",name:"iOS"},{value:"Android",name:"Android"}],searchParam:{device:"ALL",dateRange:[new Date(r.setDate(r.getDate()-30)),new Date]},dataTable:{pageSize:10,pageSizes:[10,20,50,100,1e3],type:"get",url:"/web/v1/attribute",queryParams:{},emptyText:"没有记录"},loading2:!0,dialogInfos:{dialogType:"",form:{uuid:null,xml:"",name:"",hash:"",start:"",end:"",step:""}},showDialog:!1}},mounted:function(){this.$refs.tabPage.$emit("open-tab",{label:"监控客群属性集管理",name:"default",slotName:"firstTabPage",closable:!1})},methods:{clearForm:function(){this.dialogInfos={dialogType:"add",form:{uuid:"",xml:"",name:"",hash:"",start:"",end:"",step:""}}},showFormDialog:function(){this.showDialog=!0},closeFormDialog:function(){this.showDialog=!1},add:function(){this.dialogInfos.dialogType="add",this.clearForm(),this.showFormDialog()},edit:function(r){this.dialogInfos.dialogType="edit",this.dialogInfos.form={uuid:r.uuid,xml:r.xml,name:r.name,hash:r.hash,start:r.start,end:r.end,step:r.step},this.showFormDialog()},remove:function(r){var e=this;this.$confirm("确认删除此客群监控属性?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i.a.ajax({url:"/web/v1/attribute/"+r.uuid,type:"delete",contentType:"application/json",data:a()({}),dataType:"json",success:function(){e.$message({type:"success",message:"删除成功!"}),e.$refs.dataTable.$emit("load-data")},error:function(r){var n=r.message||r;r.message&&e.$alert(n,"",{type:"error",confirmButtonText:"知道了",callback:function(){}})}})})},submitFormHandle:function(){var r=this,e=void 0,n=0>=arguments.length?void 0:arguments[0],t="POST",l="/web/v1/attribute",o=1>=arguments.length?void 0:arguments[1],s=o.uuid,m=o.name,d=o.xml,u=o.hash,p=o.start,c=o.end,A=o.step;"add"==n?e="新增成功":(e="编辑成功",t="put",l=l+"/"+s),i.a.ajax({url:l,type:t,data:a()({name:m,xml:d,hash:u,start:p,end:c,step:A}),uploadFiles:!0,dataType:"json",contentType:"application/json",processData:!1,success:function(){r.alertMessage=e,r.$alert(e,"",{type:"success",confirmButtonText:"知道了",callback:function(){r.closeFormDialog()}})},error:function(e){var n=e.message||e;r.alertMessage=n,e.message&&r.$alert(r.alertMessage,"",{type:"error",confirmButtonText:"知道了",callback:function(){}})},complete:function(){r.$refs.dataTable.$emit("load-data")}})},formatterType:function(r){return 1===r.hash?"散列":"连续"}}},u=(n(526),n(528),Object(s.a)(d,function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",[n("tab-page",{ref:"tabPage"},[n("template",{slot:"firstTabPage"},[n("data-table",{ref:"dataTable",staticStyle:{width:"100%"},attrs:{"data-table":r.dataTable,border:"","default-sort":{prop:"date",order:"descending"}}},[n("div",{attrs:{slot:"conditions"},slot:"conditions"},[n("div",{staticClass:"opera-btn"},[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:r.add}},[r._v(" 新增属性")])],1)]),r._v(" "),n("template",{slot:"columns"},[n("el-table-column",{attrs:{prop:"uuid",label:"uuid",align:"center",width:"70",sortable:""}}),r._v(" "),n("el-table-column",{attrs:{prop:"xml",label:"变量XML字段",align:"center",sortable:""}}),r._v(" "),n("el-table-column",{attrs:{prop:"name",label:"释义",align:"center",sortable:""}}),r._v(" "),n("el-table-column",{attrs:{prop:"hash",label:"类型",align:"center",width:"80",formatter:r.formatterType,sortable:""}}),r._v(" "),n("el-table-column",{attrs:{prop:"step",label:"步长",align:"center",width:"80",sortable:""}}),r._v(" "),n("el-table-column",{attrs:{prop:"start",label:"开始范围",align:"center",width:"100",sortable:""}}),r._v(" "),n("el-table-column",{attrs:{prop:"end",label:"结束范围",align:"center",width:"100",sortable:""}}),r._v(" "),n("el-table-column",{attrs:{prop:"created_at",label:"创建日期",align:"center",width:"100",sortable:""}}),r._v(" "),n("el-table-column",{attrs:{prop:"updated_at",label:"更新日期",align:"center",width:"100",sortable:""}}),r._v(" "),n("el-table-column",{attrs:{label:"操作",width:"120",align:"center"},scopedSlots:r._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(){return r.edit(e.row)}}},[r._v("编辑")]),r._v(" "),n("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(){return r.remove(e.row)}}},[r._v("删除")])]}}])})],1)],2),r._v(" "),n("attribute-form",{attrs:{dialogInfo:r.dialogInfos,dialogFormVisible:r.showDialog},on:{submitForm:r.submitFormHandle,closeDialog:r.closeFormDialog}})],1)],2)],1)},[],!1,null,"616e248b",null));e.default=u.exports},162:function(r,e,n){var t=n(525);"string"==typeof t&&(t=[[r.i,t,""]]),t.locals&&(r.exports=t.locals);(0,n(5).default)("9c7ff60a",t,!0,{})},163:function(r,e,n){var t=n(527);"string"==typeof t&&(t=[[r.i,t,""]]),t.locals&&(r.exports=t.locals);(0,n(5).default)("77246661",t,!0,{})},164:function(r,e,n){var t=n(529);"string"==typeof t&&(t=[[r.i,t,""]]),t.locals&&(r.exports=t.locals);(0,n(5).default)("2e2b6b32",t,!0,{})},524:function(r,e,n){"use strict";var t=n(162);n.n(t).a},525:function(r,e,n){(r.exports=n(4)(!0)).push([r.i,'\n.el-dialog__wrapper .el-dialog--customer .el-dialog__header[data-v-172ba57e] {\r\n  text-align: center;\n}\n.dialog-form[data-v-172ba57e] {\r\n  width: 380px;\n}\n.el-select[data-v-172ba57e] {\r\n  width: 200px;\n}\n.el-input[data-v-172ba57e] {\r\n  width: 200px;\n}\n.el-select .el-input[data-v-172ba57e] {\r\n  width: 260px;\n}\n.el-select-dropdown__item[data-v-172ba57e] {\r\n  max-width: 500px;\n}\n.dialog-footer[data-v-172ba57e] {\r\n  text-align: center;\n}\n.el-upload ul[data-v-172ba57e] {\r\n  display: none;\n}\n.download-btn[data-v-172ba57e] {\r\n  text-align: center;\r\n  display: inline-block;\r\n  font-size: 12px;\r\n  border-radius: 5px;\r\n  line-height: 30px;\r\n  padding: 0 8px;\r\n  outline: none;\r\n  color: #ffffff;\r\n  background-color: #20a0ff;\r\n  box-sizing: border-box;\n}\n.wd[data-v-172ba57e] {\r\n  display: inline-block;\r\n  width: 50px;\n}\n.self-line-height[data-v-172ba57e] {\r\n  line-height: 36px;\n}\n.self-line-height2[data-v-172ba57e] {\r\n  line-height: 48px;\n}\n.label-wrapper[data-v-172ba57e] {\r\n  width: 100px;\n}\n.self-label[data-v-172ba57e] {\r\n  text-align: right;\r\n  padding-right: 20px;\n}\n.el-row[data-v-172ba57e] {\r\n  height: 50px;\r\n  line-height: 50px;\n}\n.el-form-item__label[data-v-172ba57e] {\r\n  width: 200px;\n}\n.text[data-v-172ba57e] {\r\n  font-size: 14px;\n}\n.item[data-v-172ba57e] {\r\n  padding: 10px 20px;\r\n  margin: 10px 0;\n}\n.clearfix[data-v-172ba57e]:before,\r\n.clearfix[data-v-172ba57e]:after {\r\n  display: table;\r\n  content: "";\n}\n.clearfix[data-v-172ba57e]:after {\r\n  clear: both;\n}\n.box-card[data-v-172ba57e] {\r\n  width: 300px;\r\n  margin-right: 20px;\n}\n.txt-center[data-v-172ba57e] {\r\n  text-align: center;\n}\n.jc-between[data-v-172ba57e] {\r\n  justify-content: space-between;\n}\n.mt-30[data-v-172ba57e] {\r\n  margin-top: 50px;\n}\n.left[data-v-172ba57e] {\r\n  float: right;\n}\n.form-content-width[data-v-172ba57e] {\r\n  width: 420px;\n}\n.mb-30[data-v-172ba57e] {\r\n  margin-bottom: 22px;\n}\r\n',"",{version:3,sources:["src/views/contents/risk/attributeForm.vue"],names:[],mappings:";AA2DA;EACA,kBAAA;AACA;AAEA;EACA,YAAA;AACA;AAEA;EACA,YAAA;AACA;AAEA;EACA,YAAA;AACA;AAEA;EACA,YAAA;AACA;AAEA;EACA,gBAAA;AACA;AAEA;EACA,kBAAA;AACA;AAEA;EACA,aAAA;AACA;AAEA;EACA,kBAAA;EACA,qBAAA;EACA,eAAA;EACA,kBAAA;EACA,iBAAA;EACA,cAAA;EACA,aAAA;EACA,cAAA;EACA,yBAAA;EACA,sBAAA;AACA;AAEA;EACA,qBAAA;EACA,WAAA;AACA;AAEA;EACA,iBAAA;AACA;AAEA;EACA,iBAAA;AACA;AAEA;EACA,YAAA;AACA;AAEA;EACA,iBAAA;EACA,mBAAA;AACA;AAEA;EACA,YAAA;EACA,iBAAA;AACA;AAEA;EACA,YAAA;AACA;AAEA;EACA,eAAA;AACA;AAEA;EACA,kBAAA;EACA,cAAA;AACA;AAEA;;EAEA,cAAA;EACA,WAAA;AACA;AAEA;EACA,WAAA;AACA;AAEA;EACA,YAAA;EACA,kBAAA;AACA;AAEA;EACA,kBAAA;AACA;AAEA;EACA,8BAAA;AACA;AAEA;EACA,gBAAA;AACA;AAEA;EACA,YAAA;AACA;AAEA;EACA,YAAA;AACA;AAEA;EACA,mBAAA;AACA",file:"attributeForm.vue?vue&type=style&index=0&id=172ba57e&scoped=true&lang=css&",sourcesContent:['\x3c!--\r\n * @Description: \r\n * @Author: jinxiaojian\r\n * @Email: jinxiaojian@youxin.com\r\n * @Date: 2019-07-12 16:17:33\r\n * @LastEditTime: 2019-07-16 16:56:36\r\n * @LastEditors: 靳肖健\r\n --\x3e\r\n<template>\r\n  <el-dialog\r\n    ref="dialog"\r\n    :title="dialogInfo.dialogType ==\'add\'?\'新增属性\':\'编辑属性\'"\r\n    width="50%"\r\n    class="dialog-container"\r\n    v-model="dialogVisible"\r\n    :show-close="true"\r\n    @close="closeDialog"\r\n    :close-on-click-modal="false"\r\n  >\r\n    <div class="dialog-form">\r\n      <el-form class="formInputWidth" :rules="rules" ref="ruleForm" :model="ruleForm">\r\n        <el-form-item label="xml" :label-width="formLabelWidth" prop="xml">\r\n          <el-input v-model="ruleForm.xml" auto-complete="off"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label="释义" :label-width="formLabelWidth" prop="name">\r\n          <el-input v-model="ruleForm.name" auto-complete="off"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label="类型" :label-width="formLabelWidth" prop="hash">\r\n          <el-select v-model="hash" placeholder="请选择类型">\r\n            <el-option\r\n              v-for="item in hashOptions"\r\n              :key="item.value"\r\n              :label="item.label"\r\n              :value="item.value"\r\n            ></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <div v-show="hash ===0">\r\n          <el-form-item label="开始" :label-width="formLabelWidth" prop="start">\r\n            <el-input v-model="ruleForm.start" auto-complete="off"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label="结束" :label-width="formLabelWidth" prop="end">\r\n            <el-input v-model="ruleForm.end" auto-complete="off"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label="步长" :label-width="formLabelWidth" prop="step">\r\n            <el-input v-model="ruleForm.step" auto-complete="off"></el-input>\r\n          </el-form-item>\r\n        </div>\r\n      </el-form>\r\n      <div slot="footer" class="dialog-footer">\r\n        <el-button @click="resetForm(\'ruleForm\')">重置</el-button>\r\n        <span class="wd">&nbsp;</span>\r\n        <el-button type="primary" @click="submit(\'ruleForm\')">确认</el-button>\r\n      </div>\r\n    </div>\r\n  </el-dialog>\r\n</template>\r\n\r\n<style scoped>\r\n.el-dialog__wrapper .el-dialog--customer .el-dialog__header {\r\n  text-align: center;\r\n}\r\n\r\n.dialog-form {\r\n  width: 380px;\r\n}\r\n\r\n.el-select {\r\n  width: 200px;\r\n}\r\n\r\n.el-input {\r\n  width: 200px;\r\n}\r\n\r\n.el-select .el-input {\r\n  width: 260px;\r\n}\r\n\r\n.el-select-dropdown__item {\r\n  max-width: 500px;\r\n}\r\n\r\n.dialog-footer {\r\n  text-align: center;\r\n}\r\n\r\n.el-upload ul {\r\n  display: none;\r\n}\r\n\r\n.download-btn {\r\n  text-align: center;\r\n  display: inline-block;\r\n  font-size: 12px;\r\n  border-radius: 5px;\r\n  line-height: 30px;\r\n  padding: 0 8px;\r\n  outline: none;\r\n  color: #ffffff;\r\n  background-color: #20a0ff;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.wd {\r\n  display: inline-block;\r\n  width: 50px;\r\n}\r\n\r\n.self-line-height {\r\n  line-height: 36px;\r\n}\r\n\r\n.self-line-height2 {\r\n  line-height: 48px;\r\n}\r\n\r\n.label-wrapper {\r\n  width: 100px;\r\n}\r\n\r\n.self-label {\r\n  text-align: right;\r\n  padding-right: 20px;\r\n}\r\n\r\n.el-row {\r\n  height: 50px;\r\n  line-height: 50px;\r\n}\r\n\r\n.el-form-item__label {\r\n  width: 200px;\r\n}\r\n\r\n.text {\r\n  font-size: 14px;\r\n}\r\n\r\n.item {\r\n  padding: 10px 20px;\r\n  margin: 10px 0;\r\n}\r\n\r\n.clearfix:before,\r\n.clearfix:after {\r\n  display: table;\r\n  content: "";\r\n}\r\n\r\n.clearfix:after {\r\n  clear: both;\r\n}\r\n\r\n.box-card {\r\n  width: 300px;\r\n  margin-right: 20px;\r\n}\r\n\r\n.txt-center {\r\n  text-align: center;\r\n}\r\n\r\n.jc-between {\r\n  justify-content: space-between;\r\n}\r\n\r\n.mt-30 {\r\n  margin-top: 50px;\r\n}\r\n\r\n.left {\r\n  float: right;\r\n}\r\n\r\n.form-content-width {\r\n  width: 420px;\r\n}\r\n\r\n.mb-30 {\r\n  margin-bottom: 22px;\r\n}\r\n</style>\r\n\r\n<script>\r\nimport common from "../../../utils/common";\r\n\r\nexport default {\r\n  components: {},\r\n  props: ["dialogInfo", "dialogFormVisible"],\r\n  data() {\r\n    return {\r\n      formLabelWidth: "100px",\r\n      hash: 1,\r\n      hashOptions: [\r\n        {\r\n          label: "散列",\r\n          value: 1,\r\n        },\r\n        {\r\n          label: "连续",\r\n          value: 0,\r\n        },\r\n      ],\r\n      ruleForm: {\r\n        uuid: "",\r\n        xml: "",\r\n        name: "",\r\n        hash: 1,\r\n        step: "",\r\n        start: "",\r\n        end: "",\r\n      },\r\n      rules: {\r\n        xml: [\r\n          { required: true, message: "请输入xml属性字段", trigger: "blur" },\r\n        ],\r\n        name: [\r\n          { required: true, message: "请输入释义", trigger: "blur" },\r\n          {\r\n            max: 24,\r\n            message: "文案限制24个字符，包括标点符号",\r\n            trigger: "change",\r\n          },\r\n        ],\r\n        //          hash: [\r\n        //            { required: true, message: \'请选择属性类型\', trigger: \'change\' }\r\n        //          ],\r\n        step: [{ require: true, message: "请输入范围步长", trigger: "blur" }],\r\n        start: [{ require: true, message: "请输入开始范围", trigger: "blur" }],\r\n        end: [{ require: true, message: "请输入结束范围", trigger: "blur" }],\r\n      },\r\n      dialogVisible: false,\r\n    };\r\n  },\r\n  computed: {},\r\n  methods: {\r\n    submit(formName) {\r\n      if (!this.ruleForm.xml) {\r\n        this.$message("请输入xml属性字段");\r\n        return false;\r\n      }\r\n      if (!this.ruleForm.name) {\r\n        this.$message("请输入释义");\r\n        return false;\r\n      } else {\r\n        if (this.ruleForm.name.length > 24) {\r\n          this.$message("文案限制24个字符，包括标点符号");\r\n          return false;\r\n        }\r\n      }\r\n\r\n      if (this.hash === 0) {\r\n        if (!this.ruleForm.start) {\r\n          this.$message("开始范围不能为空！");\r\n          return false;\r\n        }\r\n        if (!this.ruleForm.end) {\r\n          this.$message("结束范围不能为空！");\r\n          return false;\r\n        }\r\n        if (!this.ruleForm.step) {\r\n          this.$message("范围步长不能为空！");\r\n          return false;\r\n        }\r\n      }\r\n\r\n      this.ruleForm.hash = this.hash;\r\n\r\n      this.$emit("submitForm", this.dialogInfo.dialogType, this.ruleForm);\r\n    },\r\n\r\n    resetForm(formName) {\r\n      if (this.$refs[formName]) {\r\n        this.$refs[formName].resetFields();\r\n        this.ruleForm = {\r\n          uuid: "",\r\n          xml: "",\r\n          name: "",\r\n          hash: 1,\r\n          step: "",\r\n          start: "",\r\n          end: "",\r\n        };\r\n        this.hash = 0;\r\n      }\r\n    },\r\n    closeDialog() {\r\n      //console.log(\'closeDialog\');\r\n      this.$emit("closeDialog");\r\n    },\r\n  },\r\n  created() {},\r\n  mounted() {\r\n    this.ruleForm = this.dialogInfo.form;\r\n  },\r\n  watch: {\r\n    dialogInfo: {\r\n      handler: function(val, oldVal) {\r\n        if (val.dialogType == "add") {\r\n          this.resetForm("ruleForm");\r\n        } else {\r\n          this.ruleForm = this.dialogInfo.form;\r\n          this.hash = this.ruleForm.hash;\r\n          //console.log(this.ruleForm);\r\n        }\r\n      },\r\n      deep: true,\r\n    },\r\n    //      id:function (val,oldVal) {\r\n    //        this.ruleForm = this.dialogInfo.form;\r\n    //      }\r\n    dialogFormVisible: function(val) {\r\n      this.dialogVisible = !!val;\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n']}])},526:function(r,e,n){"use strict";var t=n(163);n.n(t).a},527:function(r,e,n){(r.exports=n(4)(!0)).push([r.i,"\n.el-select .el-input[data-v-616e248b] {\r\n  width: 100px;\n}\n.pagination_position[data-v-616e248b] {\r\n  padding-top: 20px;\n}\n.echarts[data-v-616e248b] {\r\n  height: 300px;\n}\n.opera-btn[data-v-616e248b] {\r\n  margin-bottom: 10px;\n}\r\n","",{version:3,sources:["src/views/contents/risk/monitoringAttributesManagement.vue"],names:[],mappings:";AAgEA;EACA,YAAA;AACA;AAEA;EACA,iBAAA;AACA;AAEA;EACA,aAAA;AACA;AAEA;EACA,mBAAA;AACA",file:"monitoringAttributesManagement.vue?vue&type=style&index=0&id=616e248b&scoped=true&lang=css&",sourcesContent:["\x3c!--\r\n * @Description: \r\n * @Author: 焦丙乾(jiaobingqian)\r\n * @Email: jiaobq123@163.com\r\n * @Date: 2019-07-15 18:33:54\r\n * @LastEditTime: 2019-07-17 19:42:45\r\n * @LastEditors: 王娇(wangjiao)\r\n --\x3e\r\n<template>\r\n  <div>\r\n    <tab-page ref=\"tabPage\">\r\n      <template slot=\"firstTabPage\">\r\n        <data-table\r\n          :data-table=\"dataTable\"\r\n          ref=\"dataTable\"\r\n          style=\"width: 100%\"\r\n          border\r\n          :default-sort=\"{prop: 'date', order: 'descending'}\"\r\n        >\r\n          \x3c!--<data-table :data-table=\"dataTable\" ref=\"dataTable\">--\x3e\r\n          <div slot=\"conditions\">\r\n            <div class=\"opera-btn\">\r\n              <el-button type=\"primary\" size=\"small\" @click=\"add\">&nbsp;新增属性</el-button>\r\n            </div>\r\n          </div>\r\n          <template slot=\"columns\">\r\n            <el-table-column prop=\"uuid\" label=\"uuid\" align=\"center\" width=\"70\" sortable></el-table-column>\r\n            <el-table-column prop=\"xml\" label=\"变量XML字段\" align=\"center\" sortable></el-table-column>\r\n            <el-table-column prop=\"name\" label=\"释义\" align=\"center\" sortable></el-table-column>\r\n            <el-table-column\r\n              prop=\"hash\"\r\n              label=\"类型\"\r\n              align=\"center\"\r\n              width=\"80\"\r\n              :formatter=\"formatterType\"\r\n              sortable\r\n            ></el-table-column>\r\n            <el-table-column prop=\"step\" label=\"步长\" align=\"center\" width=\"80\" sortable></el-table-column>\r\n            <el-table-column prop=\"start\" label=\"开始范围\" align=\"center\" width=\"100\" sortable></el-table-column>\r\n            <el-table-column prop=\"end\" label=\"结束范围\" align=\"center\" width=\"100\" sortable></el-table-column>\r\n\r\n            <el-table-column prop=\"created_at\" label=\"创建日期\" align=\"center\" width=\"100\" sortable></el-table-column>\r\n            <el-table-column prop=\"updated_at\" label=\"更新日期\" align=\"center\" width=\"100\" sortable></el-table-column>\r\n            <el-table-column label=\"操作\" width=\"120\" align=\"center\">\r\n              <template slot-scope=\"scope\">\r\n                <el-button type=\"primary\" size=\"small\" @click=\"edit(scope.row)\">编辑</el-button>\r\n                <el-button type=\"danger\" size=\"small\" @click=\"remove(scope.row)\">删除</el-button>\r\n              </template>\r\n            </el-table-column>\r\n          </template>\r\n        </data-table>\r\n\r\n        <attribute-form\r\n          :dialogInfo=\"dialogInfos\"\r\n          :dialogFormVisible=\"showDialog\"\r\n          @submitForm=\"submitFormHandle\"\r\n          v-on:closeDialog=\"closeFormDialog\"\r\n        ></attribute-form>\r\n      </template>\r\n    </tab-page>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n.el-select .el-input {\r\n  width: 100px;\r\n}\r\n\r\n.pagination_position {\r\n  padding-top: 20px;\r\n}\r\n\r\n.echarts {\r\n  height: 300px;\r\n}\r\n\r\n.opera-btn {\r\n  margin-bottom: 10px;\r\n}\r\n</style>\r\n<style>\r\n.el-table .cell,\r\n.el-table th > div {\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  box-sizing: border-box;\r\n  text-overflow: ellipsis;\r\n}\r\n</style>\r\n<script>\r\nimport DataTable from '../../../components/DataTable';\r\nimport TabPage from '../../../components/TabPage';\r\n\r\nimport Common from '../../../utils/common';\r\nimport formatDate from '../../../utils/formatDate.js';\r\n\r\nimport attributeForm from './attributeForm.vue';\r\n\r\nexport default {\r\n  components: {\r\n    DataTable,\r\n    TabPage,\r\n    attributeForm\r\n  },\r\n  data() {\r\n    let date = new Date();\r\n    let prevMonth = new Date(date.setDate(date.getDate() - 30));\r\n    let now = new Date();\r\n\r\n    function randomData() {\r\n      return Math.round(Math.random() * 1000);\r\n    }\r\n\r\n    return {\r\n      detailData: {},\r\n      deviceOptions: [\r\n        {\r\n          value: 'ALL',\r\n          name: 'ALL'\r\n        },\r\n        {\r\n          value: 'iPhone',\r\n          name: 'iOS'\r\n        },\r\n        {\r\n          value: 'Android',\r\n          name: 'Android'\r\n        }\r\n      ],\r\n      searchParam: {\r\n        device: 'ALL',\r\n        dateRange: [prevMonth, now]\r\n      },\r\n      dataTable: {\r\n        pageSize: 10,\r\n        pageSizes: [10, 20, 50, 100, 1000],\r\n        type: 'get',\r\n        url: '/web/v1/attribute',\r\n        queryParams: {},\r\n        emptyText: '没有记录'\r\n      },\r\n      loading2: true,\r\n      dialogInfos: {\r\n        dialogType: '',\r\n        form: {\r\n          uuid: null,\r\n          xml: '',\r\n          name: '',\r\n          hash: '',\r\n          start: '',\r\n          end: '',\r\n          step: ''\r\n        }\r\n      },\r\n      showDialog: false\r\n    };\r\n  },\r\n  mounted() {\r\n    var defaultPage = {\r\n      label: '监控客群属性集管理',\r\n      name: 'default',\r\n      slotName: 'firstTabPage',\r\n      closable: false\r\n    };\r\n    this.$refs.tabPage.$emit('open-tab', defaultPage);\r\n  },\r\n  methods: {\r\n    /**\r\n     * 清空form表单数据\r\n     */\r\n    clearForm() {\r\n      this.dialogInfos = {\r\n        dialogType: 'add',\r\n        form: {\r\n          uuid: '',\r\n          xml: '',\r\n          name: '',\r\n          hash: '',\r\n          start: '',\r\n          end: '',\r\n          step: ''\r\n        }\r\n      };\r\n    },\r\n    showFormDialog() {\r\n      this.showDialog = true;\r\n    },\r\n    closeFormDialog() {\r\n      this.showDialog = false;\r\n    },\r\n    /**\r\n     * 新增\r\n     */\r\n    add: function() {\r\n      this.dialogInfos.dialogType = 'add';\r\n      this.clearForm();\r\n      this.showFormDialog();\r\n    },\r\n    /**\r\n     * 编辑\r\n     */\r\n    edit: function(row) {\r\n      this.dialogInfos.dialogType = 'edit';\r\n      this.dialogInfos.form = {\r\n        uuid: row.uuid,\r\n        xml: row.xml,\r\n        name: row.name,\r\n        hash: row.hash,\r\n        start: row.start,\r\n        end: row.end,\r\n        step: row.step\r\n      };\r\n      this.showFormDialog();\r\n    },\r\n    remove: function(row) {\r\n      this.$confirm('确认删除此客群监控属性?', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).then(() => {\r\n        Common.ajax({\r\n          url: '/web/v1/attribute/' + row.uuid,\r\n          type: 'delete',\r\n          contentType: 'application/json',\r\n          data: JSON.stringify({}),\r\n          dataType: 'json',\r\n          success: res => {\r\n            this.$message({\r\n              type: 'success',\r\n              message: '删除成功!'\r\n            });\r\n            this.$refs.dataTable.$emit('load-data');\r\n          },\r\n          error: err => {\r\n            let error = err.message || err;\r\n            err.message &&\r\n              this.$alert(error, '', {\r\n                type: 'error',\r\n                confirmButtonText: '知道了',\r\n                callback: action => {}\r\n              });\r\n          }\r\n        });\r\n      });\r\n    },\r\n    /**\r\n     * 详情页面form表单数据提交\r\n     */\r\n    submitFormHandle(...args) {\r\n      let successMessage;\r\n      let opertype = args[0];\r\n      let type = 'POST';\r\n      let url = '/web/v1/attribute';\r\n      let { uuid, name, xml, hash, start, end, step } = args[1];\r\n      if (opertype == 'add') {\r\n        successMessage = '新增成功';\r\n      } else {\r\n        successMessage = '编辑成功';\r\n        type = 'put';\r\n        url = url + '/' + uuid;\r\n      }\r\n      Common.ajax({\r\n        url: url,\r\n        type: type,\r\n        data: JSON.stringify({\r\n          name,\r\n          xml,\r\n          hash,\r\n          start,\r\n          end,\r\n          step\r\n        }),\r\n        uploadFiles: true,\r\n        dataType: 'json',\r\n        contentType: 'application/json',\r\n        processData: false,\r\n        success: res => {\r\n          this.alertMessage = successMessage;\r\n          this.$alert(successMessage, '', {\r\n            type: 'success',\r\n            confirmButtonText: '知道了',\r\n            callback: action => {\r\n              this.closeFormDialog();\r\n            }\r\n          });\r\n        },\r\n        error: err => {\r\n          let error = err.message || err;\r\n          this.alertMessage = error;\r\n          err.message &&\r\n            this.$alert(this.alertMessage, '', {\r\n              type: 'error',\r\n              confirmButtonText: '知道了',\r\n              callback: action => {}\r\n            });\r\n        },\r\n        complete: () => {\r\n          this.$refs.dataTable.$emit('load-data');\r\n        }\r\n      });\r\n    },\r\n    // 格式化\r\n    formatterType(row, column) {\r\n      return row.hash === 1 ? '散列' : '连续';\r\n    }\r\n  }\r\n};\r\n<\/script>\r\n\r\n"]}])},528:function(r,e,n){"use strict";var t=n(164);n.n(t).a},529:function(r,e,n){(r.exports=n(4)(!0)).push([r.i,"\n.el-table .cell,\r\n.el-table th > div {\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  box-sizing: border-box;\r\n  text-overflow: ellipsis;\n}\r\n","",{version:3,sources:["src/views/contents/risk/monitoringAttributesManagement.vue"],names:[],mappings:";AAiFA;;EAEA,iBAAA;EACA,kBAAA;EACA,sBAAA;EACA,uBAAA;AACA",file:"monitoringAttributesManagement.vue?vue&type=style&index=1&lang=css&",sourcesContent:["\x3c!--\r\n * @Description: \r\n * @Author: 焦丙乾(jiaobingqian)\r\n * @Email: jiaobq123@163.com\r\n * @Date: 2019-07-15 18:33:54\r\n * @LastEditTime: 2019-07-17 19:42:45\r\n * @LastEditors: 王娇(wangjiao)\r\n --\x3e\r\n<template>\r\n  <div>\r\n    <tab-page ref=\"tabPage\">\r\n      <template slot=\"firstTabPage\">\r\n        <data-table\r\n          :data-table=\"dataTable\"\r\n          ref=\"dataTable\"\r\n          style=\"width: 100%\"\r\n          border\r\n          :default-sort=\"{prop: 'date', order: 'descending'}\"\r\n        >\r\n          \x3c!--<data-table :data-table=\"dataTable\" ref=\"dataTable\">--\x3e\r\n          <div slot=\"conditions\">\r\n            <div class=\"opera-btn\">\r\n              <el-button type=\"primary\" size=\"small\" @click=\"add\">&nbsp;新增属性</el-button>\r\n            </div>\r\n          </div>\r\n          <template slot=\"columns\">\r\n            <el-table-column prop=\"uuid\" label=\"uuid\" align=\"center\" width=\"70\" sortable></el-table-column>\r\n            <el-table-column prop=\"xml\" label=\"变量XML字段\" align=\"center\" sortable></el-table-column>\r\n            <el-table-column prop=\"name\" label=\"释义\" align=\"center\" sortable></el-table-column>\r\n            <el-table-column\r\n              prop=\"hash\"\r\n              label=\"类型\"\r\n              align=\"center\"\r\n              width=\"80\"\r\n              :formatter=\"formatterType\"\r\n              sortable\r\n            ></el-table-column>\r\n            <el-table-column prop=\"step\" label=\"步长\" align=\"center\" width=\"80\" sortable></el-table-column>\r\n            <el-table-column prop=\"start\" label=\"开始范围\" align=\"center\" width=\"100\" sortable></el-table-column>\r\n            <el-table-column prop=\"end\" label=\"结束范围\" align=\"center\" width=\"100\" sortable></el-table-column>\r\n\r\n            <el-table-column prop=\"created_at\" label=\"创建日期\" align=\"center\" width=\"100\" sortable></el-table-column>\r\n            <el-table-column prop=\"updated_at\" label=\"更新日期\" align=\"center\" width=\"100\" sortable></el-table-column>\r\n            <el-table-column label=\"操作\" width=\"120\" align=\"center\">\r\n              <template slot-scope=\"scope\">\r\n                <el-button type=\"primary\" size=\"small\" @click=\"edit(scope.row)\">编辑</el-button>\r\n                <el-button type=\"danger\" size=\"small\" @click=\"remove(scope.row)\">删除</el-button>\r\n              </template>\r\n            </el-table-column>\r\n          </template>\r\n        </data-table>\r\n\r\n        <attribute-form\r\n          :dialogInfo=\"dialogInfos\"\r\n          :dialogFormVisible=\"showDialog\"\r\n          @submitForm=\"submitFormHandle\"\r\n          v-on:closeDialog=\"closeFormDialog\"\r\n        ></attribute-form>\r\n      </template>\r\n    </tab-page>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n.el-select .el-input {\r\n  width: 100px;\r\n}\r\n\r\n.pagination_position {\r\n  padding-top: 20px;\r\n}\r\n\r\n.echarts {\r\n  height: 300px;\r\n}\r\n\r\n.opera-btn {\r\n  margin-bottom: 10px;\r\n}\r\n</style>\r\n<style>\r\n.el-table .cell,\r\n.el-table th > div {\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  box-sizing: border-box;\r\n  text-overflow: ellipsis;\r\n}\r\n</style>\r\n<script>\r\nimport DataTable from '../../../components/DataTable';\r\nimport TabPage from '../../../components/TabPage';\r\n\r\nimport Common from '../../../utils/common';\r\nimport formatDate from '../../../utils/formatDate.js';\r\n\r\nimport attributeForm from './attributeForm.vue';\r\n\r\nexport default {\r\n  components: {\r\n    DataTable,\r\n    TabPage,\r\n    attributeForm\r\n  },\r\n  data() {\r\n    let date = new Date();\r\n    let prevMonth = new Date(date.setDate(date.getDate() - 30));\r\n    let now = new Date();\r\n\r\n    function randomData() {\r\n      return Math.round(Math.random() * 1000);\r\n    }\r\n\r\n    return {\r\n      detailData: {},\r\n      deviceOptions: [\r\n        {\r\n          value: 'ALL',\r\n          name: 'ALL'\r\n        },\r\n        {\r\n          value: 'iPhone',\r\n          name: 'iOS'\r\n        },\r\n        {\r\n          value: 'Android',\r\n          name: 'Android'\r\n        }\r\n      ],\r\n      searchParam: {\r\n        device: 'ALL',\r\n        dateRange: [prevMonth, now]\r\n      },\r\n      dataTable: {\r\n        pageSize: 10,\r\n        pageSizes: [10, 20, 50, 100, 1000],\r\n        type: 'get',\r\n        url: '/web/v1/attribute',\r\n        queryParams: {},\r\n        emptyText: '没有记录'\r\n      },\r\n      loading2: true,\r\n      dialogInfos: {\r\n        dialogType: '',\r\n        form: {\r\n          uuid: null,\r\n          xml: '',\r\n          name: '',\r\n          hash: '',\r\n          start: '',\r\n          end: '',\r\n          step: ''\r\n        }\r\n      },\r\n      showDialog: false\r\n    };\r\n  },\r\n  mounted() {\r\n    var defaultPage = {\r\n      label: '监控客群属性集管理',\r\n      name: 'default',\r\n      slotName: 'firstTabPage',\r\n      closable: false\r\n    };\r\n    this.$refs.tabPage.$emit('open-tab', defaultPage);\r\n  },\r\n  methods: {\r\n    /**\r\n     * 清空form表单数据\r\n     */\r\n    clearForm() {\r\n      this.dialogInfos = {\r\n        dialogType: 'add',\r\n        form: {\r\n          uuid: '',\r\n          xml: '',\r\n          name: '',\r\n          hash: '',\r\n          start: '',\r\n          end: '',\r\n          step: ''\r\n        }\r\n      };\r\n    },\r\n    showFormDialog() {\r\n      this.showDialog = true;\r\n    },\r\n    closeFormDialog() {\r\n      this.showDialog = false;\r\n    },\r\n    /**\r\n     * 新增\r\n     */\r\n    add: function() {\r\n      this.dialogInfos.dialogType = 'add';\r\n      this.clearForm();\r\n      this.showFormDialog();\r\n    },\r\n    /**\r\n     * 编辑\r\n     */\r\n    edit: function(row) {\r\n      this.dialogInfos.dialogType = 'edit';\r\n      this.dialogInfos.form = {\r\n        uuid: row.uuid,\r\n        xml: row.xml,\r\n        name: row.name,\r\n        hash: row.hash,\r\n        start: row.start,\r\n        end: row.end,\r\n        step: row.step\r\n      };\r\n      this.showFormDialog();\r\n    },\r\n    remove: function(row) {\r\n      this.$confirm('确认删除此客群监控属性?', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).then(() => {\r\n        Common.ajax({\r\n          url: '/web/v1/attribute/' + row.uuid,\r\n          type: 'delete',\r\n          contentType: 'application/json',\r\n          data: JSON.stringify({}),\r\n          dataType: 'json',\r\n          success: res => {\r\n            this.$message({\r\n              type: 'success',\r\n              message: '删除成功!'\r\n            });\r\n            this.$refs.dataTable.$emit('load-data');\r\n          },\r\n          error: err => {\r\n            let error = err.message || err;\r\n            err.message &&\r\n              this.$alert(error, '', {\r\n                type: 'error',\r\n                confirmButtonText: '知道了',\r\n                callback: action => {}\r\n              });\r\n          }\r\n        });\r\n      });\r\n    },\r\n    /**\r\n     * 详情页面form表单数据提交\r\n     */\r\n    submitFormHandle(...args) {\r\n      let successMessage;\r\n      let opertype = args[0];\r\n      let type = 'POST';\r\n      let url = '/web/v1/attribute';\r\n      let { uuid, name, xml, hash, start, end, step } = args[1];\r\n      if (opertype == 'add') {\r\n        successMessage = '新增成功';\r\n      } else {\r\n        successMessage = '编辑成功';\r\n        type = 'put';\r\n        url = url + '/' + uuid;\r\n      }\r\n      Common.ajax({\r\n        url: url,\r\n        type: type,\r\n        data: JSON.stringify({\r\n          name,\r\n          xml,\r\n          hash,\r\n          start,\r\n          end,\r\n          step\r\n        }),\r\n        uploadFiles: true,\r\n        dataType: 'json',\r\n        contentType: 'application/json',\r\n        processData: false,\r\n        success: res => {\r\n          this.alertMessage = successMessage;\r\n          this.$alert(successMessage, '', {\r\n            type: 'success',\r\n            confirmButtonText: '知道了',\r\n            callback: action => {\r\n              this.closeFormDialog();\r\n            }\r\n          });\r\n        },\r\n        error: err => {\r\n          let error = err.message || err;\r\n          this.alertMessage = error;\r\n          err.message &&\r\n            this.$alert(this.alertMessage, '', {\r\n              type: 'error',\r\n              confirmButtonText: '知道了',\r\n              callback: action => {}\r\n            });\r\n        },\r\n        complete: () => {\r\n          this.$refs.dataTable.$emit('load-data');\r\n        }\r\n      });\r\n    },\r\n    // 格式化\r\n    formatterType(row, column) {\r\n      return row.hash === 1 ? '散列' : '连续';\r\n    }\r\n  }\r\n};\r\n<\/script>\r\n\r\n"]}])}}]);
//# sourceMappingURL=24.36d18c15179db76ed067.js.map