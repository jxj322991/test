(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{1038:function(e,r,t){"use strict";t.r(r);var n=t(2),a=(t(1),t(9)),l=t(8),o={components:{DataTable:a.a,TabPage:l.a},data:function(){return{updateDate:"",queryParams:{},dataTable:{pageSize:1e3,pageSizes:[10,20,50,100,1e3],url:"/web/v1/market/queryUpdateHistory",emptyText:"没有记录",showSummary:!1,summaryMethod:this.getSummaries}}},mounted:function(){this.$refs.tabPage.$emit("open-tab",{label:"H5总计",name:"updateHistory",slotName:"updateHistory",closable:!1})},methods:{loadLists:function(){this.$refs.dataTable.$emit("load-data")},onSubmit:function(){this.dataTable.url="/web/v1/market/queryUpdateHistory",this.$refs.dataTable.$emit("load-data")},changeUpdateDate:function(){var e=this;this.$confirm("提交后，更新历史市场数据将从该时间往前获取",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(function(){n.a.ajax({url:"/web/v1/market/updateLastHistory",type:"post",contentType:"application/json",data:{date:e.updateDate},success:function(){e.$message({type:"success",message:"修改成功!"})},error:function(r){var t=r&&r.message||r;e.$notify.error({title:"错误",message:t})},complete:function(){e.$refs.dataTable.$emit("load-data")}})}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},getSummaries:function(e){var r=e.columns,t=e.data,n=[];return r.forEach(function(e,r){if(0!==r){var a=t.map(function(r){return+r[e.property]});n[r]=a.every(function(e){return isNaN(e)})?"N/A":a.reduce(function(e,r){return isNaN(+r)?e:e+r},0)}else n[r]="总计"}),n}}},s=(t(630),t(632),t(3)),i=Object(s.a)(o,function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[t("tab-page",{ref:"tabPage"},[t("template",{slot:"updateHistory"},[t("data-table",{ref:"dataTable",attrs:{"data-table":e.dataTable}},[t("div",{staticStyle:{"margin-bottom":"15px"},attrs:{slot:"conditions"},slot:"conditions"},[t("el-form",{attrs:{inline:!0}},[t("el-form-item",[t("el-date-picker",{staticStyle:{width:"170px"},attrs:{type:"date",placeholder:"选择日期时间",size:"small"},model:{value:e.updateDate,callback:function(r){e.updateDate=r},expression:"updateDate"}})],1),e._v(" "),t("el-form-item",[t("el-button",{staticStyle:{"margin-top":"0"},attrs:{type:"primary",size:"small"},on:{click:e.changeUpdateDate}},[e._v("\n                                更新最后更新时间\n                            ")])],1)],1),e._v(" "),t("el-form",{attrs:{inline:!0,model:e.queryParams}},[t("el-form-item",[t("el-button",{staticStyle:{"margin-top":"0"},attrs:{type:"primary",size:"small"},on:{click:e.onSubmit}},[e._v("查询\n                            ")])],1)],1)],1),e._v(" "),t("template",{slot:"columns"},[t("el-table-column",{attrs:{type:"index",label:"序号"}}),e._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"id",label:"id"}}),e._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"date",label:"日期"}}),e._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"created_at",label:"创建时间"}}),e._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"updated_at",label:"更新时间"}})],1)],2)],1)],2)],1)},[],!1,null,"e39de9da",null);r.default=i.exports},215:function(e,r,t){var n=t(631);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,t(5).default)("3fac87cc",n,!0,{})},216:function(e,r,t){var n=t(633);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,t(5).default)("7d558a80",n,!0,{})},630:function(e,r,t){"use strict";var n=t(215);t.n(n).a},631:function(e,r,t){(e.exports=t(4)(!0)).push([e.i,"\n.el-form-item__content .el-button[data-v-e39de9da] {\n    margin-top: 20px;\n}\n.el-table--border th[data-v-e39de9da] {\n    text-align: center;\n}\n.el-table th .cell[data-v-e39de9da] {\n    text-align: center;\n}\n.el-form--inline .el-form-item[data-v-e39de9da] {\n    margin-right: 2px;\n}\n.el-form-item[data-v-e39de9da] {\n    margin-bottom: 2px;\n}\n.el-dialog__footer[data-v-e39de9da] {\n    padding: 10px 0px;\n    text-align: center;\n}\n.check-all-select[data-v-e39de9da] {\n    padding: 10px;\n}\n.check-all-select span.text-all[data-v-e39de9da] {\n    font-size: 14px;\n    font-weight: bold;\n}\n.check-all-select label[data-v-e39de9da] {\n    float: right;\n}\n.mb-10[data-v-e39de9da] {\n    margin-bottom: 10px;\n}\n","",{version:3,sources:["src/views/contents/market/marketUpdateHistory.vue"],names:[],mappings:";AAuCA;IACA,gBAAA;AACA;AAEA;IACA,kBAAA;AACA;AAEA;IACA,kBAAA;AACA;AAEA;IACA,iBAAA;AACA;AAEA;IACA,kBAAA;AACA;AAEA;IACA,iBAAA;IACA,kBAAA;AACA;AAEA;IACA,aAAA;AACA;AAEA;IACA,eAAA;IACA,iBAAA;AACA;AAEA;IACA,YAAA;AACA;AAEA;IACA,mBAAA;AACA",file:"marketUpdateHistory.vue?vue&type=style&index=0&id=e39de9da&scoped=true&lang=css&",sourcesContent:['<template>\r\n    <div>\r\n        <tab-page ref="tabPage">\r\n\r\n            <template slot="updateHistory">\r\n                <data-table :data-table="dataTable" ref="dataTable">\r\n                    <div slot="conditions" style="margin-bottom:15px">\r\n                        <el-form :inline="true">\r\n                            <el-form-item>\r\n                                <el-date-picker v-model="updateDate" type="date" placeholder="选择日期时间" size="small"\r\n                                                style="width:170px"></el-date-picker>\r\n                            </el-form-item>\r\n                            <el-form-item>\r\n                                <el-button type="primary" @click="changeUpdateDate" size="small" style="margin-top:0">\r\n                                    更新最后更新时间\r\n                                </el-button>\r\n                            </el-form-item>\r\n                        </el-form>\r\n                        <el-form :inline="true" :model="queryParams">\r\n                            <el-form-item>\r\n                                <el-button type="primary" @click="onSubmit" size="small" style="margin-top:0">查询\r\n                                </el-button>\r\n                            </el-form-item>\r\n                        </el-form>\r\n                    </div>\r\n                    <template slot="columns">\r\n                        <el-table-column type="index" label="序号"></el-table-column>\r\n                        <el-table-column sortable prop="id" label="id"></el-table-column>\r\n                        <el-table-column sortable prop="date" label="日期"></el-table-column>\r\n                        <el-table-column sortable prop="created_at" label="创建时间"></el-table-column>\r\n                        <el-table-column sortable prop="updated_at" label="更新时间"></el-table-column>\r\n\r\n                    </template>\r\n                </data-table>\r\n            </template>\r\n        </tab-page>\r\n    </div>\r\n</template>\r\n<style scoped>\r\n    .el-form-item__content .el-button {\r\n        margin-top: 20px;\r\n    }\r\n\r\n    .el-table--border th {\r\n        text-align: center;\r\n    }\r\n\r\n    .el-table th .cell {\r\n        text-align: center;\r\n    }\r\n\r\n    .el-form--inline .el-form-item {\r\n        margin-right: 2px;\r\n    }\r\n\r\n    .el-form-item {\r\n        margin-bottom: 2px;\r\n    }\r\n\r\n    .el-dialog__footer {\r\n        padding: 10px 0px;\r\n        text-align: center;\r\n    }\r\n\r\n    .check-all-select {\r\n        padding: 10px;\r\n    }\r\n\r\n    .check-all-select span.text-all {\r\n        font-size: 14px;\r\n        font-weight: bold;\r\n    }\r\n\r\n    .check-all-select label {\r\n        float: right;\r\n    }\r\n\r\n    .mb-10 {\r\n        margin-bottom: 10px;\r\n    }\r\n</style>\r\n<script>\r\n    import common from \'../../../utils/common\'\r\n    import formatDate from \'../../../utils/formatDate\'\r\n    import DataTable from "../../../components/DataTable"\r\n    import TabPage from "../../../components/TabPage"\r\n    export default{\r\n        components: {\r\n            DataTable,\r\n            TabPage,\r\n        },\r\n        data(){\r\n            return {\r\n                updateDate: \'\',\r\n                queryParams: {},\r\n                dataTable: {\r\n                    pageSize: 1000,\r\n                    pageSizes: [10, 20, 50, 100, 1000],\r\n                    url: "/web/v1/market/queryUpdateHistory",\r\n                    emptyText: \'没有记录\',\r\n                    showSummary: false,\r\n                    summaryMethod: this.getSummaries,\r\n                },\r\n            }\r\n        },\r\n        mounted(){\r\n\r\n            var defaultPage = {label: "H5总计", name: "updateHistory", slotName: \'updateHistory\', closable: false};\r\n            this.$refs.tabPage.$emit("open-tab", defaultPage);\r\n\r\n        },\r\n        methods: {\r\n\r\n            loadLists(){\r\n                this.$refs.dataTable.$emit(\'load-data\');\r\n            },\r\n            onSubmit: function () {\r\n                this.dataTable.url = \'/web/v1/market/queryUpdateHistory\';\r\n                this.$refs.dataTable.$emit(\'load-data\');\r\n            },\r\n            changeUpdateDate: function () {\r\n                this.$confirm(\'提交后，更新历史市场数据将从该时间往前获取\', {\r\n                    confirmButtonText: \'确认\',\r\n                    cancelButtonText: \'取消\',\r\n                    type: \'warning\'\r\n                }).then(() => {\r\n                    common.ajax({\r\n                        url: \'/web/v1/market/updateLastHistory\',\r\n                        type: \'post\',\r\n                        contentType: \'application/json\',\r\n                        data: {\r\n                            date: this.updateDate\r\n                        },\r\n                        success: (response) => {\r\n                            this.$message({\r\n                                type: \'success\',\r\n                                message: \'修改成功!\'\r\n                            });\r\n                        },\r\n                        error: (err) => {\r\n                            let error = (err && err.message) || err;\r\n                            this.$notify.error({\r\n                                title: \'错误\',\r\n                                message: error,\r\n                            });\r\n                        },\r\n                        complete: () => {\r\n                            this.$refs.dataTable.$emit(\'load-data\');\r\n                        }\r\n                    });\r\n                }).catch(() => {\r\n                    this.$message({\r\n                        type: \'info\',\r\n                        message: \'已取消提交\'\r\n                    });\r\n                });\r\n            },\r\n            getSummaries(param) {\r\n                const {columns, data} = param;\r\n                const sums = [];\r\n                columns.forEach((column, index) => {\r\n                    if (index === 0) {\r\n                        sums[index] = \'总计\';\r\n                        return;\r\n                    }\r\n                    const values = data.map(item => Number(item[column.property]));\r\n                    if (!values.every(value => isNaN(value))) {\r\n                        sums[index] = values.reduce((prev, curr) => {\r\n                            const value = Number(curr);\r\n                            if (!isNaN(value)) {\r\n                                return prev + curr;\r\n                            } else {\r\n                                return prev;\r\n                            }\r\n                        }, 0);\r\n                    } else {\r\n                        sums[index] = \'N/A\';\r\n                    }\r\n                });\r\n\r\n                return sums;\r\n            },\r\n        },\r\n    }\r\n<\/script>\r\n<style>\r\n    .span-style {\r\n        display: inline-block;\r\n        margin-top: 8px;\r\n        font-size: 14px;\r\n    }\r\n</style>\r\n']}])},632:function(e,r,t){"use strict";var n=t(216);t.n(n).a},633:function(e,r,t){(e.exports=t(4)(!0)).push([e.i,"\n.span-style {\n    display: inline-block;\n    margin-top: 8px;\n    font-size: 14px;\n}\n","",{version:3,sources:["src/views/contents/market/marketUpdateHistory.vue"],names:[],mappings:";AA0LA;IACA,qBAAA;IACA,eAAA;IACA,eAAA;AACA",file:"marketUpdateHistory.vue?vue&type=style&index=1&lang=css&",sourcesContent:['<template>\r\n    <div>\r\n        <tab-page ref="tabPage">\r\n\r\n            <template slot="updateHistory">\r\n                <data-table :data-table="dataTable" ref="dataTable">\r\n                    <div slot="conditions" style="margin-bottom:15px">\r\n                        <el-form :inline="true">\r\n                            <el-form-item>\r\n                                <el-date-picker v-model="updateDate" type="date" placeholder="选择日期时间" size="small"\r\n                                                style="width:170px"></el-date-picker>\r\n                            </el-form-item>\r\n                            <el-form-item>\r\n                                <el-button type="primary" @click="changeUpdateDate" size="small" style="margin-top:0">\r\n                                    更新最后更新时间\r\n                                </el-button>\r\n                            </el-form-item>\r\n                        </el-form>\r\n                        <el-form :inline="true" :model="queryParams">\r\n                            <el-form-item>\r\n                                <el-button type="primary" @click="onSubmit" size="small" style="margin-top:0">查询\r\n                                </el-button>\r\n                            </el-form-item>\r\n                        </el-form>\r\n                    </div>\r\n                    <template slot="columns">\r\n                        <el-table-column type="index" label="序号"></el-table-column>\r\n                        <el-table-column sortable prop="id" label="id"></el-table-column>\r\n                        <el-table-column sortable prop="date" label="日期"></el-table-column>\r\n                        <el-table-column sortable prop="created_at" label="创建时间"></el-table-column>\r\n                        <el-table-column sortable prop="updated_at" label="更新时间"></el-table-column>\r\n\r\n                    </template>\r\n                </data-table>\r\n            </template>\r\n        </tab-page>\r\n    </div>\r\n</template>\r\n<style scoped>\r\n    .el-form-item__content .el-button {\r\n        margin-top: 20px;\r\n    }\r\n\r\n    .el-table--border th {\r\n        text-align: center;\r\n    }\r\n\r\n    .el-table th .cell {\r\n        text-align: center;\r\n    }\r\n\r\n    .el-form--inline .el-form-item {\r\n        margin-right: 2px;\r\n    }\r\n\r\n    .el-form-item {\r\n        margin-bottom: 2px;\r\n    }\r\n\r\n    .el-dialog__footer {\r\n        padding: 10px 0px;\r\n        text-align: center;\r\n    }\r\n\r\n    .check-all-select {\r\n        padding: 10px;\r\n    }\r\n\r\n    .check-all-select span.text-all {\r\n        font-size: 14px;\r\n        font-weight: bold;\r\n    }\r\n\r\n    .check-all-select label {\r\n        float: right;\r\n    }\r\n\r\n    .mb-10 {\r\n        margin-bottom: 10px;\r\n    }\r\n</style>\r\n<script>\r\n    import common from \'../../../utils/common\'\r\n    import formatDate from \'../../../utils/formatDate\'\r\n    import DataTable from "../../../components/DataTable"\r\n    import TabPage from "../../../components/TabPage"\r\n    export default{\r\n        components: {\r\n            DataTable,\r\n            TabPage,\r\n        },\r\n        data(){\r\n            return {\r\n                updateDate: \'\',\r\n                queryParams: {},\r\n                dataTable: {\r\n                    pageSize: 1000,\r\n                    pageSizes: [10, 20, 50, 100, 1000],\r\n                    url: "/web/v1/market/queryUpdateHistory",\r\n                    emptyText: \'没有记录\',\r\n                    showSummary: false,\r\n                    summaryMethod: this.getSummaries,\r\n                },\r\n            }\r\n        },\r\n        mounted(){\r\n\r\n            var defaultPage = {label: "H5总计", name: "updateHistory", slotName: \'updateHistory\', closable: false};\r\n            this.$refs.tabPage.$emit("open-tab", defaultPage);\r\n\r\n        },\r\n        methods: {\r\n\r\n            loadLists(){\r\n                this.$refs.dataTable.$emit(\'load-data\');\r\n            },\r\n            onSubmit: function () {\r\n                this.dataTable.url = \'/web/v1/market/queryUpdateHistory\';\r\n                this.$refs.dataTable.$emit(\'load-data\');\r\n            },\r\n            changeUpdateDate: function () {\r\n                this.$confirm(\'提交后，更新历史市场数据将从该时间往前获取\', {\r\n                    confirmButtonText: \'确认\',\r\n                    cancelButtonText: \'取消\',\r\n                    type: \'warning\'\r\n                }).then(() => {\r\n                    common.ajax({\r\n                        url: \'/web/v1/market/updateLastHistory\',\r\n                        type: \'post\',\r\n                        contentType: \'application/json\',\r\n                        data: {\r\n                            date: this.updateDate\r\n                        },\r\n                        success: (response) => {\r\n                            this.$message({\r\n                                type: \'success\',\r\n                                message: \'修改成功!\'\r\n                            });\r\n                        },\r\n                        error: (err) => {\r\n                            let error = (err && err.message) || err;\r\n                            this.$notify.error({\r\n                                title: \'错误\',\r\n                                message: error,\r\n                            });\r\n                        },\r\n                        complete: () => {\r\n                            this.$refs.dataTable.$emit(\'load-data\');\r\n                        }\r\n                    });\r\n                }).catch(() => {\r\n                    this.$message({\r\n                        type: \'info\',\r\n                        message: \'已取消提交\'\r\n                    });\r\n                });\r\n            },\r\n            getSummaries(param) {\r\n                const {columns, data} = param;\r\n                const sums = [];\r\n                columns.forEach((column, index) => {\r\n                    if (index === 0) {\r\n                        sums[index] = \'总计\';\r\n                        return;\r\n                    }\r\n                    const values = data.map(item => Number(item[column.property]));\r\n                    if (!values.every(value => isNaN(value))) {\r\n                        sums[index] = values.reduce((prev, curr) => {\r\n                            const value = Number(curr);\r\n                            if (!isNaN(value)) {\r\n                                return prev + curr;\r\n                            } else {\r\n                                return prev;\r\n                            }\r\n                        }, 0);\r\n                    } else {\r\n                        sums[index] = \'N/A\';\r\n                    }\r\n                });\r\n\r\n                return sums;\r\n            },\r\n        },\r\n    }\r\n<\/script>\r\n<style>\r\n    .span-style {\r\n        display: inline-block;\r\n        margin-top: 8px;\r\n        font-size: 14px;\r\n    }\r\n</style>\r\n']}])}}]);
//# sourceMappingURL=57.e254d4c7f67d035fe7d2.js.map