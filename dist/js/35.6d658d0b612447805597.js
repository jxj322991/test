(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{1050:function(e,r,n){"use strict";n.r(r);var t=n(11),a=n.n(t),l=n(2),i=n(1),s=n(9),o=n(8),m=n(7),c={components:{DataTable:s.a,TabPage:o.a},data:function(){return{sourceCheckAll:!1,mediumCheckAll:!1,campaignCheckAll:!1,deviceCheckAll:!1,sourceOptions:[],mediumOptions:[],campaignOptions:[],sourceOptionsList:[],mediumOptionsList:[],campaignOptionsList:[],deviceOptions:[{value:"iOS",label:"iOS"},{value:"Android",label:"Android"}],ksjkOptions:[{value:"是",label:"是"},{value:"否",label:"否"}],initBeginTime:"",initEndTime:"",queryParams:{source:"",medium:"",campaign:"",device:"",isksjk:"",beginTime:"",endTime:""},dataTable:{pageSize:50,pageSizes:[10,20,50,100,1e3,5e3,1e4,2e4],url:"/web/v1/market/queryH5Detail",emptyText:"没有记录",showSummary:!0,summaryMethod:this.getSummaries},loading:!1}},mounted:function(){this.dataTable.queryParams=this.queryParams;var e=new Date,r=new Date(e.setDate(e.getDate()-7));this.initBeginTime=this.dealDate(r),this.initEndTime=this.dealDate(new Date),this.dataTable.queryParams.beginTime=this.initBeginTime+" 00:00:00",this.dataTable.queryParams.endTime=this.initEndTime+" 23:59:59",this.$refs.tabPage.$emit("open-tab",{label:"H5渠道",name:"h5StatisticsDetail",slotName:"h5StatisticsDetail",closable:!1}),this.getCampaigns(),this.getMediums(),this.getSources()},beforeDestroy:function(){},methods:{remoteSourceMethod:function(e){var r=this;""===e?this.sourceOptions=[]:(this.loading=!0,setTimeout(function(){r.loading=!1,r.sourceOptions=r.sourceOptionsList.filter(function(r){return-1<r.name.indexOf(e)})},200))},remoteMediumMethod:function(e){var r=this;""===e?this.mediumOptions=[]:(this.loading=!0,setTimeout(function(){r.loading=!1,r.mediumOptions=r.mediumOptionsList.filter(function(r){return-1<r.name.indexOf(e)})},200))},remoteCampaignMethod:function(e){var r=this;""===e?this.campaignOptions=[]:(this.loading=!0,setTimeout(function(){r.loading=!1,r.campaignOptions=r.campaignOptionsList.filter(function(r){return-1<r.name.indexOf(e)})},200))},loadLists:function(){this.$refs.dataTable.$emit("load-data")},onSubmit:function(){this.dataTable.queryParams=this.queryParams,this.warnTime(this.dataTable.queryParams.beginTime,this.dataTable.queryParams.endTime)||(this.dataTable.queryParams.beginTime=this.dealDate(this.dataTable.queryParams.beginTime)+" 00:00:00",this.dataTable.queryParams.endTime=this.dealDate(this.dataTable.queryParams.endTime)+" 23:59:59",this.dataTable.url="/web/v1/market/queryH5Detail",this.$refs.dataTable.$emit("load-data"))},warnTime:function(e,r){return e?r?!!(new Date(e).getTime()>new Date(r).getTime())&&(this.$notify({message:"查询开始时间不能大于结束时间",type:"warning"}),!0):(this.$notify({message:"查询结束时间不能为空！",type:"warning"}),!0):(this.$notify({message:"查询开始时间不能为空！",type:"warning"}),!0)},dealTime:function(e){return Object(i.a)(new Date(e),"yyyy-MM-dd hh:mm:ss")},formatterDate:function(e){return Object(i.a)(e.date,"yyyy-MM-dd")},dealDate:function(e){return Object(i.a)(new Date(e),"yyyy-MM-dd")},getSummaries:function(e){var r=e.columns,n=e.data,t=[];return r.forEach(function(e,r){var a;0!==r?(a=16===r||17===r||18===r||19===r?n.map(function(r){if(null!==r[e.property])return+r[e.property].replace("%","")}):n.map(function(r){return+r[e.property]})).every(function(e){return isNaN(e)})?t[r]="N/A":(t[r]=a.reduce(function(e,r){return isNaN(+r)?e:e+r},0),(16===r||17===r||18===r||19===r)&&(t[r]=(t[r]/n.length).toFixed(2)+" %")):t[r]="总计"}),t},exportExcel:function(){var e=this,r={};a()(r,this.dataTable.queryParams),r.pageSize=this.$refs.dataTable.total,r.page=1,this.$refs.dataTable.$emit("export-data",r),Promise.all([n.e(0),n.e(2)]).then(function(){var r=n(1028).export_json_to_excel,t=["日期","T7进件","T7审核","T7放款","T7放款金额","uv","设备","快速借款用户","source","medium","campaign","手机号","注册","激活","进件","审核","放款","放款金额","激活/注册","进件/激活","审核/进件","留手机号新用户"],a=["date","jinjian_t7","approval_t7","emitCn_t7","emitMoney_t7","uv","plat","ksjk_existing","source","medium","campaign","phones_count","register_count","activation_count","jinjian","approval","emitCn","emitMoney","act_reg_rate","jj_jh_rate","review_jinj_rate","take_phone_new"];setTimeout(function(){var n=e.$refs.dataTable.dataListA,l=e.formatJson(a,n);r(t,l,"H5渠道")},300)}.bind(null,n)).catch(n.oe)},formatJson:function(e,r){return r.map(function(r){return e.map(function(e){return"operator"==e?r[e].name:r[e]})})},getSources:function(){var e=this;l.a.ajax({url:"/web/v1/options/h5/sources",type:"POST",contentType:"application/json",success:function(r){r.data&&r.data.list&&(e.sourceOptionsList=r.data.list)},error:function(e){var r=e.message||e;m.Notification.error({title:"错误",message:r})}})},getMediums:function(){var e=this;l.a.ajax({url:"/web/v1/options/h5/mediums",type:"POST",contentType:"application/json",success:function(r){r.data&&r.data.list&&(e.mediumOptionsList=r.data.list)},error:function(e){var r=e.message||e;m.Notification.error({title:"错误",message:r})}})},getCampaigns:function(){var e=this;l.a.ajax({url:"/web/v1/options/h5/campaigns",type:"POST",contentType:"application/json",success:function(r){r.data&&r.data.list&&(e.campaignOptionsList=r.data.list)},error:function(e){var r=e.message||e;m.Notification.error({title:"错误",message:r})}})},checkAllSelection:function(e){for(var r=this.$refs[e].optionsCount,n=0;n<r;n++)!function(r,n){setTimeout(function(){n.$refs[e].handleOptionSelect(n.$refs[e].options[r])},0)}(n,this)},handleCheckAllSourceChange:function(){console.log("source"),this.checkAllSelection("sourceSelect"),this.sourceCheckAll=!this.sourceCheckAll},handleCheckAllMediumChange:function(){this.checkAllSelection("mediumSelect"),this.mediumCheckAll=!this.mediumCheckAll},handleCheckAllCampaignChange:function(){this.checkAllSelection("campaignSelect"),this.campaignCheckAll=!this.campaignCheckAll},handleCheckAllDeviceChange:function(){this.checkAllSelection("deviceSelect"),this.deviceCheckAll=!this.deviceCheckAll},setCheckAllStyle:function(e,r){console.log("setCheckAllStyle");var n=r+"CheckAll",t=r+"Select";this[n]?e.length<this.$refs[t].optionsCount&&(this[n]=!this[n]):e.length===this.$refs[t].optionsCount&&(this[n]=!this[n])},sourceChange:function(e){console.log("sourceChange"),this.setCheckAllStyle(e,"source")},mediumChange:function(e){this.setCheckAllStyle(e,"medium")},campaignChange:function(e){this.setCheckAllStyle(e,"campaign")},deviceChange:function(e){this.setCheckAllStyle(e,"device")}}},u=(n(602),n(604),n(3)),p=Object(u.a)(c,function(){var e=this,r=e.$createElement,n=e._self._c||r;return n("div",[n("tab-page",{ref:"tabPage"},[n("template",{slot:"h5StatisticsDetail"},[n("data-table",{ref:"dataTable",attrs:{"data-table":e.dataTable}},[n("div",{staticStyle:{"margin-bottom":"15px"},attrs:{slot:"conditions"},slot:"conditions"},[n("el-form",{attrs:{inline:!0,model:e.queryParams}},[n("el-form-item",[n("el-date-picker",{staticStyle:{width:"170px"},attrs:{type:"date",placeholder:"选择日期时间",size:"small"},model:{value:e.queryParams.beginTime,callback:function(r){e.$set(e.queryParams,"beginTime",r)},expression:"queryParams.beginTime"}})],1),e._v(" "),n("span",{staticClass:"span-style"},[e._v("至")]),e._v(" "),n("el-form-item",[n("el-date-picker",{staticStyle:{width:"170px"},attrs:{type:"date",placeholder:"选择日期时间",size:"small"},model:{value:e.queryParams.endTime,callback:function(r){e.$set(e.queryParams,"endTime",r)},expression:"queryParams.endTime"}})],1),e._v(" "),n("el-form-item",[n("el-select",{attrs:{clearable:"",filterable:"",placeholder:"设备",size:"small"},model:{value:e.queryParams.device,callback:function(r){e.$set(e.queryParams,"device",r)},expression:"queryParams.device"}},e._l(e.deviceOptions,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),n("el-form-item",[n("el-select",{ref:"sourceSelect",attrs:{clearable:"",filterable:"",remote:"","remote-method":e.remoteSourceMethod,loading:e.loading,placeholder:"source",size:"small"},model:{value:e.queryParams.source,callback:function(r){e.$set(e.queryParams,"source",r)},expression:"queryParams.source"}},e._l(e.sourceOptions,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),n("el-form-item",[n("el-select",{ref:"mediumSelect",attrs:{clearable:"",filterable:"",remote:"","remote-method":e.remoteMediumMethod,loading:e.loading,placeholder:"medium",size:"small"},model:{value:e.queryParams.medium,callback:function(r){e.$set(e.queryParams,"medium",r)},expression:"queryParams.medium"}},e._l(e.mediumOptions,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),n("el-form-item",[n("el-select",{ref:"campaignSelect",attrs:{clearable:"",filterable:"",remote:"","remote-method":e.remoteCampaignMethod,loading:e.loading,placeholder:"campaign",size:"small"},model:{value:e.queryParams.campaign,callback:function(r){e.$set(e.queryParams,"campaign",r)},expression:"queryParams.campaign"}},e._l(e.campaignOptions,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),n("el-form-item",[n("el-select",{attrs:{clearable:"",filterable:"",placeholder:"快速借款",size:"small"},model:{value:e.queryParams.isksjk,callback:function(r){e.$set(e.queryParams,"isksjk",r)},expression:"queryParams.isksjk"}},e._l(e.ksjkOptions,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),n("el-form-item",[n("el-button",{staticStyle:{"margin-top":"0"},attrs:{type:"primary",size:"small"},on:{click:e.onSubmit}},[e._v("查询\n              ")])],1)],1),e._v(" "),n("el-button",{staticClass:"right mb-10",attrs:{type:"primary",size:"small",icon:"el-icon-document"},on:{click:e.exportExcel}},[e._v("导出excel\n          ")])],1),e._v(" "),n("template",{slot:"columns"},[n("el-table-column",{attrs:{type:"index",label:"序号",width:"60"}}),e._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"date",label:"日期",width:"120"}}),e._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"plat",label:"设备",width:"100"}}),e._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"ksjk_existing",label:"快速借款用户",width:"120"}}),e._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"source",label:"source"}}),e._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"medium",label:"medium"}}),e._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"campaign",label:"campaign"}}),e._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"uv",label:"uv"}}),e._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"phones_count",label:"手机号"}}),e._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"take_phone_new",label:"留手机号新用户"}}),e._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"register_count",label:"注册"}}),e._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"activation_count",label:"激活"}}),e._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"jinjian",label:"当日进件"}}),e._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"approval",label:"当日审核"}}),e._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"emitCn",label:"当日放款"}}),e._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"emitMoney",label:"放款金额"}}),e._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"act_reg_rate",label:"激活/注册",width:"90"}}),e._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"jj_jh_rate",label:"进件/激活",width:"90"}}),e._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"jj_reg_rate",label:"进件/注册",width:"90"}}),e._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"review_jinj_rate",label:"审核/进件",width:"90"}}),e._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"jinjian_t7",label:"T7进件"}}),e._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"approval_t7",label:"T7审核"}}),e._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"emitCn_t7",label:"T7放款"}}),e._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"emitMoney_t7",label:"T7放款金额"}})],1)],2)],1)],2)],1)},[],!1,null,"d51e7bd2",null);r.default=p.exports},201:function(e,r,n){var t=n(603);"string"==typeof t&&(t=[[e.i,t,""]]),t.locals&&(e.exports=t.locals);(0,n(5).default)("edc4a8ac",t,!0,{})},202:function(e,r,n){var t=n(605);"string"==typeof t&&(t=[[e.i,t,""]]),t.locals&&(e.exports=t.locals);(0,n(5).default)("ab8b9650",t,!0,{})},602:function(e,r,n){"use strict";var t=n(201);n.n(t).a},603:function(e,r,n){(e.exports=n(4)(!0)).push([e.i,"\n.el-form-item__content .el-button[data-v-d51e7bd2] {\n  margin-top: 20px;\n}\n.el-table--border th[data-v-d51e7bd2] {\n  text-align: center;\n}\n.el-table th .cell[data-v-d51e7bd2] {\n  text-align: center;\n}\n.el-form--inline .el-form-item[data-v-d51e7bd2] {\n  margin-right: 2px;\n}\n.el-form-item[data-v-d51e7bd2] {\n  margin-bottom: 2px;\n}\n.el-dialog__footer[data-v-d51e7bd2] {\n  padding: 10px 0px;\n  text-align: center;\n}\n.check-all-select[data-v-d51e7bd2] {\n  padding: 10px;\n}\n.check-all-select span.text-all[data-v-d51e7bd2] {\n  font-size: 14px;\n  font-weight: bold;\n}\n.check-all-select label[data-v-d51e7bd2] {\n  float: right;\n}\n.mb-10[data-v-d51e7bd2] {\n  margin-bottom: 10px;\n}\n","",{version:3,sources:["src/views/contents/market/h5StatisticsDetail.vue"],names:[],mappings:";AAmJA;EACA,gBAAA;AACA;AAEA;EACA,kBAAA;AACA;AAEA;EACA,kBAAA;AACA;AAEA;EACA,iBAAA;AACA;AAEA;EACA,kBAAA;AACA;AAEA;EACA,iBAAA;EACA,kBAAA;AACA;AAEA;EACA,aAAA;AACA;AAEA;EACA,eAAA;EACA,iBAAA;AACA;AAEA;EACA,YAAA;AACA;AAEA;EACA,mBAAA;AACA",file:"h5StatisticsDetail.vue?vue&type=style&index=0&id=d51e7bd2&scoped=true&lang=css&",sourcesContent:['<template>\r\n  <div>\r\n    <tab-page ref="tabPage">\r\n      <template slot="h5StatisticsDetail">\r\n        <data-table :data-table="dataTable" ref="dataTable">\r\n          <div slot="conditions" style="margin-bottom:15px">\r\n            <el-form :inline="true" :model="queryParams">\r\n              <el-form-item>\r\n                <el-date-picker\r\n                  v-model="queryParams.beginTime"\r\n                  type="date"\r\n                  placeholder="选择日期时间" size="small" style="width:170px">\r\n                </el-date-picker>\r\n              </el-form-item>\r\n              <span class="span-style">至</span>\r\n              <el-form-item>\r\n                <el-date-picker\r\n                  v-model="queryParams.endTime"\r\n                  type="date"\r\n                  placeholder="选择日期时间" size="small" style="width:170px">\r\n                </el-date-picker>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-select v-model="queryParams.device"\r\n                           clearable\r\n                           filterable\r\n                           placeholder="设备"\r\n                           size="small">\r\n                  <el-option\r\n                    v-for="item in deviceOptions"\r\n                    :key="item.value"\r\n                    :label="item.label"\r\n                    :value="item.value">\r\n                  </el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-select v-model="queryParams.source"\r\n                           ref="sourceSelect"\r\n                           clearable\r\n                           filterable\r\n                           remote\r\n                           :remote-method="remoteSourceMethod"\r\n                           :loading="loading"\r\n                           placeholder="source"\r\n                           size="small">\r\n                  <el-option\r\n                    v-for="item in sourceOptions"\r\n                    :key="item.value"\r\n                    :label="item.label"\r\n                    :value="item.value">\r\n                  </el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-select v-model="queryParams.medium"\r\n                           ref="mediumSelect"\r\n                           clearable\r\n                           filterable\r\n                           remote\r\n                           :remote-method="remoteMediumMethod"\r\n                           :loading="loading"\r\n                           placeholder="medium"\r\n                           size="small">\r\n                  <el-option\r\n                    v-for="item in mediumOptions"\r\n                    :key="item.value"\r\n                    :label="item.label"\r\n                    :value="item.value">\r\n                  </el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-select v-model="queryParams.campaign"\r\n                           ref="campaignSelect"\r\n                           clearable\r\n                           filterable\r\n                           remote\r\n                           :remote-method="remoteCampaignMethod"\r\n                           :loading="loading"\r\n                           placeholder="campaign"\r\n                           size="small">\r\n                  <el-option\r\n                    v-for="item in campaignOptions"\r\n                    :key="item.value"\r\n                    :label="item.label"\r\n                    :value="item.value">\r\n                  </el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-select v-model="queryParams.isksjk" clearable filterable placeholder="快速借款"\r\n                           size="small">\r\n                  <el-option\r\n                    v-for="item in ksjkOptions"\r\n                    :key="item.value"\r\n                    :label="item.label"\r\n                    :value="item.value">\r\n                  </el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-button type="primary" @click="onSubmit" size="small" style="margin-top:0">查询\r\n                </el-button>\r\n              </el-form-item>\r\n            </el-form>\r\n            <el-button class="right mb-10" type="primary" size="small" icon="el-icon-document"\r\n                       @click="exportExcel">导出excel\r\n            </el-button>\r\n          </div>\r\n          <template slot="columns">\r\n            <el-table-column type="index" label="序号" width="60"></el-table-column>\r\n            <el-table-column sortable prop="date" label="日期" width="120"></el-table-column>\r\n\r\n            <el-table-column sortable prop="plat" label="设备" width="100"></el-table-column>\r\n            <el-table-column sortable prop="ksjk_existing" label="快速借款用户" width="120"></el-table-column>\r\n            <el-table-column sortable prop="source" label="source"></el-table-column>\r\n            <el-table-column sortable prop="medium" label="medium"></el-table-column>\r\n            <el-table-column sortable prop="campaign" label="campaign"></el-table-column>\r\n            <el-table-column sortable prop="uv" label="uv"></el-table-column>\r\n            <el-table-column sortable prop="phones_count" label="手机号"></el-table-column>\r\n            <el-table-column sortable prop="take_phone_new" label="留手机号新用户" ></el-table-column>\r\n            <el-table-column sortable prop="register_count" label="注册"></el-table-column>\r\n            <el-table-column sortable prop="activation_count" label="激活"></el-table-column>\r\n\r\n            <el-table-column sortable prop="jinjian" label="当日进件"></el-table-column>\r\n            <el-table-column sortable prop="approval" label="当日审核"></el-table-column>\r\n            <el-table-column sortable prop="emitCn" label="当日放款"></el-table-column>\r\n            <el-table-column sortable prop="emitMoney" label="放款金额"></el-table-column>\r\n            <el-table-column sortable prop="act_reg_rate" label="激活/注册" width="90"></el-table-column>\r\n            <el-table-column sortable prop="jj_jh_rate" label="进件/激活" width="90"></el-table-column>\r\n            <el-table-column sortable prop="jj_reg_rate" label="进件/注册" width="90"></el-table-column>\r\n            <el-table-column sortable prop="review_jinj_rate" label="审核/进件" width="90"></el-table-column>\r\n\r\n            <el-table-column sortable prop="jinjian_t7" label="T7进件"></el-table-column>\r\n            <el-table-column sortable prop="approval_t7" label="T7审核"></el-table-column>\r\n            <el-table-column sortable prop="emitCn_t7" label="T7放款"></el-table-column>\r\n            <el-table-column sortable prop="emitMoney_t7" label="T7放款金额"></el-table-column>\r\n\r\n\r\n          </template>\r\n        </data-table>\r\n      </template>\r\n    </tab-page>\r\n  </div>\r\n</template>\r\n<style scoped>\r\n  .el-form-item__content .el-button {\r\n    margin-top: 20px;\r\n  }\r\n\r\n  .el-table--border th {\r\n    text-align: center;\r\n  }\r\n\r\n  .el-table th .cell {\r\n    text-align: center;\r\n  }\r\n\r\n  .el-form--inline .el-form-item {\r\n    margin-right: 2px;\r\n  }\r\n\r\n  .el-form-item {\r\n    margin-bottom: 2px;\r\n  }\r\n\r\n  .el-dialog__footer {\r\n    padding: 10px 0px;\r\n    text-align: center;\r\n  }\r\n\r\n  .check-all-select {\r\n    padding: 10px;\r\n  }\r\n\r\n  .check-all-select span.text-all {\r\n    font-size: 14px;\r\n    font-weight: bold;\r\n  }\r\n\r\n  .check-all-select label {\r\n    float: right;\r\n  }\r\n\r\n  .mb-10 {\r\n    margin-bottom: 10px;\r\n  }\r\n</style>\r\n<script>\r\n  import common from \'../../../utils/common\'\r\n  import formatDate from \'../../../utils/formatDate\'\r\n  import DataTable from "../../../components/DataTable"\r\n  import TabPage from "../../../components/TabPage"\r\n  import {Notification} from \'element-ui\';\r\n  export default{\r\n    components: {\r\n      DataTable,\r\n      TabPage,\r\n    },\r\n    data(){\r\n      return {\r\n        sourceCheckAll: false,\r\n        mediumCheckAll: false,\r\n        campaignCheckAll: false,\r\n        deviceCheckAll: false,\r\n\r\n        sourceOptions: [],\r\n        mediumOptions: [],\r\n        campaignOptions: [],\r\n        sourceOptionsList: [],\r\n        mediumOptionsList: [],\r\n        campaignOptionsList: [],\r\n        deviceOptions: [\r\n          {\r\n            value: \'iOS\',\r\n            label: \'iOS\'\r\n          },\r\n          {\r\n            value: \'Android\',\r\n            label: \'Android\'\r\n          }\r\n        ],\r\n        ksjkOptions: [\r\n          {\r\n            value: \'是\',\r\n            label: \'是\'\r\n          },\r\n          {\r\n            value: \'否\',\r\n            label: \'否\'\r\n          }\r\n        ],\r\n        initBeginTime: \'\',\r\n        initEndTime: \'\',\r\n\r\n        queryParams: {\r\n          source: \'\',\r\n          medium: \'\',\r\n          campaign: \'\',\r\n          device: \'\',\r\n          isksjk: \'\',\r\n          beginTime: \'\',//开始时间\r\n          endTime: \'\',//结束时间\r\n        },\r\n        dataTable: {\r\n          pageSize: 50,\r\n          pageSizes: [10, 20, 50, 100, 1000,5000,10000,20000],\r\n          url: "/web/v1/market/queryH5Detail",    //代付管理\r\n          emptyText: \'没有记录\',\r\n          showSummary: true,\r\n          summaryMethod: this.getSummaries,\r\n        },\r\n        loading: false,\r\n      }\r\n    },\r\n    mounted(){\r\n      this.dataTable.queryParams = this.queryParams;\r\n      let date = new Date();\r\n      let beginDate = new Date(date.setDate(date.getDate() - 7));\r\n      this.initBeginTime = this.dealDate(beginDate);\r\n      this.initEndTime = this.dealDate(new Date());\r\n      this.dataTable.queryParams.beginTime = this.initBeginTime + \' 00:00:00\';\r\n      this.dataTable.queryParams.endTime = this.initEndTime + \' 23:59:59\';\r\n\r\n      var defaultPage = {\r\n        label: "H5渠道",\r\n        name: "h5StatisticsDetail",\r\n        slotName: \'h5StatisticsDetail\',\r\n        closable: false\r\n      };\r\n      this.$refs.tabPage.$emit("open-tab", defaultPage);\r\n\r\n      this.getCampaigns();\r\n      this.getMediums();\r\n      this.getSources();\r\n    },\r\n    beforeDestroy(){\r\n      // this.campaignOptions = [];\r\n      // this.mediumOptions = [];\r\n      // this.sourceOptions = [];\r\n      // this.$refs.campaignSelect.doDestroy();\r\n      // this.$refs.mediumSelect.doDestroy();\r\n      // this.$refs.sourceSelect.doDestroy();\r\n\r\n    },\r\n    methods: {\r\n      remoteSourceMethod(query){\r\n        if (query !== \'\') {\r\n          this.loading = true;\r\n          setTimeout(() => {\r\n            this.loading = false;\r\n\r\n            this.sourceOptions = this.sourceOptionsList.filter(item => {\r\n              return item.name.indexOf(query) > -1;\r\n            });\r\n          }, 200);\r\n        } else {\r\n          this.sourceOptions = [];\r\n        }\r\n      },\r\n      remoteMediumMethod(query){\r\n        if (query !== \'\') {\r\n          this.loading = true;\r\n          setTimeout(() => {\r\n            this.loading = false;\r\n\r\n            this.mediumOptions = this.mediumOptionsList.filter(item => {\r\n              return item.name.indexOf(query) > -1;\r\n            });\r\n          }, 200);\r\n        } else {\r\n          this.mediumOptions = [];\r\n        }\r\n      },\r\n      remoteCampaignMethod(query){\r\n        if (query !== \'\') {\r\n          this.loading = true;\r\n          setTimeout(() => {\r\n            this.loading = false;\r\n\r\n            this.campaignOptions = this.campaignOptionsList.filter(item => {\r\n              return item.name.indexOf(query) > -1;\r\n            });\r\n          }, 200);\r\n        } else {\r\n          this.campaignOptions = [];\r\n        }\r\n      },\r\n      loadLists(){\r\n        this.$refs.dataTable.$emit(\'load-data\');\r\n      },\r\n      onSubmit: function () {\r\n        this.dataTable.queryParams = this.queryParams;\r\n        var tag = this.warnTime(this.dataTable.queryParams.beginTime, this.dataTable.queryParams.endTime);\r\n        if (tag) {\r\n          return;\r\n        }\r\n        this.dataTable.queryParams.beginTime = this.dealDate(this.dataTable.queryParams.beginTime) + \' 00:00:00\';\r\n        this.dataTable.queryParams.endTime = this.dealDate(this.dataTable.queryParams.endTime) + \' 23:59:59\';\r\n        this.dataTable.url = \'/web/v1/market/queryH5Detail\';\r\n        this.$refs.dataTable.$emit(\'load-data\');\r\n      },\r\n      warnTime(startTime, endTime){\r\n        if (!startTime) {\r\n          this.$notify({\r\n            message: \'查询开始时间不能为空！\',\r\n            type: \'warning\'\r\n          });\r\n          return true;\r\n        }\r\n        if (!endTime) {\r\n          this.$notify({\r\n            message: \'查询结束时间不能为空！\',\r\n            type: \'warning\'\r\n          });\r\n          return true;\r\n        }\r\n        let timeStart = new Date(startTime).getTime();\r\n        let timeEnd = new Date(endTime).getTime();\r\n        if (timeStart > timeEnd) {\r\n          this.$notify({\r\n            message: \'查询开始时间不能大于结束时间\',\r\n            type: \'warning\'\r\n          });\r\n          return true;\r\n        }\r\n        return false;\r\n      },\r\n      dealTime (time) {\r\n        return formatDate(new Date(time), \'yyyy-MM-dd hh:mm:ss\');\r\n      },\r\n      formatterDate (row, column) {\r\n        return formatDate(row.date, \'yyyy-MM-dd\');\r\n      },\r\n      dealDate (date) {\r\n        return formatDate(new Date(date), \'yyyy-MM-dd\');\r\n      },\r\n      getSummaries (param) {\r\n        const {columns, data} = param;\r\n        const sums = [];\r\n        columns.forEach((column, index) => {\r\n          if (index === 0) {\r\n            sums[index] = \'总计\';\r\n            return;\r\n          }\r\n          var values;\r\n          if(index === 16||index === 17||index === 18||index === 19){\r\n             values = data.map(item =>{\r\n               if(item[column.property]!==null){\r\n                 return Number(item[column.property].replace(\'%\',\'\'));\r\n               }\r\n             });\r\n          }else{\r\n             values = data.map(item => Number(item[column.property]));\r\n          }\r\n\r\n          if (!values.every(value => isNaN(value))) {\r\n            sums[index] = values.reduce((prev, curr) => {\r\n              const value = Number(curr);\r\n              if (!isNaN(value)) {\r\n                return prev + curr;\r\n              } else {\r\n                return prev;\r\n              }\r\n            }, 0);\r\n            if(index === 16||index === 17||index === 18||index === 19){\r\n               sums[index]=(sums[index]/data.length).toFixed(2)+ \' %\';\r\n            }\r\n//                      sums[index] += \' 元\';\r\n          } else {\r\n            sums[index] = \'N/A\';\r\n          }\r\n        });\r\n\r\n        return sums;\r\n      },\r\n      exportExcel() {\r\n        let self=this;\r\n        var exportParams = {};\r\n        Object.assign(exportParams, this.dataTable.queryParams);\r\n        exportParams.pageSize = this.$refs.dataTable.total;\r\n        exportParams.page = 1;\r\n        this.$refs.dataTable.$emit(\'export-data\',exportParams);\r\n        require.ensure([], () => {\r\n          const {export_json_to_excel} = require(\'vendor/Export2Excel\');\r\n          const tHeader = [\r\n            \'日期\',\r\n            \'T7进件\',\r\n            \'T7审核\',\r\n            \'T7放款\',\r\n            \'T7放款金额\',\r\n            \'uv\', \'设备\', \'快速借款用户\', \'source\', \'medium\', \'campaign\', \'手机号\', \'注册\', \'激活\', \'进件\', \'审核\', \'放款\', \'放款金额\', \'激活/注册\', \'进件/激活\', \'审核/进件\', \'留手机号新用户\'];\r\n          const filterVal = [\r\n            \'date\',\r\n            \'jinjian_t7\',\r\n            \'approval_t7\',\r\n            \'emitCn_t7\',\r\n            \'emitMoney_t7\',\r\n            \'uv\', \'plat\', \'ksjk_existing\', \'source\', \'medium\', \'campaign\', \'phones_count\', \'register_count\', \'activation_count\', \'jinjian\', \'approval\', \'emitCn\', \'emitMoney\', \'act_reg_rate\', \'jj_jh_rate\', \'review_jinj_rate\', \'take_phone_new\'];\r\n\r\n          setTimeout(() => {\r\n            const list = this.$refs.dataTable.dataListA;\r\n            const data = this.formatJson(filterVal, list);\r\n            export_json_to_excel(tHeader, data, \'H5渠道\');\r\n          }, 300);\r\n        })\r\n      },\r\n      formatJson(filterVal, jsonData) {\r\n        return jsonData.map(v => filterVal.map(j => {\r\n          let returnValue;\r\n          if (j == \'operator\') {\r\n            returnValue = v[j].name;\r\n          } else {\r\n            returnValue = v[j];\r\n          }\r\n          return returnValue;\r\n        }))\r\n      },\r\n\r\n      getSources(){\r\n        common.ajax({\r\n          url: \'/web/v1/options/h5/sources\',\r\n          type: \'POST\',\r\n          contentType: \'application/json\',\r\n          success: (response) => {\r\n            if (response.data && response.data.list) {\r\n              // this.sourceOptions = response.data.list;\r\n              this.sourceOptionsList = response.data.list;\r\n            }\r\n          },\r\n          error: (err) => {\r\n            let error = err.message || err;\r\n            Notification.error({\r\n              title: \'错误\',\r\n              message: error\r\n            });\r\n          }\r\n        });\r\n      },\r\n\r\n      getMediums(){\r\n        common.ajax({\r\n          url: \'/web/v1/options/h5/mediums\',\r\n          type: \'POST\',\r\n          contentType: \'application/json\',\r\n          success: (response) => {\r\n            if (response.data && response.data.list) {\r\n              // this.mediumOptions = response.data.list;\r\n              this.mediumOptionsList = response.data.list;\r\n            }\r\n          },\r\n          error: (err) => {\r\n            let error = err.message || err;\r\n            Notification.error({\r\n              title: \'错误\',\r\n              message: error\r\n            });\r\n          }\r\n        });\r\n      },\r\n\r\n      getCampaigns(){\r\n        common.ajax({\r\n          url: \'/web/v1/options/h5/campaigns\',\r\n          type: \'POST\',\r\n          contentType: \'application/json\',\r\n          success: (response) => {\r\n            if (response.data && response.data.list) {\r\n              // this.campaignOptions = response.data.list;\r\n              this.campaignOptionsList = response.data.list;\r\n            }\r\n          },\r\n          error: (err) => {\r\n            let error = err.message || err;\r\n            Notification.error({\r\n              title: \'错误\',\r\n              message: error\r\n            });\r\n          }\r\n        });\r\n      },\r\n\r\n      checkAllSelection(selectType){\r\n        let len = this.$refs[selectType].optionsCount;\r\n        for (var i = 0; i < len; i++) {\r\n          (function (index, _this) {\r\n            setTimeout(() => {\r\n              _this.$refs[selectType].handleOptionSelect(_this.$refs[selectType].options[index]);\r\n            }, 0);\r\n\r\n          })(i, this);\r\n        }\r\n        ;\r\n      },\r\n      handleCheckAllSourceChange(event) {\r\n        console.log(\'source\');\r\n        this.checkAllSelection("sourceSelect");\r\n        this.sourceCheckAll = !this.sourceCheckAll;\r\n      },\r\n      handleCheckAllMediumChange(event) {\r\n        this.checkAllSelection("mediumSelect");\r\n        this.mediumCheckAll = !this.mediumCheckAll;\r\n      },\r\n      handleCheckAllCampaignChange(event) {\r\n        this.checkAllSelection("campaignSelect");\r\n        this.campaignCheckAll = !this.campaignCheckAll;\r\n      },\r\n      handleCheckAllDeviceChange(event) {\r\n        this.checkAllSelection("deviceSelect");\r\n        this.deviceCheckAll = !this.deviceCheckAll;\r\n      },\r\n      setCheckAllStyle(selectedCount, selectType){\r\n        console.log(\'setCheckAllStyle\');\r\n        let type = selectType + \'CheckAll\';\r\n        let type_1 = selectType + \'Select\';\r\n        if (this[type]) {\r\n          if (selectedCount.length < this.$refs[type_1].optionsCount) {\r\n            this[type] = !this[type];\r\n          }\r\n        } else {\r\n          if (selectedCount.length === this.$refs[type_1].optionsCount) {\r\n            this[type] = !this[type];\r\n          }\r\n        }\r\n      },\r\n      sourceChange(values){\r\n        console.log(\'sourceChange\');\r\n        this.setCheckAllStyle(values, "source");\r\n      },\r\n      mediumChange(values){\r\n        this.setCheckAllStyle(values, "medium");\r\n      },\r\n      campaignChange(values){\r\n        this.setCheckAllStyle(values, "campaign");\r\n      },\r\n      deviceChange(values){\r\n        this.setCheckAllStyle(values, "device");\r\n      },\r\n\r\n    },\r\n  }\r\n<\/script>\r\n<style>\r\n  .span-style {\r\n    display: inline-block;\r\n    margin-top: 8px;\r\n    font-size: 14px;\r\n  }\r\n</style>\r\n']}])},604:function(e,r,n){"use strict";var t=n(202);n.n(t).a},605:function(e,r,n){(e.exports=n(4)(!0)).push([e.i,"\n.span-style {\n  display: inline-block;\n  margin-top: 8px;\n  font-size: 14px;\n}\n","",{version:3,sources:["src/views/contents/market/h5StatisticsDetail.vue"],names:[],mappings:";AAwkBA;EACA,qBAAA;EACA,eAAA;EACA,eAAA;AACA",file:"h5StatisticsDetail.vue?vue&type=style&index=1&lang=css&",sourcesContent:['<template>\r\n  <div>\r\n    <tab-page ref="tabPage">\r\n      <template slot="h5StatisticsDetail">\r\n        <data-table :data-table="dataTable" ref="dataTable">\r\n          <div slot="conditions" style="margin-bottom:15px">\r\n            <el-form :inline="true" :model="queryParams">\r\n              <el-form-item>\r\n                <el-date-picker\r\n                  v-model="queryParams.beginTime"\r\n                  type="date"\r\n                  placeholder="选择日期时间" size="small" style="width:170px">\r\n                </el-date-picker>\r\n              </el-form-item>\r\n              <span class="span-style">至</span>\r\n              <el-form-item>\r\n                <el-date-picker\r\n                  v-model="queryParams.endTime"\r\n                  type="date"\r\n                  placeholder="选择日期时间" size="small" style="width:170px">\r\n                </el-date-picker>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-select v-model="queryParams.device"\r\n                           clearable\r\n                           filterable\r\n                           placeholder="设备"\r\n                           size="small">\r\n                  <el-option\r\n                    v-for="item in deviceOptions"\r\n                    :key="item.value"\r\n                    :label="item.label"\r\n                    :value="item.value">\r\n                  </el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-select v-model="queryParams.source"\r\n                           ref="sourceSelect"\r\n                           clearable\r\n                           filterable\r\n                           remote\r\n                           :remote-method="remoteSourceMethod"\r\n                           :loading="loading"\r\n                           placeholder="source"\r\n                           size="small">\r\n                  <el-option\r\n                    v-for="item in sourceOptions"\r\n                    :key="item.value"\r\n                    :label="item.label"\r\n                    :value="item.value">\r\n                  </el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-select v-model="queryParams.medium"\r\n                           ref="mediumSelect"\r\n                           clearable\r\n                           filterable\r\n                           remote\r\n                           :remote-method="remoteMediumMethod"\r\n                           :loading="loading"\r\n                           placeholder="medium"\r\n                           size="small">\r\n                  <el-option\r\n                    v-for="item in mediumOptions"\r\n                    :key="item.value"\r\n                    :label="item.label"\r\n                    :value="item.value">\r\n                  </el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-select v-model="queryParams.campaign"\r\n                           ref="campaignSelect"\r\n                           clearable\r\n                           filterable\r\n                           remote\r\n                           :remote-method="remoteCampaignMethod"\r\n                           :loading="loading"\r\n                           placeholder="campaign"\r\n                           size="small">\r\n                  <el-option\r\n                    v-for="item in campaignOptions"\r\n                    :key="item.value"\r\n                    :label="item.label"\r\n                    :value="item.value">\r\n                  </el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-select v-model="queryParams.isksjk" clearable filterable placeholder="快速借款"\r\n                           size="small">\r\n                  <el-option\r\n                    v-for="item in ksjkOptions"\r\n                    :key="item.value"\r\n                    :label="item.label"\r\n                    :value="item.value">\r\n                  </el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-button type="primary" @click="onSubmit" size="small" style="margin-top:0">查询\r\n                </el-button>\r\n              </el-form-item>\r\n            </el-form>\r\n            <el-button class="right mb-10" type="primary" size="small" icon="el-icon-document"\r\n                       @click="exportExcel">导出excel\r\n            </el-button>\r\n          </div>\r\n          <template slot="columns">\r\n            <el-table-column type="index" label="序号" width="60"></el-table-column>\r\n            <el-table-column sortable prop="date" label="日期" width="120"></el-table-column>\r\n\r\n            <el-table-column sortable prop="plat" label="设备" width="100"></el-table-column>\r\n            <el-table-column sortable prop="ksjk_existing" label="快速借款用户" width="120"></el-table-column>\r\n            <el-table-column sortable prop="source" label="source"></el-table-column>\r\n            <el-table-column sortable prop="medium" label="medium"></el-table-column>\r\n            <el-table-column sortable prop="campaign" label="campaign"></el-table-column>\r\n            <el-table-column sortable prop="uv" label="uv"></el-table-column>\r\n            <el-table-column sortable prop="phones_count" label="手机号"></el-table-column>\r\n            <el-table-column sortable prop="take_phone_new" label="留手机号新用户" ></el-table-column>\r\n            <el-table-column sortable prop="register_count" label="注册"></el-table-column>\r\n            <el-table-column sortable prop="activation_count" label="激活"></el-table-column>\r\n\r\n            <el-table-column sortable prop="jinjian" label="当日进件"></el-table-column>\r\n            <el-table-column sortable prop="approval" label="当日审核"></el-table-column>\r\n            <el-table-column sortable prop="emitCn" label="当日放款"></el-table-column>\r\n            <el-table-column sortable prop="emitMoney" label="放款金额"></el-table-column>\r\n            <el-table-column sortable prop="act_reg_rate" label="激活/注册" width="90"></el-table-column>\r\n            <el-table-column sortable prop="jj_jh_rate" label="进件/激活" width="90"></el-table-column>\r\n            <el-table-column sortable prop="jj_reg_rate" label="进件/注册" width="90"></el-table-column>\r\n            <el-table-column sortable prop="review_jinj_rate" label="审核/进件" width="90"></el-table-column>\r\n\r\n            <el-table-column sortable prop="jinjian_t7" label="T7进件"></el-table-column>\r\n            <el-table-column sortable prop="approval_t7" label="T7审核"></el-table-column>\r\n            <el-table-column sortable prop="emitCn_t7" label="T7放款"></el-table-column>\r\n            <el-table-column sortable prop="emitMoney_t7" label="T7放款金额"></el-table-column>\r\n\r\n\r\n          </template>\r\n        </data-table>\r\n      </template>\r\n    </tab-page>\r\n  </div>\r\n</template>\r\n<style scoped>\r\n  .el-form-item__content .el-button {\r\n    margin-top: 20px;\r\n  }\r\n\r\n  .el-table--border th {\r\n    text-align: center;\r\n  }\r\n\r\n  .el-table th .cell {\r\n    text-align: center;\r\n  }\r\n\r\n  .el-form--inline .el-form-item {\r\n    margin-right: 2px;\r\n  }\r\n\r\n  .el-form-item {\r\n    margin-bottom: 2px;\r\n  }\r\n\r\n  .el-dialog__footer {\r\n    padding: 10px 0px;\r\n    text-align: center;\r\n  }\r\n\r\n  .check-all-select {\r\n    padding: 10px;\r\n  }\r\n\r\n  .check-all-select span.text-all {\r\n    font-size: 14px;\r\n    font-weight: bold;\r\n  }\r\n\r\n  .check-all-select label {\r\n    float: right;\r\n  }\r\n\r\n  .mb-10 {\r\n    margin-bottom: 10px;\r\n  }\r\n</style>\r\n<script>\r\n  import common from \'../../../utils/common\'\r\n  import formatDate from \'../../../utils/formatDate\'\r\n  import DataTable from "../../../components/DataTable"\r\n  import TabPage from "../../../components/TabPage"\r\n  import {Notification} from \'element-ui\';\r\n  export default{\r\n    components: {\r\n      DataTable,\r\n      TabPage,\r\n    },\r\n    data(){\r\n      return {\r\n        sourceCheckAll: false,\r\n        mediumCheckAll: false,\r\n        campaignCheckAll: false,\r\n        deviceCheckAll: false,\r\n\r\n        sourceOptions: [],\r\n        mediumOptions: [],\r\n        campaignOptions: [],\r\n        sourceOptionsList: [],\r\n        mediumOptionsList: [],\r\n        campaignOptionsList: [],\r\n        deviceOptions: [\r\n          {\r\n            value: \'iOS\',\r\n            label: \'iOS\'\r\n          },\r\n          {\r\n            value: \'Android\',\r\n            label: \'Android\'\r\n          }\r\n        ],\r\n        ksjkOptions: [\r\n          {\r\n            value: \'是\',\r\n            label: \'是\'\r\n          },\r\n          {\r\n            value: \'否\',\r\n            label: \'否\'\r\n          }\r\n        ],\r\n        initBeginTime: \'\',\r\n        initEndTime: \'\',\r\n\r\n        queryParams: {\r\n          source: \'\',\r\n          medium: \'\',\r\n          campaign: \'\',\r\n          device: \'\',\r\n          isksjk: \'\',\r\n          beginTime: \'\',//开始时间\r\n          endTime: \'\',//结束时间\r\n        },\r\n        dataTable: {\r\n          pageSize: 50,\r\n          pageSizes: [10, 20, 50, 100, 1000,5000,10000,20000],\r\n          url: "/web/v1/market/queryH5Detail",    //代付管理\r\n          emptyText: \'没有记录\',\r\n          showSummary: true,\r\n          summaryMethod: this.getSummaries,\r\n        },\r\n        loading: false,\r\n      }\r\n    },\r\n    mounted(){\r\n      this.dataTable.queryParams = this.queryParams;\r\n      let date = new Date();\r\n      let beginDate = new Date(date.setDate(date.getDate() - 7));\r\n      this.initBeginTime = this.dealDate(beginDate);\r\n      this.initEndTime = this.dealDate(new Date());\r\n      this.dataTable.queryParams.beginTime = this.initBeginTime + \' 00:00:00\';\r\n      this.dataTable.queryParams.endTime = this.initEndTime + \' 23:59:59\';\r\n\r\n      var defaultPage = {\r\n        label: "H5渠道",\r\n        name: "h5StatisticsDetail",\r\n        slotName: \'h5StatisticsDetail\',\r\n        closable: false\r\n      };\r\n      this.$refs.tabPage.$emit("open-tab", defaultPage);\r\n\r\n      this.getCampaigns();\r\n      this.getMediums();\r\n      this.getSources();\r\n    },\r\n    beforeDestroy(){\r\n      // this.campaignOptions = [];\r\n      // this.mediumOptions = [];\r\n      // this.sourceOptions = [];\r\n      // this.$refs.campaignSelect.doDestroy();\r\n      // this.$refs.mediumSelect.doDestroy();\r\n      // this.$refs.sourceSelect.doDestroy();\r\n\r\n    },\r\n    methods: {\r\n      remoteSourceMethod(query){\r\n        if (query !== \'\') {\r\n          this.loading = true;\r\n          setTimeout(() => {\r\n            this.loading = false;\r\n\r\n            this.sourceOptions = this.sourceOptionsList.filter(item => {\r\n              return item.name.indexOf(query) > -1;\r\n            });\r\n          }, 200);\r\n        } else {\r\n          this.sourceOptions = [];\r\n        }\r\n      },\r\n      remoteMediumMethod(query){\r\n        if (query !== \'\') {\r\n          this.loading = true;\r\n          setTimeout(() => {\r\n            this.loading = false;\r\n\r\n            this.mediumOptions = this.mediumOptionsList.filter(item => {\r\n              return item.name.indexOf(query) > -1;\r\n            });\r\n          }, 200);\r\n        } else {\r\n          this.mediumOptions = [];\r\n        }\r\n      },\r\n      remoteCampaignMethod(query){\r\n        if (query !== \'\') {\r\n          this.loading = true;\r\n          setTimeout(() => {\r\n            this.loading = false;\r\n\r\n            this.campaignOptions = this.campaignOptionsList.filter(item => {\r\n              return item.name.indexOf(query) > -1;\r\n            });\r\n          }, 200);\r\n        } else {\r\n          this.campaignOptions = [];\r\n        }\r\n      },\r\n      loadLists(){\r\n        this.$refs.dataTable.$emit(\'load-data\');\r\n      },\r\n      onSubmit: function () {\r\n        this.dataTable.queryParams = this.queryParams;\r\n        var tag = this.warnTime(this.dataTable.queryParams.beginTime, this.dataTable.queryParams.endTime);\r\n        if (tag) {\r\n          return;\r\n        }\r\n        this.dataTable.queryParams.beginTime = this.dealDate(this.dataTable.queryParams.beginTime) + \' 00:00:00\';\r\n        this.dataTable.queryParams.endTime = this.dealDate(this.dataTable.queryParams.endTime) + \' 23:59:59\';\r\n        this.dataTable.url = \'/web/v1/market/queryH5Detail\';\r\n        this.$refs.dataTable.$emit(\'load-data\');\r\n      },\r\n      warnTime(startTime, endTime){\r\n        if (!startTime) {\r\n          this.$notify({\r\n            message: \'查询开始时间不能为空！\',\r\n            type: \'warning\'\r\n          });\r\n          return true;\r\n        }\r\n        if (!endTime) {\r\n          this.$notify({\r\n            message: \'查询结束时间不能为空！\',\r\n            type: \'warning\'\r\n          });\r\n          return true;\r\n        }\r\n        let timeStart = new Date(startTime).getTime();\r\n        let timeEnd = new Date(endTime).getTime();\r\n        if (timeStart > timeEnd) {\r\n          this.$notify({\r\n            message: \'查询开始时间不能大于结束时间\',\r\n            type: \'warning\'\r\n          });\r\n          return true;\r\n        }\r\n        return false;\r\n      },\r\n      dealTime (time) {\r\n        return formatDate(new Date(time), \'yyyy-MM-dd hh:mm:ss\');\r\n      },\r\n      formatterDate (row, column) {\r\n        return formatDate(row.date, \'yyyy-MM-dd\');\r\n      },\r\n      dealDate (date) {\r\n        return formatDate(new Date(date), \'yyyy-MM-dd\');\r\n      },\r\n      getSummaries (param) {\r\n        const {columns, data} = param;\r\n        const sums = [];\r\n        columns.forEach((column, index) => {\r\n          if (index === 0) {\r\n            sums[index] = \'总计\';\r\n            return;\r\n          }\r\n          var values;\r\n          if(index === 16||index === 17||index === 18||index === 19){\r\n             values = data.map(item =>{\r\n               if(item[column.property]!==null){\r\n                 return Number(item[column.property].replace(\'%\',\'\'));\r\n               }\r\n             });\r\n          }else{\r\n             values = data.map(item => Number(item[column.property]));\r\n          }\r\n\r\n          if (!values.every(value => isNaN(value))) {\r\n            sums[index] = values.reduce((prev, curr) => {\r\n              const value = Number(curr);\r\n              if (!isNaN(value)) {\r\n                return prev + curr;\r\n              } else {\r\n                return prev;\r\n              }\r\n            }, 0);\r\n            if(index === 16||index === 17||index === 18||index === 19){\r\n               sums[index]=(sums[index]/data.length).toFixed(2)+ \' %\';\r\n            }\r\n//                      sums[index] += \' 元\';\r\n          } else {\r\n            sums[index] = \'N/A\';\r\n          }\r\n        });\r\n\r\n        return sums;\r\n      },\r\n      exportExcel() {\r\n        let self=this;\r\n        var exportParams = {};\r\n        Object.assign(exportParams, this.dataTable.queryParams);\r\n        exportParams.pageSize = this.$refs.dataTable.total;\r\n        exportParams.page = 1;\r\n        this.$refs.dataTable.$emit(\'export-data\',exportParams);\r\n        require.ensure([], () => {\r\n          const {export_json_to_excel} = require(\'vendor/Export2Excel\');\r\n          const tHeader = [\r\n            \'日期\',\r\n            \'T7进件\',\r\n            \'T7审核\',\r\n            \'T7放款\',\r\n            \'T7放款金额\',\r\n            \'uv\', \'设备\', \'快速借款用户\', \'source\', \'medium\', \'campaign\', \'手机号\', \'注册\', \'激活\', \'进件\', \'审核\', \'放款\', \'放款金额\', \'激活/注册\', \'进件/激活\', \'审核/进件\', \'留手机号新用户\'];\r\n          const filterVal = [\r\n            \'date\',\r\n            \'jinjian_t7\',\r\n            \'approval_t7\',\r\n            \'emitCn_t7\',\r\n            \'emitMoney_t7\',\r\n            \'uv\', \'plat\', \'ksjk_existing\', \'source\', \'medium\', \'campaign\', \'phones_count\', \'register_count\', \'activation_count\', \'jinjian\', \'approval\', \'emitCn\', \'emitMoney\', \'act_reg_rate\', \'jj_jh_rate\', \'review_jinj_rate\', \'take_phone_new\'];\r\n\r\n          setTimeout(() => {\r\n            const list = this.$refs.dataTable.dataListA;\r\n            const data = this.formatJson(filterVal, list);\r\n            export_json_to_excel(tHeader, data, \'H5渠道\');\r\n          }, 300);\r\n        })\r\n      },\r\n      formatJson(filterVal, jsonData) {\r\n        return jsonData.map(v => filterVal.map(j => {\r\n          let returnValue;\r\n          if (j == \'operator\') {\r\n            returnValue = v[j].name;\r\n          } else {\r\n            returnValue = v[j];\r\n          }\r\n          return returnValue;\r\n        }))\r\n      },\r\n\r\n      getSources(){\r\n        common.ajax({\r\n          url: \'/web/v1/options/h5/sources\',\r\n          type: \'POST\',\r\n          contentType: \'application/json\',\r\n          success: (response) => {\r\n            if (response.data && response.data.list) {\r\n              // this.sourceOptions = response.data.list;\r\n              this.sourceOptionsList = response.data.list;\r\n            }\r\n          },\r\n          error: (err) => {\r\n            let error = err.message || err;\r\n            Notification.error({\r\n              title: \'错误\',\r\n              message: error\r\n            });\r\n          }\r\n        });\r\n      },\r\n\r\n      getMediums(){\r\n        common.ajax({\r\n          url: \'/web/v1/options/h5/mediums\',\r\n          type: \'POST\',\r\n          contentType: \'application/json\',\r\n          success: (response) => {\r\n            if (response.data && response.data.list) {\r\n              // this.mediumOptions = response.data.list;\r\n              this.mediumOptionsList = response.data.list;\r\n            }\r\n          },\r\n          error: (err) => {\r\n            let error = err.message || err;\r\n            Notification.error({\r\n              title: \'错误\',\r\n              message: error\r\n            });\r\n          }\r\n        });\r\n      },\r\n\r\n      getCampaigns(){\r\n        common.ajax({\r\n          url: \'/web/v1/options/h5/campaigns\',\r\n          type: \'POST\',\r\n          contentType: \'application/json\',\r\n          success: (response) => {\r\n            if (response.data && response.data.list) {\r\n              // this.campaignOptions = response.data.list;\r\n              this.campaignOptionsList = response.data.list;\r\n            }\r\n          },\r\n          error: (err) => {\r\n            let error = err.message || err;\r\n            Notification.error({\r\n              title: \'错误\',\r\n              message: error\r\n            });\r\n          }\r\n        });\r\n      },\r\n\r\n      checkAllSelection(selectType){\r\n        let len = this.$refs[selectType].optionsCount;\r\n        for (var i = 0; i < len; i++) {\r\n          (function (index, _this) {\r\n            setTimeout(() => {\r\n              _this.$refs[selectType].handleOptionSelect(_this.$refs[selectType].options[index]);\r\n            }, 0);\r\n\r\n          })(i, this);\r\n        }\r\n        ;\r\n      },\r\n      handleCheckAllSourceChange(event) {\r\n        console.log(\'source\');\r\n        this.checkAllSelection("sourceSelect");\r\n        this.sourceCheckAll = !this.sourceCheckAll;\r\n      },\r\n      handleCheckAllMediumChange(event) {\r\n        this.checkAllSelection("mediumSelect");\r\n        this.mediumCheckAll = !this.mediumCheckAll;\r\n      },\r\n      handleCheckAllCampaignChange(event) {\r\n        this.checkAllSelection("campaignSelect");\r\n        this.campaignCheckAll = !this.campaignCheckAll;\r\n      },\r\n      handleCheckAllDeviceChange(event) {\r\n        this.checkAllSelection("deviceSelect");\r\n        this.deviceCheckAll = !this.deviceCheckAll;\r\n      },\r\n      setCheckAllStyle(selectedCount, selectType){\r\n        console.log(\'setCheckAllStyle\');\r\n        let type = selectType + \'CheckAll\';\r\n        let type_1 = selectType + \'Select\';\r\n        if (this[type]) {\r\n          if (selectedCount.length < this.$refs[type_1].optionsCount) {\r\n            this[type] = !this[type];\r\n          }\r\n        } else {\r\n          if (selectedCount.length === this.$refs[type_1].optionsCount) {\r\n            this[type] = !this[type];\r\n          }\r\n        }\r\n      },\r\n      sourceChange(values){\r\n        console.log(\'sourceChange\');\r\n        this.setCheckAllStyle(values, "source");\r\n      },\r\n      mediumChange(values){\r\n        this.setCheckAllStyle(values, "medium");\r\n      },\r\n      campaignChange(values){\r\n        this.setCheckAllStyle(values, "campaign");\r\n      },\r\n      deviceChange(values){\r\n        this.setCheckAllStyle(values, "device");\r\n      },\r\n\r\n    },\r\n  }\r\n<\/script>\r\n<style>\r\n  .span-style {\r\n    display: inline-block;\r\n    margin-top: 8px;\r\n    font-size: 14px;\r\n  }\r\n</style>\r\n']}])}}]);
//# sourceMappingURL=35.6d658d0b612447805597.js.map