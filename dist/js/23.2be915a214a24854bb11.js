(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{1031:function(e,r,n){"use strict";n.r(r);var t=n(2),i=n(9),l=n(8),a=(n(516),n(518),n(3)),o=Object(a.a)({components:{},props:["dialogInfo","dialogFormVisible","id"],data:function(){return{formLabelWidth:"100px",ruleForm:{id:"",name:"",index:"",type:"",description:"",parentIndex:""},rules:{name:[{required:!0,message:"请输入权限名称",trigger:"blur"}],index:[{required:!0,message:"请输入权限索引",trigger:"blur"}],type:[{required:!0,message:"请选择权限类型",trigger:"blur"}]},typeOptions:[{value:"MENU",label:"菜单"},{value:"REPORT",label:"报表"}],parentIndexOptions:[],pickerOptions0:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},dialogVisible:!1}},computed:{disabled:function(){return!1}},methods:{getMenuPermissionsOptions:function(){var e=this;t.a.ajax({url:"/web/v1/permission/getMenu",type:"post",contentType:"application/json",dataType:"json",success:function(r){if(0==r.status&&r.data){var n=r.data;e.parentIndexOptions=n.list}},error:function(){}})},resetForm:function(e){this.$refs[e]&&this.$refs[e].resetFields()},submit:function(){return this.ruleForm.index?this.ruleForm.name?this.ruleForm.type?(this.dialogInfo.disabled=!0,void this.$emit("submitForm",this.dialogInfo.dialogType,this.ruleForm)):(this.$message("请选择权限类型"),!1):(this.$message("请输入权限名称"),!1):(this.$message("请输入权限索引"),!1)},closeDialog:function(){this.$emit("closeDialog")}},created:function(){},mounted:function(){this.ruleForm=this.dialogInfo.form},watch:{dialogInfo:function(e){"add"==e.dialogType&&this.resetForm("ruleForm"),this.getMenuPermissionsOptions()},id:function(){this.ruleForm=this.dialogInfo.form},dialogFormVisible:function(e){this.dialogVisible=!!e}}},function(){var e=this,r=e.$createElement,n=e._self._c||r;return n("el-dialog",{staticClass:"dialog-container",attrs:{title:"add"==e.dialogInfo.dialogType?"创建权限":"修改权限",width:"50%","show-close":!0,"close-on-click-modal":!1},on:{close:e.closeDialog},model:{value:e.dialogVisible,callback:function(r){e.dialogVisible=r},expression:"dialogVisible"}},[n("div",{staticClass:"dialog-form"},[n("el-form",{ref:"ruleForm",staticClass:"formInputWidth",attrs:{rules:e.rules,model:e.ruleForm}},[n("el-form-item",{attrs:{label:"权限索引",prop:"index","label-width":e.formLabelWidth}},[n("el-input",{attrs:{"auto-complete":"off",disabled:e.disabled},model:{value:e.ruleForm.index,callback:function(r){e.$set(e.ruleForm,"index",r)},expression:"ruleForm.index"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"权限名称",prop:"name","label-width":e.formLabelWidth}},[n("el-input",{attrs:{"auto-complete":"off",disabled:e.disabled},model:{value:e.ruleForm.name,callback:function(r){e.$set(e.ruleForm,"name",r)},expression:"ruleForm.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"权限类型",prop:"type","label-width":e.formLabelWidth}},[n("el-select",{ref:"limitSelect",attrs:{disabled:e.disabled,placeholder:"请选择"},model:{value:e.ruleForm.type,callback:function(r){e.$set(e.ruleForm,"type",r)},expression:"ruleForm.type"}},e._l(e.typeOptions,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"权限父菜单",prop:"parentIndex","label-width":e.formLabelWidth}},[n("el-select",{ref:"limitSelect",attrs:{clearable:"",disabled:e.disabled,placeholder:"请选择"},model:{value:e.ruleForm.parentIndex,callback:function(r){e.$set(e.ruleForm,"parentIndex",r)},expression:"ruleForm.parentIndex"}},e._l(e.parentIndexOptions,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"权限描述",prop:"description","label-width":e.formLabelWidth}},[n("el-input",{attrs:{"auto-complete":"off",autosize:"",type:"textarea",disabled:e.disabled},model:{value:e.ruleForm.description,callback:function(r){e.$set(e.ruleForm,"description",r)},expression:"ruleForm.description"}})],1)],1),e._v(" "),e.disabled?e._e():n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(){return e.resetForm("ruleForm")}}},[e._v("重置")]),e._v(" "),n("span",{staticClass:"wd"},[e._v(" ")]),e._v(" "),n("el-button",{attrs:{type:"primary",disabled:e.dialogInfo.disabled},on:{click:function(){return e.submit("ruleForm")}}},[e._v("确认")])],1)],1)])},[],!1,null,"4c1a341e",null).exports,s={components:{DataTable:i.a,TabPage:l.a,ReportPermission:o,Common:t.a},data:function(){return{showDialog:!1,dataTable:{pageSize:1e3,pageSizes:[10,20,50,100,1e3],url:"/web/v1/permission/getAll",restful:!0,queryParams:{},emptyText:"没有记录"},dialogInfos:{dialogType:"add",form:{id:"",name:"",index:"",type:"",parenIndex:"",level:"",description:""},disabled:!1},dialogId:null}},filters:{typeFilter:function(e){return{MENU:"success",REPORT:"primary"}[e]},flagFilter:function(e){return{0:"success",1:"error"}[e]}},mounted:function(){this.$refs.tabPage.$emit("open-tab",{label:"权限管理",name:"permissionManage",slotName:"permissionManage",closable:!1})},methods:{loadLists:function(){this.$refs.dataTable.$emit("load-data")},enableSubmit:function(){this.dialogInfos.disabled=!1},add:function(){this.openDialog()},edit:function(e){this.openDialog(e)},destroy:function(e){var r=this;this.$confirm("是否确认删除该权限?","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(function(){t.a.ajax({url:"/web/v1/permission/delete/"+e.id,type:"post",data:{},restful:!0,contentType:"application/json",success:function(){var e=this;r.$alert("删除成功","",{type:"success",confirmButtonText:"知道了",callback:function(){r.$refs.dataTable.$emit("load-data"),r.$refs.history&&e.$refs.history.$emit("load-data")}})},error:function(e){this.$message({message:e.message,type:"warning"})}})}).catch(function(){})},closeDetailDialog:function(){this.showDialog=!1},openDialog:function(e){e||(e={});var r=e.id?"edit":"add";this.dialogInfos={dialogType:r,form:{id:e.id||"",name:e.name||"",index:e.index||"",type:e.type||"",parentIndex:e.parent_index||"",level:e.level||"",description:e.description||""},disabled:!1},this.dialogId=e.id||"",this.showDialog=!0},submitForm:function(){var e=this,r=1>=arguments.length?void 0:arguments[1],n=r.id,i=r.name,l=r.index,a=r.type,o=r.description,s=r.parentIndex,d=0>=arguments.length?void 0:arguments[0],p="/web/v1/permission",m="添加权限成功";"edit"==d&&(p=p+"/"+n,m="更新权限成功"),i&&l&&a?t.a.ajax({url:p,type:"post",data:{name:i,index:l,type:a,description:o,parentIndex:s},restful:!0,contentType:"application/json",dataType:"json",success:function(){e.alertMessage="",e.$alert(m,"",{type:"success",confirmButtonText:"知道了",callback:function(){e.enableSubmit(),e.showDialog=!1}})},error:function(r){var n=r.message||r;e.alertMessage=n,r.message&&e.$alert(e.alertMessage,"",{type:"error",confirmButtonText:"知道了",callback:function(){e.enableSubmit()}})},complete:function(){e.$refs.dataTable.$emit("load-data"),e.$refs.history&&e.$refs.history.$emit("load-data")}}):(this.$message({showClose:!0,message:"必填字段不能为空!",type:"error",duration:3e3}),this.enableSubmit())}}},d=(n(520),Object(a.a)(s,function(){var e=this,r=e.$createElement,n=e._self._c||r;return n("tab-page",{ref:"tabPage"},[n("template",{slot:"permissionManage"},[n("data-table",{ref:"dataTable",attrs:{"data-table":e.dataTable}},[n("div",{staticStyle:{"margin-bottom":"15px"},attrs:{slot:"conditions"},slot:"conditions"},[n("el-button",{staticClass:"create",attrs:{type:"primary",size:"small"},on:{click:function(){return e.add()}}},[e._v("  新建  ")])],1),e._v(" "),n("template",{slot:"columns"},[n("el-table-column",{attrs:{prop:"name",label:"权限名称",align:"left",width:""}}),e._v(" "),n("el-table-column",{attrs:{prop:"index",label:"权限索引",align:"left",width:""}}),e._v(" "),n("el-table-column",{attrs:{label:"类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(r){return[n("el-tag",{attrs:{type:e._f("typeFilter")(r.row.type)}},[e._v(e._s("MENU"==r.row.type?"菜单":"报表"))])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"parent_index",label:"父菜单",align:"left",width:""}}),e._v(" "),n("el-table-column",{attrs:{label:"状态",width:"90"},scopedSlots:e._u([{key:"default",fn:function(r){return[n("el-tag",{attrs:{type:e._f("flagFilter")(r.row.flag)}},[e._v(e._s(0==r.row.flag?"使用中":"已失效"))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"操作",align:"center",width:""},scopedSlots:e._u([{key:"default",fn:function(r){return[n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(){return e.edit(r.row)}}},[e._v("编辑")]),e._v(" "),n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(){return e.destroy(r.row)}}},[e._v("删除")])]}}])})],1)],2),e._v(" "),n("report-permission",{ref:"ruleForm",attrs:{dialogInfo:e.dialogInfos,dialogFormVisible:e.showDialog,id:e.dialogId},on:{submitForm:e.submitForm,closeDialog:e.closeDetailDialog}})],1)],2)},[],!1,null,"2a046e1d",null));r.default=d.exports},158:function(e,r,n){var t=n(517);"string"==typeof t&&(t=[[e.i,t,""]]),t.locals&&(e.exports=t.locals);(0,n(5).default)("089d5526",t,!0,{})},159:function(e,r,n){var t=n(519);"string"==typeof t&&(t=[[e.i,t,""]]),t.locals&&(e.exports=t.locals);(0,n(5).default)("68d15991",t,!0,{})},160:function(e,r,n){var t=n(521);"string"==typeof t&&(t=[[e.i,t,""]]),t.locals&&(e.exports=t.locals);(0,n(5).default)("2b576a74",t,!0,{})},516:function(e,r,n){"use strict";var t=n(158);n.n(t).a},517:function(e,r,n){(e.exports=n(4)(!0)).push([e.i,'\n.el-dialog__wrapper .el-dialog--customer .el-dialog__header[data-v-4c1a341e] {\r\n  text-align: center;\n}\n.dialog-form[data-v-4c1a341e] {\r\n  width: 380px;\n}\n.el-select[data-v-4c1a341e] {\r\n  width: 200px;\n}\n.el-input[data-v-4c1a341e] {\r\n  width: 200px;\n}\n.el-input[data-v-4c1a341e] {\r\n  width: 200px;\n}\n.el-select .el-input[data-v-4c1a341e] {\r\n  width: 260px;\n}\n.el-select-dropdown__item[data-v-4c1a341e] {\r\n  max-width: 500px;\n}\n.dialog-footer[data-v-4c1a341e] {\r\n  text-align: center;\n}\n.el-upload ul[data-v-4c1a341e] {\r\n  display: none;\n}\n.download-btn[data-v-4c1a341e] {\r\n  text-align: center;\r\n  display: inline-block;\r\n  font-size: 12px;\r\n  border-radius: 5px;\r\n  line-height: 30px;\r\n  padding: 0 8px;\r\n  outline: none;\r\n  color: #ffffff;\r\n  background-color: #20a0ff;\r\n  box-sizing: border-box;\n}\n.wd[data-v-4c1a341e] {\r\n  display: inline-block;\r\n  width: 50px;\n}\n.self-line-height[data-v-4c1a341e] {\r\n  line-height: 36px;\n}\n.self-line-height2[data-v-4c1a341e] {\r\n  line-height: 48px;\n}\n.label-wrapper[data-v-4c1a341e] {\r\n  width: 100px;\n}\n.self-label[data-v-4c1a341e] {\r\n  text-align: right;\r\n  padding-right: 20px;\n}\n.el-row[data-v-4c1a341e] {\r\n  height: 50px;\r\n  line-height: 50px;\n}\n.el-form-item__label[data-v-4c1a341e] {\r\n  width: 200px;\n}\n.text[data-v-4c1a341e] {\r\n  font-size: 14px;\n}\n.item[data-v-4c1a341e] {\r\n  padding: 10px 20px;\r\n  margin: 10px 0;\n}\n.clearfix[data-v-4c1a341e]:before,\r\n.clearfix[data-v-4c1a341e]:after {\r\n  display: table;\r\n  content: "";\n}\n.clearfix[data-v-4c1a341e]:after {\r\n  clear: both;\n}\n.box-card[data-v-4c1a341e] {\r\n  width: 300px;\r\n  margin-right: 20px;\n}\n.txt-center[data-v-4c1a341e] {\r\n  text-align: center;\n}\n.jc-between[data-v-4c1a341e] {\r\n  justify-content: space-between;\n}\n.mt-30[data-v-4c1a341e] {\r\n  margin-top: 50px;\n}\n.left[data-v-4c1a341e] {\r\n  float: right;\n}\n.form-content-width[data-v-4c1a341e] {\r\n  width: 420px;\n}\n.mb-30[data-v-4c1a341e] {\r\n  margin-bottom: 22px;\n}\r\n',"",{version:3,sources:["src/views/contents/permission/permissionDialog.vue"],names:[],mappings:";AAgFA;EACA,kBAAA;AACA;AAEA;EACA,YAAA;AACA;AAEA;EACA,YAAA;AACA;AAEA;EACA,YAAA;AACA;AACA;EACA,YAAA;AACA;AAEA;EACA,YAAA;AACA;AAEA;EACA,gBAAA;AACA;AAEA;EACA,kBAAA;AACA;AAEA;EACA,aAAA;AACA;AAEA;EACA,kBAAA;EACA,qBAAA;EACA,eAAA;EACA,kBAAA;EACA,iBAAA;EACA,cAAA;EACA,aAAA;EACA,cAAA;EACA,yBAAA;EACA,sBAAA;AACA;AAEA;EACA,qBAAA;EACA,WAAA;AACA;AAEA;EACA,iBAAA;AACA;AAEA;EACA,iBAAA;AACA;AAEA;EACA,YAAA;AACA;AAEA;EACA,iBAAA;EACA,mBAAA;AACA;AAEA;EACA,YAAA;EACA,iBAAA;AACA;AAEA;EACA,YAAA;AACA;AAEA;EACA,eAAA;AACA;AAEA;EACA,kBAAA;EACA,cAAA;AACA;AAEA;;EAEA,cAAA;EACA,WAAA;AACA;AAEA;EACA,WAAA;AACA;AAEA;EACA,YAAA;EACA,kBAAA;AACA;AAEA;EACA,kBAAA;AACA;AAEA;EACA,8BAAA;AACA;AAEA;EACA,gBAAA;AACA;AAEA;EACA,YAAA;AACA;AAEA;EACA,YAAA;AACA;AAEA;EACA,mBAAA;AACA",file:"permissionDialog.vue?vue&type=style&index=0&id=4c1a341e&scoped=true&lang=css&",sourcesContent:['\x3c!--\r\n * @Description: \r\n * @Author: jinxiaojian\r\n * @Email: jinxiaojian@youxin.com\r\n * @Date: 2019-07-12 16:17:33\r\n * @LastEditTime: 2019-07-16 16:55:39\r\n * @LastEditors: 靳肖健\r\n --\x3e\r\n<template>\r\n  <el-dialog\r\n    :title="dialogInfo.dialogType ==\'add\'?\'创建权限\':\'修改权限\'"\r\n    width="50%"\r\n    class="dialog-container"\r\n    v-model="dialogVisible"\r\n    :show-close="true"\r\n    @close="closeDialog"\r\n    :close-on-click-modal="false"\r\n  >\r\n    <div class="dialog-form">\r\n      <el-form class="formInputWidth" :rules="rules" ref="ruleForm" :model="ruleForm">\r\n        <el-form-item label="权限索引" prop="index" :label-width="formLabelWidth">\r\n          <el-input v-model="ruleForm.index" auto-complete="off" :disabled="disabled"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label="权限名称" prop="name" :label-width="formLabelWidth">\r\n          <el-input v-model="ruleForm.name" auto-complete="off" :disabled="disabled"></el-input>\r\n        </el-form-item>\r\n        \x3c!--<el-form-item label="权限级别" :label-width="formLabelWidth">--\x3e\r\n        \x3c!--<el-input v-model="ruleForm.level" auto-complete="off" :disabled="disabled"></el-input>--\x3e\r\n        \x3c!--</el-form-item>--\x3e\r\n        <el-form-item label="权限类型" prop="type" :label-width="formLabelWidth">\r\n          <el-select\r\n            ref="limitSelect"\r\n            v-model="ruleForm.type"\r\n            :disabled="disabled"\r\n            placeholder="请选择"\r\n          >\r\n            <el-option\r\n              v-for="item in typeOptions"\r\n              :key="item.value"\r\n              :label="item.label"\r\n              :value="item.value"\r\n            ></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label="权限父菜单" prop="parentIndex" :label-width="formLabelWidth">\r\n          <el-select\r\n            ref="limitSelect"\r\n            clearable\r\n            v-model="ruleForm.parentIndex"\r\n            :disabled="disabled"\r\n            placeholder="请选择"\r\n          >\r\n            <el-option\r\n              v-for="item in parentIndexOptions"\r\n              :key="item.value"\r\n              :label="item.label"\r\n              :value="item.value"\r\n            ></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label="权限描述" prop="description" :label-width="formLabelWidth">\r\n          <el-input\r\n            v-model="ruleForm.description"\r\n            auto-complete="off"\r\n            autosize\r\n            type="textarea"\r\n            :disabled="disabled"\r\n          ></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div v-if="!disabled" slot="footer" class="dialog-footer">\r\n        <el-button @click="resetForm(\'ruleForm\')">重置</el-button>\r\n        <span class="wd">&nbsp;</span>\r\n        <el-button type="primary" @click="submit(\'ruleForm\')" :disabled="dialogInfo.disabled">确认</el-button>\r\n      </div>\r\n    </div>\r\n  </el-dialog>\r\n</template>\r\n\r\n<style scoped>\r\n.el-dialog__wrapper .el-dialog--customer .el-dialog__header {\r\n  text-align: center;\r\n}\r\n\r\n.dialog-form {\r\n  width: 380px;\r\n}\r\n\r\n.el-select {\r\n  width: 200px;\r\n}\r\n\r\n.el-input {\r\n  width: 200px;\r\n}\r\n.el-input {\r\n  width: 200px;\r\n}\r\n\r\n.el-select .el-input {\r\n  width: 260px;\r\n}\r\n\r\n.el-select-dropdown__item {\r\n  max-width: 500px;\r\n}\r\n\r\n.dialog-footer {\r\n  text-align: center;\r\n}\r\n\r\n.el-upload ul {\r\n  display: none;\r\n}\r\n\r\n.download-btn {\r\n  text-align: center;\r\n  display: inline-block;\r\n  font-size: 12px;\r\n  border-radius: 5px;\r\n  line-height: 30px;\r\n  padding: 0 8px;\r\n  outline: none;\r\n  color: #ffffff;\r\n  background-color: #20a0ff;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.wd {\r\n  display: inline-block;\r\n  width: 50px;\r\n}\r\n\r\n.self-line-height {\r\n  line-height: 36px;\r\n}\r\n\r\n.self-line-height2 {\r\n  line-height: 48px;\r\n}\r\n\r\n.label-wrapper {\r\n  width: 100px;\r\n}\r\n\r\n.self-label {\r\n  text-align: right;\r\n  padding-right: 20px;\r\n}\r\n\r\n.el-row {\r\n  height: 50px;\r\n  line-height: 50px;\r\n}\r\n\r\n.el-form-item__label {\r\n  width: 200px;\r\n}\r\n\r\n.text {\r\n  font-size: 14px;\r\n}\r\n\r\n.item {\r\n  padding: 10px 20px;\r\n  margin: 10px 0;\r\n}\r\n\r\n.clearfix:before,\r\n.clearfix:after {\r\n  display: table;\r\n  content: "";\r\n}\r\n\r\n.clearfix:after {\r\n  clear: both;\r\n}\r\n\r\n.box-card {\r\n  width: 300px;\r\n  margin-right: 20px;\r\n}\r\n\r\n.txt-center {\r\n  text-align: center;\r\n}\r\n\r\n.jc-between {\r\n  justify-content: space-between;\r\n}\r\n\r\n.mt-30 {\r\n  margin-top: 50px;\r\n}\r\n\r\n.left {\r\n  float: right;\r\n}\r\n\r\n.form-content-width {\r\n  width: 420px;\r\n}\r\n\r\n.mb-30 {\r\n  margin-bottom: 22px;\r\n}\r\n</style>\r\n<style>\r\n.el-upload__files {\r\n  display: none;\r\n}\r\n\r\n.content-wrapper {\r\n  display: flex;\r\n  display: -webkit-flex;\r\n  display: -ms-flex;\r\n  margin: 0;\r\n}\r\n</style>\r\n\r\n<script>\r\nimport common from "../../../utils/common";\r\nexport default {\r\n  components: {},\r\n  props: ["dialogInfo", "dialogFormVisible", "id"],\r\n  data() {\r\n    return {\r\n      formLabelWidth: "100px",\r\n      ruleForm: {\r\n        id: "",\r\n        name: "",\r\n        index: "",\r\n        type: "",\r\n        description: "",\r\n        parentIndex: "",\r\n      },\r\n      rules: {\r\n        name: [{ required: true, message: "请输入权限名称", trigger: "blur" }],\r\n        index: [{ required: true, message: "请输入权限索引", trigger: "blur" }],\r\n        type: [{ required: true, message: "请选择权限类型", trigger: "blur" }],\r\n      },\r\n      typeOptions: [\r\n        {\r\n          value: "MENU",\r\n          label: "菜单",\r\n        },\r\n        {\r\n          value: "REPORT",\r\n          label: "报表",\r\n        },\r\n      ],\r\n      parentIndexOptions: [],\r\n      pickerOptions0: {\r\n        disabledDate(time) {\r\n          return time.getTime() < Date.now() - 8.64e7;\r\n        },\r\n      },\r\n      dialogVisible: false,\r\n    };\r\n  },\r\n  computed: {\r\n    disabled: function() {\r\n      //                return this.dialogInfo.dialogType == \'edit\' ? true : false;\r\n      return false;\r\n    },\r\n  },\r\n  methods: {\r\n    getMenuPermissionsOptions() {\r\n      common.ajax({\r\n        url: "/web/v1/permission/getMenu",\r\n        type: "post",\r\n        contentType: "application/json",\r\n        dataType: "json",\r\n        success: res => {\r\n          if (res.status == 0 && res.data) {\r\n            let result = res.data;\r\n            this.parentIndexOptions = result.list;\r\n          }\r\n        },\r\n        error: err => {},\r\n      });\r\n    },\r\n    resetForm(formName) {\r\n      if (this.$refs[formName]) {\r\n        this.$refs[formName].resetFields();\r\n      }\r\n    },\r\n\r\n    submit(formName) {\r\n      if (!this.ruleForm.index) {\r\n        this.$message("请输入权限索引");\r\n        return false;\r\n      }\r\n      if (!this.ruleForm.name) {\r\n        this.$message("请输入权限名称");\r\n        return false;\r\n      }\r\n      if (!this.ruleForm.type) {\r\n        this.$message("请选择权限类型");\r\n        return false;\r\n      }\r\n\r\n      this.dialogInfo.disabled = true;\r\n      this.$emit("submitForm", this.dialogInfo.dialogType, this.ruleForm);\r\n    },\r\n\r\n    closeDialog() {\r\n      this.$emit("closeDialog");\r\n    },\r\n  },\r\n  created() {},\r\n  mounted() {\r\n    this.ruleForm = this.dialogInfo.form;\r\n\r\n    //            this.getMenuPermissionsOptions();\r\n  },\r\n  watch: {\r\n    dialogInfo: function(val, oldVal) {\r\n      if (val.dialogType == "add") {\r\n        this.resetForm("ruleForm");\r\n      }\r\n      this.getMenuPermissionsOptions();\r\n    },\r\n    id: function(val, oldVal) {\r\n      this.ruleForm = this.dialogInfo.form;\r\n    },\r\n    dialogFormVisible: function(val) {\r\n      this.dialogVisible = !!val;\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n']}])},518:function(e,r,n){"use strict";var t=n(159);n.n(t).a},519:function(e,r,n){(e.exports=n(4)(!0)).push([e.i,"\n.el-upload__files {\r\n  display: none;\n}\n.content-wrapper {\r\n  display: flex;\r\n  display: -webkit-flex;\r\n  display: -ms-flex;\r\n  margin: 0;\n}\r\n","",{version:3,sources:["src/views/contents/permission/permissionDialog.vue"],names:[],mappings:";AAgNA;EACA,aAAA;AACA;AAEA;EACA,aAAA;EACA,qBAAA;EACA,iBAAA;EACA,SAAA;AACA",file:"permissionDialog.vue?vue&type=style&index=1&lang=css&",sourcesContent:['\x3c!--\r\n * @Description: \r\n * @Author: jinxiaojian\r\n * @Email: jinxiaojian@youxin.com\r\n * @Date: 2019-07-12 16:17:33\r\n * @LastEditTime: 2019-07-16 16:55:39\r\n * @LastEditors: 靳肖健\r\n --\x3e\r\n<template>\r\n  <el-dialog\r\n    :title="dialogInfo.dialogType ==\'add\'?\'创建权限\':\'修改权限\'"\r\n    width="50%"\r\n    class="dialog-container"\r\n    v-model="dialogVisible"\r\n    :show-close="true"\r\n    @close="closeDialog"\r\n    :close-on-click-modal="false"\r\n  >\r\n    <div class="dialog-form">\r\n      <el-form class="formInputWidth" :rules="rules" ref="ruleForm" :model="ruleForm">\r\n        <el-form-item label="权限索引" prop="index" :label-width="formLabelWidth">\r\n          <el-input v-model="ruleForm.index" auto-complete="off" :disabled="disabled"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label="权限名称" prop="name" :label-width="formLabelWidth">\r\n          <el-input v-model="ruleForm.name" auto-complete="off" :disabled="disabled"></el-input>\r\n        </el-form-item>\r\n        \x3c!--<el-form-item label="权限级别" :label-width="formLabelWidth">--\x3e\r\n        \x3c!--<el-input v-model="ruleForm.level" auto-complete="off" :disabled="disabled"></el-input>--\x3e\r\n        \x3c!--</el-form-item>--\x3e\r\n        <el-form-item label="权限类型" prop="type" :label-width="formLabelWidth">\r\n          <el-select\r\n            ref="limitSelect"\r\n            v-model="ruleForm.type"\r\n            :disabled="disabled"\r\n            placeholder="请选择"\r\n          >\r\n            <el-option\r\n              v-for="item in typeOptions"\r\n              :key="item.value"\r\n              :label="item.label"\r\n              :value="item.value"\r\n            ></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label="权限父菜单" prop="parentIndex" :label-width="formLabelWidth">\r\n          <el-select\r\n            ref="limitSelect"\r\n            clearable\r\n            v-model="ruleForm.parentIndex"\r\n            :disabled="disabled"\r\n            placeholder="请选择"\r\n          >\r\n            <el-option\r\n              v-for="item in parentIndexOptions"\r\n              :key="item.value"\r\n              :label="item.label"\r\n              :value="item.value"\r\n            ></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label="权限描述" prop="description" :label-width="formLabelWidth">\r\n          <el-input\r\n            v-model="ruleForm.description"\r\n            auto-complete="off"\r\n            autosize\r\n            type="textarea"\r\n            :disabled="disabled"\r\n          ></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div v-if="!disabled" slot="footer" class="dialog-footer">\r\n        <el-button @click="resetForm(\'ruleForm\')">重置</el-button>\r\n        <span class="wd">&nbsp;</span>\r\n        <el-button type="primary" @click="submit(\'ruleForm\')" :disabled="dialogInfo.disabled">确认</el-button>\r\n      </div>\r\n    </div>\r\n  </el-dialog>\r\n</template>\r\n\r\n<style scoped>\r\n.el-dialog__wrapper .el-dialog--customer .el-dialog__header {\r\n  text-align: center;\r\n}\r\n\r\n.dialog-form {\r\n  width: 380px;\r\n}\r\n\r\n.el-select {\r\n  width: 200px;\r\n}\r\n\r\n.el-input {\r\n  width: 200px;\r\n}\r\n.el-input {\r\n  width: 200px;\r\n}\r\n\r\n.el-select .el-input {\r\n  width: 260px;\r\n}\r\n\r\n.el-select-dropdown__item {\r\n  max-width: 500px;\r\n}\r\n\r\n.dialog-footer {\r\n  text-align: center;\r\n}\r\n\r\n.el-upload ul {\r\n  display: none;\r\n}\r\n\r\n.download-btn {\r\n  text-align: center;\r\n  display: inline-block;\r\n  font-size: 12px;\r\n  border-radius: 5px;\r\n  line-height: 30px;\r\n  padding: 0 8px;\r\n  outline: none;\r\n  color: #ffffff;\r\n  background-color: #20a0ff;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.wd {\r\n  display: inline-block;\r\n  width: 50px;\r\n}\r\n\r\n.self-line-height {\r\n  line-height: 36px;\r\n}\r\n\r\n.self-line-height2 {\r\n  line-height: 48px;\r\n}\r\n\r\n.label-wrapper {\r\n  width: 100px;\r\n}\r\n\r\n.self-label {\r\n  text-align: right;\r\n  padding-right: 20px;\r\n}\r\n\r\n.el-row {\r\n  height: 50px;\r\n  line-height: 50px;\r\n}\r\n\r\n.el-form-item__label {\r\n  width: 200px;\r\n}\r\n\r\n.text {\r\n  font-size: 14px;\r\n}\r\n\r\n.item {\r\n  padding: 10px 20px;\r\n  margin: 10px 0;\r\n}\r\n\r\n.clearfix:before,\r\n.clearfix:after {\r\n  display: table;\r\n  content: "";\r\n}\r\n\r\n.clearfix:after {\r\n  clear: both;\r\n}\r\n\r\n.box-card {\r\n  width: 300px;\r\n  margin-right: 20px;\r\n}\r\n\r\n.txt-center {\r\n  text-align: center;\r\n}\r\n\r\n.jc-between {\r\n  justify-content: space-between;\r\n}\r\n\r\n.mt-30 {\r\n  margin-top: 50px;\r\n}\r\n\r\n.left {\r\n  float: right;\r\n}\r\n\r\n.form-content-width {\r\n  width: 420px;\r\n}\r\n\r\n.mb-30 {\r\n  margin-bottom: 22px;\r\n}\r\n</style>\r\n<style>\r\n.el-upload__files {\r\n  display: none;\r\n}\r\n\r\n.content-wrapper {\r\n  display: flex;\r\n  display: -webkit-flex;\r\n  display: -ms-flex;\r\n  margin: 0;\r\n}\r\n</style>\r\n\r\n<script>\r\nimport common from "../../../utils/common";\r\nexport default {\r\n  components: {},\r\n  props: ["dialogInfo", "dialogFormVisible", "id"],\r\n  data() {\r\n    return {\r\n      formLabelWidth: "100px",\r\n      ruleForm: {\r\n        id: "",\r\n        name: "",\r\n        index: "",\r\n        type: "",\r\n        description: "",\r\n        parentIndex: "",\r\n      },\r\n      rules: {\r\n        name: [{ required: true, message: "请输入权限名称", trigger: "blur" }],\r\n        index: [{ required: true, message: "请输入权限索引", trigger: "blur" }],\r\n        type: [{ required: true, message: "请选择权限类型", trigger: "blur" }],\r\n      },\r\n      typeOptions: [\r\n        {\r\n          value: "MENU",\r\n          label: "菜单",\r\n        },\r\n        {\r\n          value: "REPORT",\r\n          label: "报表",\r\n        },\r\n      ],\r\n      parentIndexOptions: [],\r\n      pickerOptions0: {\r\n        disabledDate(time) {\r\n          return time.getTime() < Date.now() - 8.64e7;\r\n        },\r\n      },\r\n      dialogVisible: false,\r\n    };\r\n  },\r\n  computed: {\r\n    disabled: function() {\r\n      //                return this.dialogInfo.dialogType == \'edit\' ? true : false;\r\n      return false;\r\n    },\r\n  },\r\n  methods: {\r\n    getMenuPermissionsOptions() {\r\n      common.ajax({\r\n        url: "/web/v1/permission/getMenu",\r\n        type: "post",\r\n        contentType: "application/json",\r\n        dataType: "json",\r\n        success: res => {\r\n          if (res.status == 0 && res.data) {\r\n            let result = res.data;\r\n            this.parentIndexOptions = result.list;\r\n          }\r\n        },\r\n        error: err => {},\r\n      });\r\n    },\r\n    resetForm(formName) {\r\n      if (this.$refs[formName]) {\r\n        this.$refs[formName].resetFields();\r\n      }\r\n    },\r\n\r\n    submit(formName) {\r\n      if (!this.ruleForm.index) {\r\n        this.$message("请输入权限索引");\r\n        return false;\r\n      }\r\n      if (!this.ruleForm.name) {\r\n        this.$message("请输入权限名称");\r\n        return false;\r\n      }\r\n      if (!this.ruleForm.type) {\r\n        this.$message("请选择权限类型");\r\n        return false;\r\n      }\r\n\r\n      this.dialogInfo.disabled = true;\r\n      this.$emit("submitForm", this.dialogInfo.dialogType, this.ruleForm);\r\n    },\r\n\r\n    closeDialog() {\r\n      this.$emit("closeDialog");\r\n    },\r\n  },\r\n  created() {},\r\n  mounted() {\r\n    this.ruleForm = this.dialogInfo.form;\r\n\r\n    //            this.getMenuPermissionsOptions();\r\n  },\r\n  watch: {\r\n    dialogInfo: function(val, oldVal) {\r\n      if (val.dialogType == "add") {\r\n        this.resetForm("ruleForm");\r\n      }\r\n      this.getMenuPermissionsOptions();\r\n    },\r\n    id: function(val, oldVal) {\r\n      this.ruleForm = this.dialogInfo.form;\r\n    },\r\n    dialogFormVisible: function(val) {\r\n      this.dialogVisible = !!val;\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n']}])},520:function(e,r,n){"use strict";var t=n(160);n.n(t).a},521:function(e,r,n){(e.exports=n(4)(!0)).push([e.i,"\n.el-table th > .cell[data-v-2a046e1d] {\r\n  text-align: center;\n}\n.create[data-v-2a046e1d] {\r\n  float: right;\r\n  margin-bottom: 20px;\n}\n.mb-10[data-v-2a046e1d] {\r\n  margin-bottom: 10px;\n}\r\n","",{version:3,sources:["src/views/contents/permission/permissionManage.vue"],names:[],mappings:";AAsDA;EACA,kBAAA;AACA;AAEA;EACA,YAAA;EACA,mBAAA;AACA;AAEA;EACA,mBAAA;AACA",file:"permissionManage.vue?vue&type=style&index=0&id=2a046e1d&scoped=true&lang=css&",sourcesContent:['\x3c!--\r\n * @Description: \r\n * @Author: 焦丙乾(jiaobingqian)\r\n * @Email: jiaobq123@163.com\r\n * @Date: 2019-07-15 18:33:54\r\n * @LastEditTime: 2019-07-18 17:16:44\r\n * @LastEditors: 靳肖健\r\n --\x3e\r\n<template>\r\n  <tab-page ref="tabPage">\r\n    <template slot="permissionManage">\r\n      <data-table :data-table="dataTable" ref="dataTable">\r\n        <div slot="conditions" style="margin-bottom:15px">\r\n          <el-button\r\n            type="primary"\r\n            class="create"\r\n            size="small"\r\n            @click="add()"\r\n          >&nbsp;&nbsp;新建&nbsp;&nbsp;</el-button>\r\n        </div>\r\n        <template slot="columns">\r\n          <el-table-column prop="name" label="权限名称" align="left" width></el-table-column>\r\n          <el-table-column prop="index" label="权限索引" align="left" width></el-table-column>\r\n          <el-table-column label="类型" align="center">\r\n            <template slot-scope="scope">\r\n              <el-tag :type="scope.row.type | typeFilter">{{scope.row.type=="MENU"?\'菜单\':\'报表\'}}</el-tag>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop="parent_index" label="父菜单" align="left" width></el-table-column>\r\n          <el-table-column label="状态" width="90">\r\n            <template slot-scope="scope">\r\n              <el-tag :type="scope.row.flag | flagFilter">{{scope.row.flag == 0?\'使用中\':\'已失效\'}}</el-tag>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column label="操作" align="center" width>\r\n            <template slot-scope="scope">\r\n              <el-button type="text" size="small" @click="edit(scope.row)">编辑</el-button>\r\n              <el-button type="text" size="small" @click="destroy(scope.row)">删除</el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </template>\r\n      </data-table>\r\n      <report-permission\r\n        ref="ruleForm"\r\n        :dialogInfo="dialogInfos"\r\n        :dialogFormVisible="showDialog"\r\n        :id="dialogId"\r\n        @submitForm="submitForm"\r\n        v-on:closeDialog="closeDetailDialog"\r\n      ></report-permission>\r\n    </template>\r\n  </tab-page>\r\n</template>\r\n<style scoped>\r\n.el-table th > .cell {\r\n  text-align: center;\r\n}\r\n\r\n.create {\r\n  float: right;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.mb-10 {\r\n  margin-bottom: 10px;\r\n}\r\n</style>\r\n<script>\r\nimport Common from "../../../utils/common";\r\nimport DataTable from "../../../components/DataTable";\r\nimport TabPage from "../../../components/TabPage";\r\nimport ReportPermission from "../permission/permissionDialog.vue";\r\nexport default {\r\n  components: {\r\n    DataTable,\r\n    TabPage,\r\n    ReportPermission,\r\n    Common,\r\n  },\r\n  data() {\r\n    return {\r\n      showDialog: false,\r\n      dataTable: {\r\n        pageSize: 1000,\r\n        pageSizes: [10, 20, 50, 100, 1000],\r\n        url: "/web/v1/permission/getAll",\r\n        restful: true,\r\n        queryParams: {},\r\n        emptyText: "没有记录",\r\n      },\r\n      dialogInfos: {\r\n        dialogType: "add",\r\n        form: {\r\n          id: "",\r\n          name: "",\r\n          index: "",\r\n          type: "",\r\n          parenIndex: "",\r\n          level: "",\r\n          description: "",\r\n        },\r\n        disabled: false,\r\n      },\r\n      dialogId: null,\r\n    };\r\n  },\r\n  filters: {\r\n    typeFilter(item) {\r\n      const itemsMap = {\r\n        MENU: "success",\r\n        REPORT: "primary",\r\n      };\r\n      return itemsMap[item];\r\n    },\r\n    flagFilter(item) {\r\n      const itemsMap = {\r\n        0: "success",\r\n        1: "error",\r\n      };\r\n      return itemsMap[item];\r\n    },\r\n  },\r\n  mounted() {\r\n    var defaultPage = {\r\n      label: "权限管理",\r\n      name: "permissionManage",\r\n      slotName: "permissionManage",\r\n      closable: false,\r\n    };\r\n    this.$refs.tabPage.$emit("open-tab", defaultPage);\r\n  },\r\n  methods: {\r\n    loadLists() {\r\n      this.$refs.dataTable.$emit("load-data");\r\n    },\r\n\r\n    enableSubmit() {\r\n      this.dialogInfos.disabled = false;\r\n    },\r\n    add() {\r\n      this.openDialog();\r\n    },\r\n    edit(row) {\r\n      this.openDialog(row);\r\n    },\r\n    destroy(row) {\r\n      let self = this;\r\n      this.$confirm("是否确认删除该权限?", "提示", {\r\n        confirmButtonText: "确认",\r\n        cancelButtonText: "取消",\r\n        type: "warning",\r\n      })\r\n        .then(() => {\r\n          Common.ajax({\r\n            url: "/web/v1/permission/delete/" + row.id,\r\n            type: "post",\r\n            data: {},\r\n            restful: true,\r\n            contentType: "application/json",\r\n            success(response) {\r\n              self.$alert("删除成功", "", {\r\n                type: "success",\r\n                confirmButtonText: "知道了",\r\n                callback: action => {\r\n                  self.$refs.dataTable.$emit("load-data");\r\n                  self.$refs.history && this.$refs.history.$emit("load-data");\r\n                },\r\n              });\r\n            },\r\n            error(response) {\r\n              this.$message({\r\n                message: response.message,\r\n                type: "warning",\r\n              });\r\n            },\r\n          });\r\n        })\r\n        .catch(e => {\r\n          // console.log(e);\r\n        });\r\n    },\r\n    closeDetailDialog() {\r\n      this.showDialog = false;\r\n    },\r\n    openDialog(row) {\r\n      if (!row) {\r\n        row = {};\r\n      }\r\n\r\n      var dialogType = row.id ? "edit" : "add";\r\n      this.dialogInfos = {\r\n        dialogType: dialogType,\r\n        form: {\r\n          id: row.id || "",\r\n          name: row.name || "",\r\n          index: row.index || "",\r\n          type: row.type || "",\r\n          parentIndex: row.parent_index || "",\r\n          level: row.level || "",\r\n          description: row.description || "",\r\n        },\r\n        disabled: false,\r\n      };\r\n      this.dialogId = row.id || "";\r\n      this.showDialog = true;\r\n    },\r\n    submitForm(...args) {\r\n      let successMessage = "";\r\n      let { id, name, index, type, description, parentIndex } = args[1];\r\n\r\n      let requestType = args[0];\r\n      var optionType = "post";\r\n      var optionUrl = "/web/v1/permission";\r\n      var successText = "添加权限成功";\r\n      if (requestType == "edit") {\r\n        optionUrl = optionUrl + "/" + id;\r\n        successText = "更新权限成功";\r\n      }\r\n      if (name && index && type) {\r\n        Common.ajax({\r\n          url: optionUrl,\r\n          type: optionType,\r\n          data: {\r\n            name,\r\n            index,\r\n            type,\r\n            description,\r\n            parentIndex,\r\n          },\r\n          restful: true,\r\n          contentType: "application/json",\r\n          dataType: "json",\r\n          success: res => {\r\n            this.alertMessage = successMessage;\r\n            this.$alert(successText, "", {\r\n              type: "success",\r\n              confirmButtonText: "知道了",\r\n              callback: action => {\r\n                this.enableSubmit();\r\n                this.showDialog = false;\r\n              },\r\n            });\r\n          },\r\n          error: err => {\r\n            let error = err.message || err;\r\n            this.alertMessage = error;\r\n            err.message &&\r\n              this.$alert(this.alertMessage, "", {\r\n                type: "error",\r\n                confirmButtonText: "知道了",\r\n                callback: action => {\r\n                  this.enableSubmit();\r\n                },\r\n              });\r\n          },\r\n          complete: () => {\r\n            this.$refs.dataTable.$emit("load-data");\r\n            this.$refs.history && this.$refs.history.$emit("load-data");\r\n          },\r\n        });\r\n      } else {\r\n        this.$message({\r\n          showClose: true,\r\n          message: "必填字段不能为空!",\r\n          type: "error",\r\n          duration: 3000,\r\n        });\r\n        this.enableSubmit();\r\n      }\r\n    },\r\n  },\r\n};\r\n<\/script>\r\n']}])}}]);
//# sourceMappingURL=23.2be915a214a24854bb11.js.map