(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{1040:function(e,r,t){"use strict";t.r(r);var n=t(11),a=t.n(n),l=t(2),i=t(1),s=t(9),o=t(8),m=t(7),c={components:{DataTable:s.a,TabPage:o.a},data:function(){return{sourceCheckAll:!1,deviceCheckAll:!1,sourceOptions:[],deviceOptions:[{value:"iOS",label:"iOS"},{value:"Android",label:"Android"}],ksjkOptions:[{value:"是",label:"是"},{value:"否",label:"否"}],initBeginTime:"",initEndTime:"",queryParams:{source:"",device:"",isksjk:"",beginTime:[],endTime:[],dateRange:[Object(i.a)(new Date,"yyyy-MM-dd")+" 00:00:00",new Date]},dataTable:{pageSize:50,pageSizes:[10,20,50,100,1e3],url:"/web/v1/market/queryMarketDetailByHour",emptyText:"没有记录",showSummary:!0,summaryMethod:this.getSummaries}}},mounted:function(){this.dataTable.queryParams=this.queryParams,this.initBeginTime=this.dealDate(this.queryParams.dateRange[0],"yyyy-MM-dd"),this.initEndTime=this.dealDate(this.queryParams.dateRange[1],"yyyy-MM-dd"),this.dataTable.queryParams.beginTime=this.initBeginTime+" 00:00:00",this.dataTable.queryParams.endTime=this.initEndTime+" 23:59:59",this.$refs.tabPage.$emit("open-tab",{label:"市场厂商类",name:"h5Statistics",slotName:"h5Statistics",closable:!1}),this.getSources()},methods:{loadLists:function(){this.$refs.dataTable.$emit("load-data")},onSubmit:function(){this.dataTable.queryParams=this.queryParams,this.initBeginTime=this.dealTime(this.queryParams.dateRange[0]),this.initEndTime=this.dealTime(this.queryParams.dateRange[1]),this.dataTable.queryParams.beginTime=this.initBeginTime,this.dataTable.queryParams.endTime=this.initEndTime,this.dataTable.url="/web/v1/market/queryMarketDetailByHour",this.$refs.dataTable.$emit("load-data")},warnTime:function(e,r){return e?r?!!(new Date(e).getTime()>new Date(r).getTime())&&(this.$notify({message:"查询开始时间不能大于结束时间",type:"warning"}),!0):(this.$notify({message:"查询结束时间不能为空！",type:"warning"}),!0):(this.$notify({message:"查询开始时间不能为空！",type:"warning"}),!0)},dealTime:function(e){return Object(i.a)(new Date(e),"yyyy-MM-dd hh:mm:ss")},formatterDate:function(e){return Object(i.a)(e.date,"yyyy-MM-dd")},dealDate:function(e){return Object(i.a)(new Date(e),"yyyy-MM-dd")},getSummaries:function(e){var r=e.columns,t=e.data,n=[];return r.forEach(function(e,r){var a;0!==r?(a=12===r||13===r||14===r?t.map(function(r){if(null!==r[e.property])return+r[e.property].replace("%","")}):t.map(function(r){return+r[e.property]})).every(function(e){return isNaN(e)})?n[r]="N/A":(n[r]=a.reduce(function(e,r){return isNaN(+r)?e:e+r},0),(12===r||13===r||14===r)&&(n[r]=(n[r]/t.length).toFixed(2)+" %")):n[r]="总计"}),n},exportExcel:function(){var e=this,r={};a()(r,this.dataTable.queryParams),r.pageSize=this.$refs.dataTable.total,r.page=1,this.$refs.dataTable.$emit("export-data",r),Promise.all([t.e(0),t.e(2)]).then(function(){var r=t(1028).export_json_to_excel,n=["日期","小时","设备","快速借款用户","source","手机号","注册","激活","进件","审核","放款","放款金额","注册/激活","进件/注册","审核/进件"],a=["date","hour","plat","ksjk_existing","source","phones_count","register_count","activation_count","jinjian","approval","emitCn","emitMoney","act_reg_rate","jj_reg_rate","review_jinj_rate"];setTimeout(function(){var t=e.$refs.dataTable.dataListA,l=e.formatJson(a,t);r(n,l,"市场厂商类(小时)")},300)}.bind(null,t)).catch(t.oe)},formatJson:function(e,r){return r.map(function(r){return e.map(function(e){return"operator"==e?r[e].name:r[e]})})},getSources:function(){var e=this;l.a.ajax({url:"/web/v1/options/market/sources",type:"POST",contentType:"application/json",success:function(r){r.data&&r.data.list&&(e.sourceOptions=r.data.list)},error:function(e){var r=e.message||e;m.Notification.error({title:"错误",message:r})}})},checkAllSelection:function(e){for(var r=this.$refs[e].optionsCount,t=0;t<r;t++)!function(r,t){setTimeout(function(){t.$refs[e].handleOptionSelect(t.$refs[e].options[r])},0)}(t,this)},handleCheckAllDeviceChange:function(){this.checkAllSelection("deviceSelect"),this.deviceCheckAll=!this.deviceCheckAll},handleCheckAllSourceChange:function(){this.checkAllSelection("sourceSelect"),this.sourceCheckAll=!this.sourceCheckAll},setCheckAllStyle:function(e,r){var t=r+"CheckAll",n=r+"Select";this[t]?e.length<this.$refs[n].optionsCount&&(this[t]=!this[t]):e.length===this.$refs[n].optionsCount&&(this[t]=!this[t])},deviceChange:function(e){this.setCheckAllStyle(e,"device")},sourceChange:function(e){this.setCheckAllStyle(e,"source")}}},u=(t(626),t(628),t(3)),d=Object(u.a)(c,function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[t("tab-page",{ref:"tabPage"},[t("template",{slot:"h5Statistics"},[t("data-table",{ref:"dataTable",attrs:{"data-table":e.dataTable}},[t("div",{staticStyle:{"margin-bottom":"15px"},attrs:{slot:"conditions"},slot:"conditions"},[t("el-form",{attrs:{inline:!0,model:e.queryParams}},[t("el-form-item",[t("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.queryParams.dateRange,callback:function(r){e.$set(e.queryParams,"dateRange",r)},expression:"queryParams.dateRange"}})],1),e._v(" "),t("el-form-item",[t("el-select",{attrs:{clearable:"",filterable:"",placeholder:"设备",size:"small"},model:{value:e.queryParams.device,callback:function(r){e.$set(e.queryParams,"device",r)},expression:"queryParams.device"}},e._l(e.deviceOptions,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),t("el-form-item",[t("el-select",{attrs:{clearable:"",filterable:"",placeholder:"source",multiple:"","collapse-tags":"",size:"small"},model:{value:e.queryParams.source,callback:function(r){e.$set(e.queryParams,"source",r)},expression:"queryParams.source"}},e._l(e.sourceOptions,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),t("el-form-item",[t("el-select",{attrs:{clearable:"",filterable:"",placeholder:"快速借款",size:"small"},model:{value:e.queryParams.isksjk,callback:function(r){e.$set(e.queryParams,"isksjk",r)},expression:"queryParams.isksjk"}},e._l(e.ksjkOptions,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),t("el-form-item",[t("el-button",{staticStyle:{"margin-top":"0"},attrs:{type:"primary",size:"small"},on:{click:e.onSubmit}},[e._v("查询\n              ")])],1)],1),e._v(" "),t("el-button",{staticClass:"right mb-10",attrs:{type:"primary",size:"small",icon:"el-icon-document"},on:{click:e.exportExcel}},[e._v("导出excel\n          ")])],1),e._v(" "),t("template",{slot:"columns"},[t("el-table-column",{attrs:{type:"index",label:"序号",width:"60"}}),e._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"date_str",label:"日期",width:"120"}}),e._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"hour",label:"小时",width:"120"}}),e._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"plat",label:"设备",width:"100"}}),e._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"ksjk_existing",label:"快速借款用户",width:"120"}}),e._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"source",label:"source",width:"150"}}),e._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"activation_count",label:"激活"}}),e._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"register_count",label:"注册"}}),e._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"jinjian",label:"当日进件"}}),e._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"approval",label:"当日审核"}}),e._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"emitCn",label:"当日放款"}}),e._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"emitMoney",label:"放款金额"}}),e._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"act_reg_rate",label:"注册/激活",width:"90"}}),e._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"jj_reg_rate",label:"进件/注册",width:"90"}}),e._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"review_jinj_rate",label:"审核/进件",width:"90"}})],1)],2)],1)],2)],1)},[],!1,null,"118e3a23",null);r.default=d.exports},213:function(e,r,t){var n=t(627);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,t(5).default)("d0c2df54",n,!0,{})},214:function(e,r,t){var n=t(629);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,t(5).default)("ce43013c",n,!0,{})},626:function(e,r,t){"use strict";var n=t(213);t.n(n).a},627:function(e,r,t){(e.exports=t(4)(!0)).push([e.i,"\n.el-form-item__content .el-button[data-v-118e3a23] {\n  margin-top: 20px;\n}\n.el-table--border th[data-v-118e3a23] {\n  text-align: center;\n}\n.el-table th .cell[data-v-118e3a23] {\n  text-align: center;\n}\n.el-form--inline .el-form-item[data-v-118e3a23] {\n  margin-right: 2px;\n}\n.el-form-item[data-v-118e3a23] {\n  margin-bottom: 2px;\n}\n.el-dialog__footer[data-v-118e3a23] {\n  padding: 10px 0px;\n  text-align: center;\n}\n.check-all-select[data-v-118e3a23] {\n  padding: 10px;\n}\n.check-all-select span.text-all[data-v-118e3a23] {\n  font-size: 14px;\n  font-weight: bold;\n}\n.check-all-select label[data-v-118e3a23] {\n  float: right;\n}\n.mb-10[data-v-118e3a23] {\n  margin-bottom: 10px;\n}\n","",{version:3,sources:["src/views/contents/market/marketCategoryDetailByHour.vue"],names:[],mappings:";AA0FA;EACA,gBAAA;AACA;AAEA;EACA,kBAAA;AACA;AAEA;EACA,kBAAA;AACA;AAEA;EACA,iBAAA;AACA;AAEA;EACA,kBAAA;AACA;AAEA;EACA,iBAAA;EACA,kBAAA;AACA;AAEA;EACA,aAAA;AACA;AAEA;EACA,eAAA;EACA,iBAAA;AACA;AAEA;EACA,YAAA;AACA;AAEA;EACA,mBAAA;AACA",file:"marketCategoryDetailByHour.vue?vue&type=style&index=0&id=118e3a23&scoped=true&lang=css&",sourcesContent:['<template>\r\n  <div>\r\n    <tab-page ref="tabPage">\r\n      <template slot="h5Statistics">\r\n        <data-table :data-table="dataTable" ref="dataTable">\r\n          <div slot="conditions" style="margin-bottom:15px">\r\n            <el-form :inline="true" :model="queryParams">\r\n              <el-form-item>\r\n                \x3c!--<el-date-picker--\x3e\r\n                  \x3c!--v-model="queryParams.dateRange"--\x3e\r\n                  \x3c!--type="daterange"--\x3e\r\n                  \x3c!--size="small"--\x3e\r\n                  \x3c!--placeholder="选择日期范围">--\x3e\r\n                \x3c!--</el-date-picker>--\x3e\r\n                <el-date-picker\r\n                  v-model="queryParams.dateRange"\r\n                  type="datetimerange"\r\n                  range-separator="至"\r\n                  start-placeholder="开始日期"\r\n                  end-placeholder="结束日期">\r\n                </el-date-picker>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-select v-model="queryParams.device" clearable filterable placeholder="设备"\r\n                           size="small">\r\n                  <el-option\r\n                    v-for="item in deviceOptions"\r\n                    :key="item.value"\r\n                    :label="item.label"\r\n                    :value="item.value">\r\n                  </el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n\r\n              <el-form-item>\r\n                <el-select v-model="queryParams.source" clearable filterable placeholder="source"\r\n                multiple  collapse-tags\r\n                           size="small">\r\n                  <el-option\r\n                    v-for="item in sourceOptions"\r\n                    :key="item.value"\r\n                    :label="item.label"\r\n                    :value="item.value">\r\n                  </el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-select v-model="queryParams.isksjk" clearable filterable placeholder="快速借款"\r\n                           size="small">\r\n                  <el-option\r\n                    v-for="item in ksjkOptions"\r\n                    :key="item.value"\r\n                    :label="item.label"\r\n                    :value="item.value">\r\n                  </el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-button type="primary" @click="onSubmit" size="small" style="margin-top:0">查询\r\n                </el-button>\r\n              </el-form-item>\r\n            </el-form>\r\n            <el-button class="right mb-10" type="primary" size="small" icon="el-icon-document"\r\n                       @click="exportExcel">导出excel\r\n            </el-button>\r\n          </div>\r\n          <template slot="columns">\r\n            <el-table-column type="index" label="序号" width="60"></el-table-column>\r\n            <el-table-column sortable prop="date_str" label="日期" width="120"></el-table-column>\r\n            <el-table-column sortable prop="hour" label="小时" width="120"></el-table-column>\r\n            <el-table-column sortable prop="plat" label="设备" width="100"></el-table-column>\r\n            <el-table-column sortable prop="ksjk_existing" label="快速借款用户" width="120"></el-table-column>\r\n            <el-table-column sortable prop="source" label="source" width="150"></el-table-column>\r\n            <el-table-column sortable prop="activation_count" label="激活"></el-table-column>\r\n            <el-table-column sortable prop="register_count" label="注册"></el-table-column>\r\n            <el-table-column sortable prop="jinjian" label="当日进件"></el-table-column>\r\n            <el-table-column sortable prop="approval" label="当日审核"></el-table-column>\r\n            <el-table-column sortable prop="emitCn" label="当日放款"></el-table-column>\r\n            <el-table-column sortable prop="emitMoney" label="放款金额"></el-table-column>\r\n            <el-table-column sortable prop="act_reg_rate" label="注册/激活" width="90"></el-table-column>\r\n            <el-table-column sortable prop="jj_reg_rate" label="进件/注册" width="90"></el-table-column>\r\n            <el-table-column sortable prop="review_jinj_rate" label="审核/进件" width="90"></el-table-column>\r\n\r\n          </template>\r\n        </data-table>\r\n      </template>\r\n    </tab-page>\r\n  </div>\r\n</template>\r\n<style scoped>\r\n  .el-form-item__content .el-button {\r\n    margin-top: 20px;\r\n  }\r\n\r\n  .el-table--border th {\r\n    text-align: center;\r\n  }\r\n\r\n  .el-table th .cell {\r\n    text-align: center;\r\n  }\r\n\r\n  .el-form--inline .el-form-item {\r\n    margin-right: 2px;\r\n  }\r\n\r\n  .el-form-item {\r\n    margin-bottom: 2px;\r\n  }\r\n\r\n  .el-dialog__footer {\r\n    padding: 10px 0px;\r\n    text-align: center;\r\n  }\r\n\r\n  .check-all-select {\r\n    padding: 10px;\r\n  }\r\n\r\n  .check-all-select span.text-all {\r\n    font-size: 14px;\r\n    font-weight: bold;\r\n  }\r\n\r\n  .check-all-select label {\r\n    float: right;\r\n  }\r\n\r\n  .mb-10 {\r\n    margin-bottom: 10px;\r\n  }\r\n</style>\r\n<script>\r\n  import common from \'../../../utils/common\'\r\n  import formatDate from \'../../../utils/formatDate\'\r\n  import DataTable from "../../../components/DataTable"\r\n  import TabPage from "../../../components/TabPage"\r\n  import {Notification} from \'element-ui\'\r\n  export default{\r\n    components: {\r\n      DataTable,\r\n      TabPage,\r\n    },\r\n    data(){\r\n      let today = formatDate(new Date(), \'yyyy-MM-dd\') + \' 00:00:00\';\r\n      let now = new Date();\r\n      return {\r\n        sourceCheckAll: false,\r\n        deviceCheckAll: false,\r\n        sourceOptions: [],\r\n        deviceOptions: [\r\n          {\r\n            value: \'iOS\',\r\n            label: \'iOS\'\r\n          },\r\n          {\r\n            value: \'Android\',\r\n            label: \'Android\'\r\n          }\r\n        ],\r\n        ksjkOptions: [\r\n          {\r\n            value: \'是\',\r\n            label: \'是\'\r\n          },\r\n          {\r\n            value: \'否\',\r\n            label: \'否\'\r\n          }\r\n        ],\r\n        initBeginTime: \'\',\r\n        initEndTime: \'\',\r\n\r\n        queryParams: {\r\n          source: \'\',\r\n          device: \'\',\r\n          isksjk: \'\',\r\n          beginTime: [],//开始时间\r\n          endTime: [],//结束时间\r\n          dateRange: [today, now],\r\n        },\r\n        dataTable: {\r\n          pageSize: 50,\r\n          pageSizes: [10, 20, 50, 100, 1000],\r\n          url: "/web/v1/market/queryMarketDetailByHour",\r\n          emptyText: \'没有记录\',\r\n          showSummary: true,\r\n          summaryMethod: this.getSummaries,\r\n        },\r\n      }\r\n    },\r\n    mounted(){\r\n      this.dataTable.queryParams = this.queryParams;\r\n      this.initBeginTime = this.dealDate(this.queryParams.dateRange[0], \'yyyy-MM-dd\');\r\n      this.initEndTime = this.dealDate(this.queryParams.dateRange[1], \'yyyy-MM-dd\');\r\n      this.dataTable.queryParams.beginTime = this.initBeginTime + \' 00:00:00\';\r\n      this.dataTable.queryParams.endTime = this.initEndTime + \' 23:59:59\';\r\n\r\n      var defaultPage = {label: "市场厂商类", name: "h5Statistics", slotName: \'h5Statistics\', closable: false};\r\n      this.$refs.tabPage.$emit("open-tab", defaultPage);\r\n\r\n      this.getSources();\r\n    },\r\n    methods: {\r\n      loadLists(){\r\n        this.$refs.dataTable.$emit(\'load-data\');\r\n      },\r\n\r\n      onSubmit: function () {\r\n        this.dataTable.queryParams = this.queryParams;\r\n        this.initBeginTime = this.dealTime(this.queryParams.dateRange[0]);\r\n        this.initEndTime = this.dealTime(this.queryParams.dateRange[1]);\r\n        this.dataTable.queryParams.beginTime = this.initBeginTime ;\r\n        this.dataTable.queryParams.endTime = this.initEndTime;\r\n\r\n        this.dataTable.url = \'/web/v1/market/queryMarketDetailByHour\';\r\n        this.$refs.dataTable.$emit(\'load-data\');\r\n      },\r\n      warnTime(startTime, endTime){\r\n        if (!startTime) {\r\n          this.$notify({\r\n            message: \'查询开始时间不能为空！\',\r\n            type: \'warning\'\r\n          });\r\n          return true;\r\n        }\r\n        if (!endTime) {\r\n          this.$notify({\r\n            message: \'查询结束时间不能为空！\',\r\n            type: \'warning\'\r\n          });\r\n          return true;\r\n        }\r\n        let timeStart = new Date(startTime).getTime();\r\n        let timeEnd = new Date(endTime).getTime();\r\n        if (timeStart > timeEnd) {\r\n          this.$notify({\r\n            message: \'查询开始时间不能大于结束时间\',\r\n            type: \'warning\'\r\n          });\r\n          return true;\r\n        }\r\n        return false;\r\n      },\r\n      dealTime(time){\r\n        return formatDate(new Date(time), \'yyyy-MM-dd hh:mm:ss\');\r\n      },\r\n      formatterDate(row, column){\r\n        return formatDate(row.date, \'yyyy-MM-dd\');\r\n      },\r\n      dealDate(date){\r\n        return formatDate(new Date(date), \'yyyy-MM-dd\');\r\n      },\r\n       getSummaries (param) {\r\n        const {columns, data} = param;\r\n        const sums = [];\r\n        columns.forEach((column, index) => {\r\n          if (index === 0) {\r\n            sums[index] = \'总计\';\r\n            return;\r\n          }\r\n          var values;\r\n          if(index === 12||index === 13||index === 14){\r\n             values = data.map(item =>{\r\n               if(item[column.property]!==null){\r\n                 return Number(item[column.property].replace(\'%\',\'\'));\r\n               }\r\n             });\r\n          }else{\r\n            values = data.map(item => Number(item[column.property]));\r\n          }\r\n\r\n          if (!values.every(value => isNaN(value))) {\r\n            sums[index] = values.reduce((prev, curr) => {\r\n              const value = Number(curr);\r\n              if (!isNaN(value)) {\r\n                return prev + curr;\r\n              } else {\r\n                return prev;\r\n              }\r\n            }, 0);\r\n            if(index === 12||index === 13||index === 14){\r\n              sums[index]=(sums[index]/data.length).toFixed(2)+ \' %\';\r\n            }\r\n            //sums[index] += \' 元\';\r\n          } else {\r\n            sums[index] = \'N/A\';\r\n          }\r\n        });\r\n\r\n        return sums;\r\n      },\r\n      exportExcel() {\r\n        let self=this;\r\n        var exportParams = {};\r\n        Object.assign(exportParams, this.dataTable.queryParams);\r\n        exportParams.pageSize = this.$refs.dataTable.total;\r\n        exportParams.page = 1;\r\n        this.$refs.dataTable.$emit(\'export-data\',exportParams);\r\n        require.ensure([], () => {\r\n          const {export_json_to_excel} = require(\'vendor/Export2Excel\');\r\n          const tHeader = [\'日期\', \'小时\', \'设备\', \'快速借款用户\', \'source\', \'手机号\', \'注册\', \'激活\', \'进件\', \'审核\', \'放款\', \'放款金额\', \'注册/激活\', \'进件/注册\', \'审核/进件\'];\r\n          const filterVal = [\'date\', \'hour\', \'plat\', \'ksjk_existing\', \'source\', \'phones_count\', \'register_count\', \'activation_count\', \'jinjian\', \'approval\', \'emitCn\', \'emitMoney\', \'act_reg_rate\', \'jj_reg_rate\', \'review_jinj_rate\'];\r\n          setTimeout(() => {\r\n            const list = this.$refs.dataTable.dataListA;\r\n            const data = this.formatJson(filterVal, list);\r\n            export_json_to_excel(tHeader, data, \'市场厂商类(小时)\');\r\n          }, 300);\r\n        })\r\n      },\r\n      formatJson(filterVal, jsonData) {\r\n        return jsonData.map(v => filterVal.map(j => {\r\n          let returnValue;\r\n          if (j == \'operator\') {\r\n            returnValue = v[j].name;\r\n          } else {\r\n            returnValue = v[j];\r\n          }\r\n          return returnValue;\r\n        }))\r\n      },\r\n\r\n      getSources(){\r\n        common.ajax({\r\n          url: \'/web/v1/options/market/sources\',\r\n          type: \'POST\',\r\n          contentType: \'application/json\',\r\n          success: (response) => {\r\n            if (response.data && response.data.list) {\r\n              this.sourceOptions = response.data.list;\r\n            }\r\n          },\r\n          error: (err) => {\r\n            let error = err.message || err;\r\n            Notification.error({\r\n              title: \'错误\',\r\n              message: error\r\n            });\r\n          }\r\n        });\r\n      },\r\n\r\n      checkAllSelection(selectType){\r\n        let len = this.$refs[selectType].optionsCount;\r\n//        let seletedLen =  this.$refs[selectType].selected.length;\r\n\r\n        for (var i = 0; i < len; i++) {\r\n          (function (index, _this) {\r\n            setTimeout(() => {\r\n              _this.$refs[selectType].handleOptionSelect(_this.$refs[selectType].options[index]);\r\n            }, 0);\r\n          })(i, this);\r\n        }\r\n\r\n      },\r\n      handleCheckAllDeviceChange(event) {\r\n        this.checkAllSelection("deviceSelect");\r\n        this.deviceCheckAll = !this.deviceCheckAll;\r\n      },\r\n      handleCheckAllSourceChange(event) {\r\n        this.checkAllSelection("sourceSelect");\r\n        this.sourceCheckAll = !this.sourceCheckAll;\r\n      },\r\n      setCheckAllStyle(selectedCount, selectType){\r\n        let type = selectType + \'CheckAll\';\r\n        let type_1 = selectType + \'Select\';\r\n        if (this[type]) {\r\n          if (selectedCount.length < this.$refs[type_1].optionsCount) {\r\n            this[type] = !this[type];\r\n          }\r\n        } else {\r\n          if (selectedCount.length === this.$refs[type_1].optionsCount) {\r\n            this[type] = !this[type];\r\n          }\r\n        }\r\n      },\r\n      deviceChange(values){\r\n        this.setCheckAllStyle(values, "device");\r\n      },\r\n      sourceChange(values){\r\n        this.setCheckAllStyle(values, "source");\r\n      },\r\n    },\r\n  }\r\n<\/script>\r\n<style>\r\n  .span-style {\r\n    display: inline-block;\r\n    margin-top: 8px;\r\n    font-size: 14px;\r\n  }\r\n</style>\r\n']}])},628:function(e,r,t){"use strict";var n=t(214);t.n(n).a},629:function(e,r,t){(e.exports=t(4)(!0)).push([e.i,"\n.span-style {\n  display: inline-block;\n  margin-top: 8px;\n  font-size: 14px;\n}\n","",{version:3,sources:["src/views/contents/market/marketCategoryDetailByHour.vue"],names:[],mappings:";AAkYA;EACA,qBAAA;EACA,eAAA;EACA,eAAA;AACA",file:"marketCategoryDetailByHour.vue?vue&type=style&index=1&lang=css&",sourcesContent:['<template>\r\n  <div>\r\n    <tab-page ref="tabPage">\r\n      <template slot="h5Statistics">\r\n        <data-table :data-table="dataTable" ref="dataTable">\r\n          <div slot="conditions" style="margin-bottom:15px">\r\n            <el-form :inline="true" :model="queryParams">\r\n              <el-form-item>\r\n                \x3c!--<el-date-picker--\x3e\r\n                  \x3c!--v-model="queryParams.dateRange"--\x3e\r\n                  \x3c!--type="daterange"--\x3e\r\n                  \x3c!--size="small"--\x3e\r\n                  \x3c!--placeholder="选择日期范围">--\x3e\r\n                \x3c!--</el-date-picker>--\x3e\r\n                <el-date-picker\r\n                  v-model="queryParams.dateRange"\r\n                  type="datetimerange"\r\n                  range-separator="至"\r\n                  start-placeholder="开始日期"\r\n                  end-placeholder="结束日期">\r\n                </el-date-picker>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-select v-model="queryParams.device" clearable filterable placeholder="设备"\r\n                           size="small">\r\n                  <el-option\r\n                    v-for="item in deviceOptions"\r\n                    :key="item.value"\r\n                    :label="item.label"\r\n                    :value="item.value">\r\n                  </el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n\r\n              <el-form-item>\r\n                <el-select v-model="queryParams.source" clearable filterable placeholder="source"\r\n                multiple  collapse-tags\r\n                           size="small">\r\n                  <el-option\r\n                    v-for="item in sourceOptions"\r\n                    :key="item.value"\r\n                    :label="item.label"\r\n                    :value="item.value">\r\n                  </el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-select v-model="queryParams.isksjk" clearable filterable placeholder="快速借款"\r\n                           size="small">\r\n                  <el-option\r\n                    v-for="item in ksjkOptions"\r\n                    :key="item.value"\r\n                    :label="item.label"\r\n                    :value="item.value">\r\n                  </el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-button type="primary" @click="onSubmit" size="small" style="margin-top:0">查询\r\n                </el-button>\r\n              </el-form-item>\r\n            </el-form>\r\n            <el-button class="right mb-10" type="primary" size="small" icon="el-icon-document"\r\n                       @click="exportExcel">导出excel\r\n            </el-button>\r\n          </div>\r\n          <template slot="columns">\r\n            <el-table-column type="index" label="序号" width="60"></el-table-column>\r\n            <el-table-column sortable prop="date_str" label="日期" width="120"></el-table-column>\r\n            <el-table-column sortable prop="hour" label="小时" width="120"></el-table-column>\r\n            <el-table-column sortable prop="plat" label="设备" width="100"></el-table-column>\r\n            <el-table-column sortable prop="ksjk_existing" label="快速借款用户" width="120"></el-table-column>\r\n            <el-table-column sortable prop="source" label="source" width="150"></el-table-column>\r\n            <el-table-column sortable prop="activation_count" label="激活"></el-table-column>\r\n            <el-table-column sortable prop="register_count" label="注册"></el-table-column>\r\n            <el-table-column sortable prop="jinjian" label="当日进件"></el-table-column>\r\n            <el-table-column sortable prop="approval" label="当日审核"></el-table-column>\r\n            <el-table-column sortable prop="emitCn" label="当日放款"></el-table-column>\r\n            <el-table-column sortable prop="emitMoney" label="放款金额"></el-table-column>\r\n            <el-table-column sortable prop="act_reg_rate" label="注册/激活" width="90"></el-table-column>\r\n            <el-table-column sortable prop="jj_reg_rate" label="进件/注册" width="90"></el-table-column>\r\n            <el-table-column sortable prop="review_jinj_rate" label="审核/进件" width="90"></el-table-column>\r\n\r\n          </template>\r\n        </data-table>\r\n      </template>\r\n    </tab-page>\r\n  </div>\r\n</template>\r\n<style scoped>\r\n  .el-form-item__content .el-button {\r\n    margin-top: 20px;\r\n  }\r\n\r\n  .el-table--border th {\r\n    text-align: center;\r\n  }\r\n\r\n  .el-table th .cell {\r\n    text-align: center;\r\n  }\r\n\r\n  .el-form--inline .el-form-item {\r\n    margin-right: 2px;\r\n  }\r\n\r\n  .el-form-item {\r\n    margin-bottom: 2px;\r\n  }\r\n\r\n  .el-dialog__footer {\r\n    padding: 10px 0px;\r\n    text-align: center;\r\n  }\r\n\r\n  .check-all-select {\r\n    padding: 10px;\r\n  }\r\n\r\n  .check-all-select span.text-all {\r\n    font-size: 14px;\r\n    font-weight: bold;\r\n  }\r\n\r\n  .check-all-select label {\r\n    float: right;\r\n  }\r\n\r\n  .mb-10 {\r\n    margin-bottom: 10px;\r\n  }\r\n</style>\r\n<script>\r\n  import common from \'../../../utils/common\'\r\n  import formatDate from \'../../../utils/formatDate\'\r\n  import DataTable from "../../../components/DataTable"\r\n  import TabPage from "../../../components/TabPage"\r\n  import {Notification} from \'element-ui\'\r\n  export default{\r\n    components: {\r\n      DataTable,\r\n      TabPage,\r\n    },\r\n    data(){\r\n      let today = formatDate(new Date(), \'yyyy-MM-dd\') + \' 00:00:00\';\r\n      let now = new Date();\r\n      return {\r\n        sourceCheckAll: false,\r\n        deviceCheckAll: false,\r\n        sourceOptions: [],\r\n        deviceOptions: [\r\n          {\r\n            value: \'iOS\',\r\n            label: \'iOS\'\r\n          },\r\n          {\r\n            value: \'Android\',\r\n            label: \'Android\'\r\n          }\r\n        ],\r\n        ksjkOptions: [\r\n          {\r\n            value: \'是\',\r\n            label: \'是\'\r\n          },\r\n          {\r\n            value: \'否\',\r\n            label: \'否\'\r\n          }\r\n        ],\r\n        initBeginTime: \'\',\r\n        initEndTime: \'\',\r\n\r\n        queryParams: {\r\n          source: \'\',\r\n          device: \'\',\r\n          isksjk: \'\',\r\n          beginTime: [],//开始时间\r\n          endTime: [],//结束时间\r\n          dateRange: [today, now],\r\n        },\r\n        dataTable: {\r\n          pageSize: 50,\r\n          pageSizes: [10, 20, 50, 100, 1000],\r\n          url: "/web/v1/market/queryMarketDetailByHour",\r\n          emptyText: \'没有记录\',\r\n          showSummary: true,\r\n          summaryMethod: this.getSummaries,\r\n        },\r\n      }\r\n    },\r\n    mounted(){\r\n      this.dataTable.queryParams = this.queryParams;\r\n      this.initBeginTime = this.dealDate(this.queryParams.dateRange[0], \'yyyy-MM-dd\');\r\n      this.initEndTime = this.dealDate(this.queryParams.dateRange[1], \'yyyy-MM-dd\');\r\n      this.dataTable.queryParams.beginTime = this.initBeginTime + \' 00:00:00\';\r\n      this.dataTable.queryParams.endTime = this.initEndTime + \' 23:59:59\';\r\n\r\n      var defaultPage = {label: "市场厂商类", name: "h5Statistics", slotName: \'h5Statistics\', closable: false};\r\n      this.$refs.tabPage.$emit("open-tab", defaultPage);\r\n\r\n      this.getSources();\r\n    },\r\n    methods: {\r\n      loadLists(){\r\n        this.$refs.dataTable.$emit(\'load-data\');\r\n      },\r\n\r\n      onSubmit: function () {\r\n        this.dataTable.queryParams = this.queryParams;\r\n        this.initBeginTime = this.dealTime(this.queryParams.dateRange[0]);\r\n        this.initEndTime = this.dealTime(this.queryParams.dateRange[1]);\r\n        this.dataTable.queryParams.beginTime = this.initBeginTime ;\r\n        this.dataTable.queryParams.endTime = this.initEndTime;\r\n\r\n        this.dataTable.url = \'/web/v1/market/queryMarketDetailByHour\';\r\n        this.$refs.dataTable.$emit(\'load-data\');\r\n      },\r\n      warnTime(startTime, endTime){\r\n        if (!startTime) {\r\n          this.$notify({\r\n            message: \'查询开始时间不能为空！\',\r\n            type: \'warning\'\r\n          });\r\n          return true;\r\n        }\r\n        if (!endTime) {\r\n          this.$notify({\r\n            message: \'查询结束时间不能为空！\',\r\n            type: \'warning\'\r\n          });\r\n          return true;\r\n        }\r\n        let timeStart = new Date(startTime).getTime();\r\n        let timeEnd = new Date(endTime).getTime();\r\n        if (timeStart > timeEnd) {\r\n          this.$notify({\r\n            message: \'查询开始时间不能大于结束时间\',\r\n            type: \'warning\'\r\n          });\r\n          return true;\r\n        }\r\n        return false;\r\n      },\r\n      dealTime(time){\r\n        return formatDate(new Date(time), \'yyyy-MM-dd hh:mm:ss\');\r\n      },\r\n      formatterDate(row, column){\r\n        return formatDate(row.date, \'yyyy-MM-dd\');\r\n      },\r\n      dealDate(date){\r\n        return formatDate(new Date(date), \'yyyy-MM-dd\');\r\n      },\r\n       getSummaries (param) {\r\n        const {columns, data} = param;\r\n        const sums = [];\r\n        columns.forEach((column, index) => {\r\n          if (index === 0) {\r\n            sums[index] = \'总计\';\r\n            return;\r\n          }\r\n          var values;\r\n          if(index === 12||index === 13||index === 14){\r\n             values = data.map(item =>{\r\n               if(item[column.property]!==null){\r\n                 return Number(item[column.property].replace(\'%\',\'\'));\r\n               }\r\n             });\r\n          }else{\r\n            values = data.map(item => Number(item[column.property]));\r\n          }\r\n\r\n          if (!values.every(value => isNaN(value))) {\r\n            sums[index] = values.reduce((prev, curr) => {\r\n              const value = Number(curr);\r\n              if (!isNaN(value)) {\r\n                return prev + curr;\r\n              } else {\r\n                return prev;\r\n              }\r\n            }, 0);\r\n            if(index === 12||index === 13||index === 14){\r\n              sums[index]=(sums[index]/data.length).toFixed(2)+ \' %\';\r\n            }\r\n            //sums[index] += \' 元\';\r\n          } else {\r\n            sums[index] = \'N/A\';\r\n          }\r\n        });\r\n\r\n        return sums;\r\n      },\r\n      exportExcel() {\r\n        let self=this;\r\n        var exportParams = {};\r\n        Object.assign(exportParams, this.dataTable.queryParams);\r\n        exportParams.pageSize = this.$refs.dataTable.total;\r\n        exportParams.page = 1;\r\n        this.$refs.dataTable.$emit(\'export-data\',exportParams);\r\n        require.ensure([], () => {\r\n          const {export_json_to_excel} = require(\'vendor/Export2Excel\');\r\n          const tHeader = [\'日期\', \'小时\', \'设备\', \'快速借款用户\', \'source\', \'手机号\', \'注册\', \'激活\', \'进件\', \'审核\', \'放款\', \'放款金额\', \'注册/激活\', \'进件/注册\', \'审核/进件\'];\r\n          const filterVal = [\'date\', \'hour\', \'plat\', \'ksjk_existing\', \'source\', \'phones_count\', \'register_count\', \'activation_count\', \'jinjian\', \'approval\', \'emitCn\', \'emitMoney\', \'act_reg_rate\', \'jj_reg_rate\', \'review_jinj_rate\'];\r\n          setTimeout(() => {\r\n            const list = this.$refs.dataTable.dataListA;\r\n            const data = this.formatJson(filterVal, list);\r\n            export_json_to_excel(tHeader, data, \'市场厂商类(小时)\');\r\n          }, 300);\r\n        })\r\n      },\r\n      formatJson(filterVal, jsonData) {\r\n        return jsonData.map(v => filterVal.map(j => {\r\n          let returnValue;\r\n          if (j == \'operator\') {\r\n            returnValue = v[j].name;\r\n          } else {\r\n            returnValue = v[j];\r\n          }\r\n          return returnValue;\r\n        }))\r\n      },\r\n\r\n      getSources(){\r\n        common.ajax({\r\n          url: \'/web/v1/options/market/sources\',\r\n          type: \'POST\',\r\n          contentType: \'application/json\',\r\n          success: (response) => {\r\n            if (response.data && response.data.list) {\r\n              this.sourceOptions = response.data.list;\r\n            }\r\n          },\r\n          error: (err) => {\r\n            let error = err.message || err;\r\n            Notification.error({\r\n              title: \'错误\',\r\n              message: error\r\n            });\r\n          }\r\n        });\r\n      },\r\n\r\n      checkAllSelection(selectType){\r\n        let len = this.$refs[selectType].optionsCount;\r\n//        let seletedLen =  this.$refs[selectType].selected.length;\r\n\r\n        for (var i = 0; i < len; i++) {\r\n          (function (index, _this) {\r\n            setTimeout(() => {\r\n              _this.$refs[selectType].handleOptionSelect(_this.$refs[selectType].options[index]);\r\n            }, 0);\r\n          })(i, this);\r\n        }\r\n\r\n      },\r\n      handleCheckAllDeviceChange(event) {\r\n        this.checkAllSelection("deviceSelect");\r\n        this.deviceCheckAll = !this.deviceCheckAll;\r\n      },\r\n      handleCheckAllSourceChange(event) {\r\n        this.checkAllSelection("sourceSelect");\r\n        this.sourceCheckAll = !this.sourceCheckAll;\r\n      },\r\n      setCheckAllStyle(selectedCount, selectType){\r\n        let type = selectType + \'CheckAll\';\r\n        let type_1 = selectType + \'Select\';\r\n        if (this[type]) {\r\n          if (selectedCount.length < this.$refs[type_1].optionsCount) {\r\n            this[type] = !this[type];\r\n          }\r\n        } else {\r\n          if (selectedCount.length === this.$refs[type_1].optionsCount) {\r\n            this[type] = !this[type];\r\n          }\r\n        }\r\n      },\r\n      deviceChange(values){\r\n        this.setCheckAllStyle(values, "device");\r\n      },\r\n      sourceChange(values){\r\n        this.setCheckAllStyle(values, "source");\r\n      },\r\n    },\r\n  }\r\n<\/script>\r\n<style>\r\n  .span-style {\r\n    display: inline-block;\r\n    margin-top: 8px;\r\n    font-size: 14px;\r\n  }\r\n</style>\r\n']}])}}]);
//# sourceMappingURL=48.7bce3c173ba1e0f7e249.js.map