(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{1047:function(e,t,r){"use strict";r.r(t);var n=r(11),a=r.n(n),l=r(1),i=r(9),s=r(8),o={components:{DataTable:i.a,TabPage:s.a},data:function(){return{deviceCheckAll:!1,deviceOptions:[{value:"iOS",label:"iOS"},{value:"Android",label:"Android"}],ksjkOptions:[{value:"是",label:"是"},{value:"否",label:"否"}],initBeginTime:"",initEndTime:"",queryParams:{device:"",isksjk:"",beginTime:"",endTime:""},dataTable:{pageSize:50,pageSizes:[10,20,50,100,1e3,5e3,1e4,2e4],url:"/web/v1/market/queryMarket",emptyText:"没有记录",showSummary:!0,summaryMethod:this.getSummaries}}},mounted:function(){this.dataTable.queryParams=this.queryParams;var e=new Date,t=new Date(e.setDate(e.getDate()-7));this.initBeginTime=this.dealDate(t),this.initEndTime=this.dealDate(new Date),this.dataTable.queryParams.beginTime=this.initBeginTime+" 00:00:00",this.dataTable.queryParams.endTime=this.initEndTime+" 23:59:59",this.$refs.tabPage.$emit("open-tab",{label:"市场类总计",name:"h5Statistics",slotName:"h5Statistics",closable:!1})},methods:{loadLists:function(){this.$refs.dataTable.$emit("load-data")},onSubmit:function(){this.dataTable.queryParams=this.queryParams,this.warnTime(this.dataTable.queryParams.beginTime,this.dataTable.queryParams.endTime)||(this.dataTable.queryParams.beginTime=this.dealDate(this.dataTable.queryParams.beginTime)+" 00:00:00",this.dataTable.queryParams.endTime=this.dealDate(this.dataTable.queryParams.endTime)+" 23:59:59",this.dataTable.url="/web/v1/market/queryMarket",this.$refs.dataTable.$emit("load-data"))},warnTime:function(e,t){return e?t?!!(new Date(e).getTime()>new Date(t).getTime())&&(this.$notify({message:"查询开始时间不能大于结束时间",type:"warning"}),!0):(this.$notify({message:"查询结束时间不能为空！",type:"warning"}),!0):(this.$notify({message:"查询开始时间不能为空！",type:"warning"}),!0)},dealTime:function(e){return Object(l.a)(new Date(e),"yyyy-MM-dd hh:mm:ss")},formatterDate:function(e){return Object(l.a)(e.date,"yyyy-MM-dd")},dealDate:function(e){return Object(l.a)(new Date(e),"yyyy-MM-dd")},getSummaries:function(e){var t=e.columns,r=e.data,n=[];return t.forEach(function(e,t){var a;0!==t?(a=10===t||11===t||12===t?r.map(function(t){if(null!==t[e.property])return+t[e.property].replace("%","")}):r.map(function(t){return+t[e.property]})).every(function(e){return isNaN(e)})?n[t]="N/A":(n[t]=a.reduce(function(e,t){return isNaN(+t)?e:e+t},0),(10==t||11==t||12==t)&&(n[t]=(n[t]/r.length).toFixed(2)+" %")):n[t]="总计"}),n},exportExcel:function(){var e=this,t={};a()(t,this.dataTable.queryParams),t.pageSize=this.$refs.dataTable.total,t.page=1,this.$refs.dataTable.$emit("export-data",t),Promise.all([r.e(0),r.e(2)]).then(function(){var t=r(1028).export_json_to_excel,n=["日期","T7进件","T7审核","T7放款","T7放款金额","设备","快速借款用户","手机号","注册","激活","进件","审核","放款","放款金额","注册/激活","进件/注册","审核/进件"],a=["date","jinjian_t7","approval_t7","emitCn_t7","emitMoney_t7","plat","ksjk_existing","phones_count","register_count","activation_count","jinjian","approval","emitCn","emitMoney","act_reg_rate","jj_reg_rate","review_jinj_rate"];setTimeout(function(){var r=e.$refs.dataTable.dataListA,l=e.formatJson(a,r);t(n,l,"市场类总计")},300)}.bind(null,r)).catch(r.oe)},formatJson:function(e,t){return t.map(function(t){return e.map(function(e){return"operator"==e?t[e].name:t[e]})})},checkAllSelection:function(e){for(var t=this.$refs[e].optionsCount,r=0;r<t;r++)!function(t,r){setTimeout(function(){r.$refs[e].handleOptionSelect(r.$refs[e].options[t])},0)}(r,this)},handleCheckAllDeviceChange:function(){this.checkAllSelection("deviceSelect"),this.deviceCheckAll=!this.deviceCheckAll},setCheckAllStyle:function(e,t){var r=t+"CheckAll",n=t+"Select";this[r]?e.length<this.$refs[n].optionsCount&&(this[r]=!this[r]):e.length===this.$refs[n].optionsCount&&(this[r]=!this[r])},deviceChange:function(e){this.setCheckAllStyle(e,"device")}}},m=(r(606),r(608),r(3)),c=Object(m.a)(o,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("tab-page",{ref:"tabPage"},[r("template",{slot:"h5Statistics"},[r("data-table",{ref:"dataTable",attrs:{"data-table":e.dataTable}},[r("div",{staticStyle:{"margin-bottom":"15px"},attrs:{slot:"conditions"},slot:"conditions"},[r("el-form",{attrs:{inline:!0,model:e.queryParams}},[r("el-form-item",[r("el-date-picker",{staticStyle:{width:"170px"},attrs:{type:"date",placeholder:"选择日期时间",size:"small"},model:{value:e.queryParams.beginTime,callback:function(t){e.$set(e.queryParams,"beginTime",t)},expression:"queryParams.beginTime"}})],1),e._v(" "),r("span",{staticClass:"span-style"},[e._v("至")]),e._v(" "),r("el-form-item",[r("el-date-picker",{staticStyle:{width:"170px"},attrs:{type:"date",placeholder:"选择日期时间",size:"small"},model:{value:e.queryParams.endTime,callback:function(t){e.$set(e.queryParams,"endTime",t)},expression:"queryParams.endTime"}})],1),e._v(" "),r("el-form-item",[r("el-select",{attrs:{clearable:"",filterable:"",placeholder:"设备",size:"small"},model:{value:e.queryParams.device,callback:function(t){e.$set(e.queryParams,"device",t)},expression:"queryParams.device"}},e._l(e.deviceOptions,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),r("el-form-item",[r("el-select",{attrs:{clearable:"",filterable:"",placeholder:"快速借款",size:"small"},model:{value:e.queryParams.isksjk,callback:function(t){e.$set(e.queryParams,"isksjk",t)},expression:"queryParams.isksjk"}},e._l(e.ksjkOptions,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),r("el-form-item",[r("el-button",{staticStyle:{"margin-top":"0"},attrs:{type:"primary",size:"small"},on:{click:e.onSubmit}},[e._v("查询\n              ")])],1)],1),e._v(" "),r("el-button",{staticClass:"right mb-10",attrs:{type:"primary",size:"small",icon:"el-icon-document"},on:{click:e.exportExcel}},[e._v("导出excel\n          ")])],1),e._v(" "),r("template",{slot:"columns"},[r("el-table-column",{attrs:{type:"index",label:"序号",width:"60"}}),e._v(" "),r("el-table-column",{attrs:{sortable:"",prop:"date",label:"日期",width:"120"}}),e._v(" "),r("el-table-column",{attrs:{sortable:"",prop:"plat",label:"设备",width:"100"}}),e._v(" "),r("el-table-column",{attrs:{sortable:"",prop:"ksjk_existing",label:"快速借款用户",width:"120"}}),e._v(" "),r("el-table-column",{attrs:{sortable:"",prop:"activation_count",label:"激活"}}),e._v(" "),r("el-table-column",{attrs:{sortable:"",prop:"register_count",label:"注册"}}),e._v(" "),r("el-table-column",{attrs:{sortable:"",prop:"jinjian",label:"当日进件"}}),e._v(" "),r("el-table-column",{attrs:{sortable:"",prop:"approval",label:"当日审核"}}),e._v(" "),r("el-table-column",{attrs:{sortable:"",prop:"emitCn",label:"当日放款"}}),e._v(" "),r("el-table-column",{attrs:{sortable:"",prop:"emitMoney",label:"放款金额"}}),e._v(" "),r("el-table-column",{attrs:{sortable:"",prop:"act_reg_rate",label:"注册/激活",width:"90"}}),e._v(" "),r("el-table-column",{attrs:{sortable:"",prop:"jj_reg_rate",label:"进件/注册",width:"90"}}),e._v(" "),r("el-table-column",{attrs:{sortable:"",prop:"review_jinj_rate",label:"审核/进件",width:"90"}}),e._v(" "),r("el-table-column",{attrs:{sortable:"",prop:"jinjian_t7",label:"T7进件"}}),e._v(" "),r("el-table-column",{attrs:{sortable:"",prop:"approval_t7",label:"T7审核"}}),e._v(" "),r("el-table-column",{attrs:{sortable:"",prop:"emitCn_t7",label:"T7放款"}}),e._v(" "),r("el-table-column",{attrs:{sortable:"",prop:"emitMoney_t7",label:"T7放款金额"}})],1)],2)],1)],2)],1)},[],!1,null,"15ad3fe8",null);t.default=c.exports},203:function(e,t,r){var n=r(607);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,r(5).default)("0ad3b2a6",n,!0,{})},204:function(e,t,r){var n=r(609);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,r(5).default)("4e3886ec",n,!0,{})},606:function(e,t,r){"use strict";var n=r(203);r.n(n).a},607:function(e,t,r){(e.exports=r(4)(!0)).push([e.i,"\n.el-form-item__content .el-button[data-v-15ad3fe8] {\n  margin-top: 20px;\n}\n.el-table--border th[data-v-15ad3fe8] {\n  text-align: center;\n}\n.el-table th .cell[data-v-15ad3fe8] {\n  text-align: center;\n}\n.el-form--inline .el-form-item[data-v-15ad3fe8] {\n  margin-right: 2px;\n}\n.el-form-item[data-v-15ad3fe8] {\n  margin-bottom: 2px;\n}\n.el-dialog__footer[data-v-15ad3fe8] {\n  padding: 10px 0px;\n  text-align: center;\n}\n.check-all-select[data-v-15ad3fe8] {\n  padding: 10px;\n}\n.check-all-select span.text-all[data-v-15ad3fe8] {\n  font-size: 14px;\n  font-weight: bold;\n}\n.check-all-select label[data-v-15ad3fe8] {\n  float: right;\n}\n.mb-10[data-v-15ad3fe8] {\n  margin-bottom: 10px;\n}\n","",{version:3,sources:["src/views/contents/market/marketCategory.vue"],names:[],mappings:";AAkFA;EACA,gBAAA;AACA;AAEA;EACA,kBAAA;AACA;AAEA;EACA,kBAAA;AACA;AAEA;EACA,iBAAA;AACA;AAEA;EACA,kBAAA;AACA;AAEA;EACA,iBAAA;EACA,kBAAA;AACA;AAEA;EACA,aAAA;AACA;AAEA;EACA,eAAA;EACA,iBAAA;AACA;AAEA;EACA,YAAA;AACA;AAEA;EACA,mBAAA;AACA",file:"marketCategory.vue?vue&type=style&index=0&id=15ad3fe8&scoped=true&lang=css&",sourcesContent:['<template>\r\n  <div>\r\n    <tab-page ref="tabPage">\r\n      <template slot="h5Statistics">\r\n        <data-table :data-table="dataTable" ref="dataTable">\r\n          <div slot="conditions" style="margin-bottom:15px">\r\n            <el-form :inline="true" :model="queryParams">\r\n              <el-form-item>\r\n                <el-date-picker\r\n                  v-model="queryParams.beginTime"\r\n                  type="date"\r\n                  placeholder="选择日期时间" size="small" style="width:170px">\r\n                </el-date-picker>\r\n              </el-form-item>\r\n              <span class="span-style">至</span>\r\n              <el-form-item>\r\n                <el-date-picker\r\n                  v-model="queryParams.endTime"\r\n                  type="date"\r\n                  placeholder="选择日期时间" size="small" style="width:170px">\r\n                </el-date-picker>\r\n              </el-form-item>\r\n\r\n              <el-form-item>\r\n                <el-select v-model="queryParams.device" clearable filterable placeholder="设备"\r\n                           size="small">\r\n                  <el-option\r\n                    v-for="item in deviceOptions"\r\n                    :key="item.value"\r\n                    :label="item.label"\r\n                    :value="item.value">\r\n                  </el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-select v-model="queryParams.isksjk" clearable filterable placeholder="快速借款"\r\n                           size="small">\r\n                  <el-option\r\n                    v-for="item in ksjkOptions"\r\n                    :key="item.value"\r\n                    :label="item.label"\r\n                    :value="item.value">\r\n                  </el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-button type="primary" @click="onSubmit" size="small" style="margin-top:0">查询\r\n                </el-button>\r\n              </el-form-item>\r\n            </el-form>\r\n            <el-button class="right mb-10" type="primary" size="small" icon="el-icon-document"\r\n                       @click="exportExcel">导出excel\r\n            </el-button>\r\n          </div>\r\n          <template slot="columns">\r\n            <el-table-column type="index" label="序号" width="60"></el-table-column>\r\n            <el-table-column sortable prop="date" label="日期" width="120"></el-table-column>\r\n\r\n            <el-table-column sortable prop="plat" label="设备" width="100"></el-table-column>\r\n            <el-table-column sortable prop="ksjk_existing" label="快速借款用户" width="120"></el-table-column>\r\n            <el-table-column sortable prop="activation_count" label="激活"></el-table-column>\r\n            <el-table-column sortable prop="register_count" label="注册"></el-table-column>\r\n            <el-table-column sortable prop="jinjian" label="当日进件"></el-table-column>\r\n            <el-table-column sortable prop="approval" label="当日审核"></el-table-column>\r\n            <el-table-column sortable prop="emitCn" label="当日放款"></el-table-column>\r\n            <el-table-column sortable prop="emitMoney" label="放款金额"></el-table-column>\r\n            <el-table-column sortable prop="act_reg_rate" label="注册/激活" width="90"></el-table-column>\r\n            <el-table-column sortable prop="jj_reg_rate" label="进件/注册" width="90"></el-table-column>\r\n            <el-table-column sortable prop="review_jinj_rate" label="审核/进件" width="90"></el-table-column>\r\n\r\n            <el-table-column sortable prop="jinjian_t7" label="T7进件" ></el-table-column>\r\n            <el-table-column sortable prop="approval_t7" label="T7审核" ></el-table-column>\r\n            <el-table-column sortable prop="emitCn_t7" label="T7放款" ></el-table-column>\r\n            <el-table-column sortable prop="emitMoney_t7" label="T7放款金额" ></el-table-column>\r\n\r\n          </template>\r\n        </data-table>\r\n      </template>\r\n    </tab-page>\r\n  </div>\r\n</template>\r\n<style scoped>\r\n  .el-form-item__content .el-button {\r\n    margin-top: 20px;\r\n  }\r\n\r\n  .el-table--border th {\r\n    text-align: center;\r\n  }\r\n\r\n  .el-table th .cell {\r\n    text-align: center;\r\n  }\r\n\r\n  .el-form--inline .el-form-item {\r\n    margin-right: 2px;\r\n  }\r\n\r\n  .el-form-item {\r\n    margin-bottom: 2px;\r\n  }\r\n\r\n  .el-dialog__footer {\r\n    padding: 10px 0px;\r\n    text-align: center;\r\n  }\r\n\r\n  .check-all-select {\r\n    padding: 10px;\r\n  }\r\n\r\n  .check-all-select span.text-all {\r\n    font-size: 14px;\r\n    font-weight: bold;\r\n  }\r\n\r\n  .check-all-select label {\r\n    float: right;\r\n  }\r\n\r\n  .mb-10 {\r\n    margin-bottom: 10px;\r\n  }\r\n</style>\r\n<script>\r\n//  import common from \'../../../utils/common\'\r\n  import formatDate from \'../../../utils/formatDate\'\r\n  import DataTable from "../../../components/DataTable"\r\n  import TabPage from "../../../components/TabPage"\r\n  export default{\r\n    components: {\r\n      DataTable,\r\n      TabPage,\r\n    },\r\n    data(){\r\n      return {\r\n        deviceCheckAll: false,\r\n        deviceOptions: [\r\n          {\r\n            value: \'iOS\',\r\n            label: \'iOS\'\r\n          },\r\n          {\r\n            value: \'Android\',\r\n            label: \'Android\'\r\n          }\r\n        ],\r\n        ksjkOptions: [\r\n          {\r\n            value: \'是\',\r\n            label: \'是\'\r\n          },\r\n          {\r\n            value: \'否\',\r\n            label: \'否\'\r\n          }\r\n        ],\r\n        initBeginTime: \'\',\r\n        initEndTime: \'\',\r\n\r\n        queryParams: {\r\n          device: \'\',\r\n          isksjk: \'\',\r\n          beginTime: \'\',//开始时间\r\n          endTime: \'\',//结束时间\r\n        },\r\n        dataTable: {\r\n          pageSize: 50,\r\n          pageSizes: [10, 20, 50, 100, 1000,5000,10000,20000],\r\n          url: "/web/v1/market/queryMarket",    //代付管理\r\n          emptyText: \'没有记录\',\r\n          showSummary: true,\r\n          summaryMethod: this.getSummaries,\r\n        },\r\n      }\r\n    },\r\n    mounted(){\r\n      this.dataTable.queryParams = this.queryParams;\r\n      let date = new Date();\r\n      let beginDate = new Date(date.setDate(date.getDate() - 7));\r\n      this.initBeginTime = this.dealDate(beginDate);\r\n      this.initEndTime = this.dealDate(new Date());\r\n      this.dataTable.queryParams.beginTime = this.initBeginTime + \' 00:00:00\';\r\n      this.dataTable.queryParams.endTime = this.initEndTime + \' 23:59:59\';\r\n\r\n      var defaultPage = {label: "市场类总计", name: "h5Statistics", slotName: \'h5Statistics\', closable: false};\r\n      this.$refs.tabPage.$emit("open-tab", defaultPage);\r\n    },\r\n    methods: {\r\n      loadLists(){\r\n        this.$refs.dataTable.$emit(\'load-data\');\r\n      },\r\n      onSubmit: function () {\r\n        this.dataTable.queryParams = this.queryParams;\r\n        var tag = this.warnTime(this.dataTable.queryParams.beginTime, this.dataTable.queryParams.endTime);\r\n        if (tag) {\r\n          return;\r\n        }\r\n        //console.log(Object.prototype.toString.call(this.dataTable.queryParams.beginTime));\r\n        this.dataTable.queryParams.beginTime = this.dealDate(this.dataTable.queryParams.beginTime) + \' 00:00:00\';\r\n        this.dataTable.queryParams.endTime = this.dealDate(this.dataTable.queryParams.endTime) + \' 23:59:59\';\r\n\r\n        this.dataTable.url = \'/web/v1/market/queryMarket\';\r\n        this.$refs.dataTable.$emit(\'load-data\');\r\n      },\r\n      warnTime(startTime, endTime){\r\n        if (!startTime) {\r\n          this.$notify({\r\n            message: \'查询开始时间不能为空！\',\r\n            type: \'warning\'\r\n          });\r\n          return true;\r\n        }\r\n        if (!endTime) {\r\n          this.$notify({\r\n            message: \'查询结束时间不能为空！\',\r\n            type: \'warning\'\r\n          });\r\n          return true;\r\n        }\r\n        let timeStart = new Date(startTime).getTime();\r\n        let timeEnd = new Date(endTime).getTime();\r\n        if (timeStart > timeEnd) {\r\n          this.$notify({\r\n//                        title: \'警告\',\r\n            message: \'查询开始时间不能大于结束时间\',\r\n            type: \'warning\'\r\n          });\r\n          return true;\r\n        }\r\n        return false;\r\n      },\r\n      dealTime(time){\r\n        return formatDate(new Date(time), \'yyyy-MM-dd hh:mm:ss\');\r\n      },\r\n      formatterDate(row, column){\r\n        return formatDate(row.date, \'yyyy-MM-dd\');\r\n      },\r\n      dealDate(date){\r\n        return formatDate(new Date(date), \'yyyy-MM-dd\');\r\n      },\r\n      getSummaries (param) {\r\n        const {columns, data} = param;\r\n        const sums = [];\r\n        columns.forEach((column, index) => {\r\n          if (index === 0) {\r\n            sums[index] = \'总计\';\r\n            return;\r\n          }\r\n          var values;\r\n          if(index === 10||index === 11||index === 12){\r\n             values = data.map(item =>{\r\n               if(item[column.property]!==null){\r\n                 return Number(item[column.property].replace(\'%\',\'\'));\r\n               }\r\n             });\r\n          }else{\r\n            values = data.map(item => Number(item[column.property]));\r\n          }\r\n\r\n          if (!values.every(value => isNaN(value))) {\r\n            sums[index] = values.reduce((prev, curr) => {\r\n              const value = Number(curr);\r\n              if (!isNaN(value)) {\r\n                return prev + curr;\r\n              } else {\r\n                return prev;\r\n              }\r\n            }, 0);\r\n            if(index==10||index==11||index==12){\r\n              sums[index]=(sums[index]/data.length).toFixed(2)+ \' %\';\r\n            }\r\n            //sums[index] += \' 元\';\r\n          } else {\r\n            sums[index] = \'N/A\';\r\n          }\r\n        });\r\n\r\n        return sums;\r\n      },\r\n\r\n      exportExcel() {\r\n        let self=this;\r\n        var exportParams = {};\r\n        Object.assign(exportParams, this.dataTable.queryParams);\r\n        exportParams.pageSize = this.$refs.dataTable.total;\r\n        exportParams.page = 1;\r\n        this.$refs.dataTable.$emit(\'export-data\',exportParams);\r\n        require.ensure([], () => {\r\n          const {export_json_to_excel} = require(\'vendor/Export2Excel\');\r\n          const tHeader = [\'日期\',\r\n            \'T7进件\',\r\n            \'T7审核\',\r\n            \'T7放款\',\r\n            \'T7放款金额\',\r\n            \'设备\', \'快速借款用户\', \'手机号\', \'注册\', \'激活\', \'进件\', \'审核\', \'放款\', \'放款金额\', \'注册/激活\', \'进件/注册\', \'审核/进件\'];\r\n          const filterVal = [\'date\',\r\n            \'jinjian_t7\',\r\n            \'approval_t7\',\r\n            \'emitCn_t7\',\r\n            \'emitMoney_t7\',\r\n            \'plat\', \'ksjk_existing\', \'phones_count\', \'register_count\', \'activation_count\', \'jinjian\', \'approval\', \'emitCn\', \'emitMoney\', \'act_reg_rate\', \'jj_reg_rate\', \'review_jinj_rate\'];\r\n          setTimeout(() => {\r\n            const list = this.$refs.dataTable.dataListA;\r\n            const data = this.formatJson(filterVal, list);\r\n            export_json_to_excel(tHeader, data, \'市场类总计\');\r\n          }, 300);\r\n\r\n        })\r\n      },\r\n      formatJson(filterVal, jsonData) {\r\n        return jsonData.map(v => filterVal.map(j => {\r\n          let returnValue;\r\n          if (j == \'operator\') {\r\n            returnValue = v[j].name;\r\n          } else {\r\n            returnValue = v[j];\r\n          }\r\n          return returnValue;\r\n        }))\r\n      },\r\n\r\n      checkAllSelection(selectType){\r\n        let len = this.$refs[selectType].optionsCount;\r\n        for (var i = 0; i < len; i++) {\r\n          (function (index, _this) {\r\n            setTimeout(() => {\r\n              _this.$refs[selectType].handleOptionSelect(_this.$refs[selectType].options[index]);\r\n            }, 0);\r\n\r\n          })(i, this);\r\n        }\r\n        ;\r\n      },\r\n      handleCheckAllDeviceChange(event) {\r\n        this.checkAllSelection("deviceSelect");\r\n        this.deviceCheckAll = !this.deviceCheckAll;\r\n      },\r\n      setCheckAllStyle(selectedCount, selectType){\r\n        let type = selectType + \'CheckAll\';\r\n        let type_1 = selectType + \'Select\';\r\n        if (this[type]) {\r\n          if (selectedCount.length < this.$refs[type_1].optionsCount) {\r\n            this[type] = !this[type];\r\n          }\r\n        } else {\r\n          if (selectedCount.length === this.$refs[type_1].optionsCount) {\r\n            this[type] = !this[type];\r\n          }\r\n        }\r\n      },\r\n      deviceChange(values){\r\n        this.setCheckAllStyle(values, "device");\r\n      },\r\n    },\r\n  }\r\n<\/script>\r\n<style>\r\n  .span-style {\r\n    display: inline-block;\r\n    margin-top: 8px;\r\n    font-size: 14px;\r\n  }\r\n</style>\r\n']}])},608:function(e,t,r){"use strict";var n=r(204);r.n(n).a},609:function(e,t,r){(e.exports=r(4)(!0)).push([e.i,"\n.span-style {\n  display: inline-block;\n  margin-top: 8px;\n  font-size: 14px;\n}\n","",{version:3,sources:["src/views/contents/market/marketCategory.vue"],names:[],mappings:";AAsWA;EACA,qBAAA;EACA,eAAA;EACA,eAAA;AACA",file:"marketCategory.vue?vue&type=style&index=1&lang=css&",sourcesContent:['<template>\r\n  <div>\r\n    <tab-page ref="tabPage">\r\n      <template slot="h5Statistics">\r\n        <data-table :data-table="dataTable" ref="dataTable">\r\n          <div slot="conditions" style="margin-bottom:15px">\r\n            <el-form :inline="true" :model="queryParams">\r\n              <el-form-item>\r\n                <el-date-picker\r\n                  v-model="queryParams.beginTime"\r\n                  type="date"\r\n                  placeholder="选择日期时间" size="small" style="width:170px">\r\n                </el-date-picker>\r\n              </el-form-item>\r\n              <span class="span-style">至</span>\r\n              <el-form-item>\r\n                <el-date-picker\r\n                  v-model="queryParams.endTime"\r\n                  type="date"\r\n                  placeholder="选择日期时间" size="small" style="width:170px">\r\n                </el-date-picker>\r\n              </el-form-item>\r\n\r\n              <el-form-item>\r\n                <el-select v-model="queryParams.device" clearable filterable placeholder="设备"\r\n                           size="small">\r\n                  <el-option\r\n                    v-for="item in deviceOptions"\r\n                    :key="item.value"\r\n                    :label="item.label"\r\n                    :value="item.value">\r\n                  </el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-select v-model="queryParams.isksjk" clearable filterable placeholder="快速借款"\r\n                           size="small">\r\n                  <el-option\r\n                    v-for="item in ksjkOptions"\r\n                    :key="item.value"\r\n                    :label="item.label"\r\n                    :value="item.value">\r\n                  </el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-button type="primary" @click="onSubmit" size="small" style="margin-top:0">查询\r\n                </el-button>\r\n              </el-form-item>\r\n            </el-form>\r\n            <el-button class="right mb-10" type="primary" size="small" icon="el-icon-document"\r\n                       @click="exportExcel">导出excel\r\n            </el-button>\r\n          </div>\r\n          <template slot="columns">\r\n            <el-table-column type="index" label="序号" width="60"></el-table-column>\r\n            <el-table-column sortable prop="date" label="日期" width="120"></el-table-column>\r\n\r\n            <el-table-column sortable prop="plat" label="设备" width="100"></el-table-column>\r\n            <el-table-column sortable prop="ksjk_existing" label="快速借款用户" width="120"></el-table-column>\r\n            <el-table-column sortable prop="activation_count" label="激活"></el-table-column>\r\n            <el-table-column sortable prop="register_count" label="注册"></el-table-column>\r\n            <el-table-column sortable prop="jinjian" label="当日进件"></el-table-column>\r\n            <el-table-column sortable prop="approval" label="当日审核"></el-table-column>\r\n            <el-table-column sortable prop="emitCn" label="当日放款"></el-table-column>\r\n            <el-table-column sortable prop="emitMoney" label="放款金额"></el-table-column>\r\n            <el-table-column sortable prop="act_reg_rate" label="注册/激活" width="90"></el-table-column>\r\n            <el-table-column sortable prop="jj_reg_rate" label="进件/注册" width="90"></el-table-column>\r\n            <el-table-column sortable prop="review_jinj_rate" label="审核/进件" width="90"></el-table-column>\r\n\r\n            <el-table-column sortable prop="jinjian_t7" label="T7进件" ></el-table-column>\r\n            <el-table-column sortable prop="approval_t7" label="T7审核" ></el-table-column>\r\n            <el-table-column sortable prop="emitCn_t7" label="T7放款" ></el-table-column>\r\n            <el-table-column sortable prop="emitMoney_t7" label="T7放款金额" ></el-table-column>\r\n\r\n          </template>\r\n        </data-table>\r\n      </template>\r\n    </tab-page>\r\n  </div>\r\n</template>\r\n<style scoped>\r\n  .el-form-item__content .el-button {\r\n    margin-top: 20px;\r\n  }\r\n\r\n  .el-table--border th {\r\n    text-align: center;\r\n  }\r\n\r\n  .el-table th .cell {\r\n    text-align: center;\r\n  }\r\n\r\n  .el-form--inline .el-form-item {\r\n    margin-right: 2px;\r\n  }\r\n\r\n  .el-form-item {\r\n    margin-bottom: 2px;\r\n  }\r\n\r\n  .el-dialog__footer {\r\n    padding: 10px 0px;\r\n    text-align: center;\r\n  }\r\n\r\n  .check-all-select {\r\n    padding: 10px;\r\n  }\r\n\r\n  .check-all-select span.text-all {\r\n    font-size: 14px;\r\n    font-weight: bold;\r\n  }\r\n\r\n  .check-all-select label {\r\n    float: right;\r\n  }\r\n\r\n  .mb-10 {\r\n    margin-bottom: 10px;\r\n  }\r\n</style>\r\n<script>\r\n//  import common from \'../../../utils/common\'\r\n  import formatDate from \'../../../utils/formatDate\'\r\n  import DataTable from "../../../components/DataTable"\r\n  import TabPage from "../../../components/TabPage"\r\n  export default{\r\n    components: {\r\n      DataTable,\r\n      TabPage,\r\n    },\r\n    data(){\r\n      return {\r\n        deviceCheckAll: false,\r\n        deviceOptions: [\r\n          {\r\n            value: \'iOS\',\r\n            label: \'iOS\'\r\n          },\r\n          {\r\n            value: \'Android\',\r\n            label: \'Android\'\r\n          }\r\n        ],\r\n        ksjkOptions: [\r\n          {\r\n            value: \'是\',\r\n            label: \'是\'\r\n          },\r\n          {\r\n            value: \'否\',\r\n            label: \'否\'\r\n          }\r\n        ],\r\n        initBeginTime: \'\',\r\n        initEndTime: \'\',\r\n\r\n        queryParams: {\r\n          device: \'\',\r\n          isksjk: \'\',\r\n          beginTime: \'\',//开始时间\r\n          endTime: \'\',//结束时间\r\n        },\r\n        dataTable: {\r\n          pageSize: 50,\r\n          pageSizes: [10, 20, 50, 100, 1000,5000,10000,20000],\r\n          url: "/web/v1/market/queryMarket",    //代付管理\r\n          emptyText: \'没有记录\',\r\n          showSummary: true,\r\n          summaryMethod: this.getSummaries,\r\n        },\r\n      }\r\n    },\r\n    mounted(){\r\n      this.dataTable.queryParams = this.queryParams;\r\n      let date = new Date();\r\n      let beginDate = new Date(date.setDate(date.getDate() - 7));\r\n      this.initBeginTime = this.dealDate(beginDate);\r\n      this.initEndTime = this.dealDate(new Date());\r\n      this.dataTable.queryParams.beginTime = this.initBeginTime + \' 00:00:00\';\r\n      this.dataTable.queryParams.endTime = this.initEndTime + \' 23:59:59\';\r\n\r\n      var defaultPage = {label: "市场类总计", name: "h5Statistics", slotName: \'h5Statistics\', closable: false};\r\n      this.$refs.tabPage.$emit("open-tab", defaultPage);\r\n    },\r\n    methods: {\r\n      loadLists(){\r\n        this.$refs.dataTable.$emit(\'load-data\');\r\n      },\r\n      onSubmit: function () {\r\n        this.dataTable.queryParams = this.queryParams;\r\n        var tag = this.warnTime(this.dataTable.queryParams.beginTime, this.dataTable.queryParams.endTime);\r\n        if (tag) {\r\n          return;\r\n        }\r\n        //console.log(Object.prototype.toString.call(this.dataTable.queryParams.beginTime));\r\n        this.dataTable.queryParams.beginTime = this.dealDate(this.dataTable.queryParams.beginTime) + \' 00:00:00\';\r\n        this.dataTable.queryParams.endTime = this.dealDate(this.dataTable.queryParams.endTime) + \' 23:59:59\';\r\n\r\n        this.dataTable.url = \'/web/v1/market/queryMarket\';\r\n        this.$refs.dataTable.$emit(\'load-data\');\r\n      },\r\n      warnTime(startTime, endTime){\r\n        if (!startTime) {\r\n          this.$notify({\r\n            message: \'查询开始时间不能为空！\',\r\n            type: \'warning\'\r\n          });\r\n          return true;\r\n        }\r\n        if (!endTime) {\r\n          this.$notify({\r\n            message: \'查询结束时间不能为空！\',\r\n            type: \'warning\'\r\n          });\r\n          return true;\r\n        }\r\n        let timeStart = new Date(startTime).getTime();\r\n        let timeEnd = new Date(endTime).getTime();\r\n        if (timeStart > timeEnd) {\r\n          this.$notify({\r\n//                        title: \'警告\',\r\n            message: \'查询开始时间不能大于结束时间\',\r\n            type: \'warning\'\r\n          });\r\n          return true;\r\n        }\r\n        return false;\r\n      },\r\n      dealTime(time){\r\n        return formatDate(new Date(time), \'yyyy-MM-dd hh:mm:ss\');\r\n      },\r\n      formatterDate(row, column){\r\n        return formatDate(row.date, \'yyyy-MM-dd\');\r\n      },\r\n      dealDate(date){\r\n        return formatDate(new Date(date), \'yyyy-MM-dd\');\r\n      },\r\n      getSummaries (param) {\r\n        const {columns, data} = param;\r\n        const sums = [];\r\n        columns.forEach((column, index) => {\r\n          if (index === 0) {\r\n            sums[index] = \'总计\';\r\n            return;\r\n          }\r\n          var values;\r\n          if(index === 10||index === 11||index === 12){\r\n             values = data.map(item =>{\r\n               if(item[column.property]!==null){\r\n                 return Number(item[column.property].replace(\'%\',\'\'));\r\n               }\r\n             });\r\n          }else{\r\n            values = data.map(item => Number(item[column.property]));\r\n          }\r\n\r\n          if (!values.every(value => isNaN(value))) {\r\n            sums[index] = values.reduce((prev, curr) => {\r\n              const value = Number(curr);\r\n              if (!isNaN(value)) {\r\n                return prev + curr;\r\n              } else {\r\n                return prev;\r\n              }\r\n            }, 0);\r\n            if(index==10||index==11||index==12){\r\n              sums[index]=(sums[index]/data.length).toFixed(2)+ \' %\';\r\n            }\r\n            //sums[index] += \' 元\';\r\n          } else {\r\n            sums[index] = \'N/A\';\r\n          }\r\n        });\r\n\r\n        return sums;\r\n      },\r\n\r\n      exportExcel() {\r\n        let self=this;\r\n        var exportParams = {};\r\n        Object.assign(exportParams, this.dataTable.queryParams);\r\n        exportParams.pageSize = this.$refs.dataTable.total;\r\n        exportParams.page = 1;\r\n        this.$refs.dataTable.$emit(\'export-data\',exportParams);\r\n        require.ensure([], () => {\r\n          const {export_json_to_excel} = require(\'vendor/Export2Excel\');\r\n          const tHeader = [\'日期\',\r\n            \'T7进件\',\r\n            \'T7审核\',\r\n            \'T7放款\',\r\n            \'T7放款金额\',\r\n            \'设备\', \'快速借款用户\', \'手机号\', \'注册\', \'激活\', \'进件\', \'审核\', \'放款\', \'放款金额\', \'注册/激活\', \'进件/注册\', \'审核/进件\'];\r\n          const filterVal = [\'date\',\r\n            \'jinjian_t7\',\r\n            \'approval_t7\',\r\n            \'emitCn_t7\',\r\n            \'emitMoney_t7\',\r\n            \'plat\', \'ksjk_existing\', \'phones_count\', \'register_count\', \'activation_count\', \'jinjian\', \'approval\', \'emitCn\', \'emitMoney\', \'act_reg_rate\', \'jj_reg_rate\', \'review_jinj_rate\'];\r\n          setTimeout(() => {\r\n            const list = this.$refs.dataTable.dataListA;\r\n            const data = this.formatJson(filterVal, list);\r\n            export_json_to_excel(tHeader, data, \'市场类总计\');\r\n          }, 300);\r\n\r\n        })\r\n      },\r\n      formatJson(filterVal, jsonData) {\r\n        return jsonData.map(v => filterVal.map(j => {\r\n          let returnValue;\r\n          if (j == \'operator\') {\r\n            returnValue = v[j].name;\r\n          } else {\r\n            returnValue = v[j];\r\n          }\r\n          return returnValue;\r\n        }))\r\n      },\r\n\r\n      checkAllSelection(selectType){\r\n        let len = this.$refs[selectType].optionsCount;\r\n        for (var i = 0; i < len; i++) {\r\n          (function (index, _this) {\r\n            setTimeout(() => {\r\n              _this.$refs[selectType].handleOptionSelect(_this.$refs[selectType].options[index]);\r\n            }, 0);\r\n\r\n          })(i, this);\r\n        }\r\n        ;\r\n      },\r\n      handleCheckAllDeviceChange(event) {\r\n        this.checkAllSelection("deviceSelect");\r\n        this.deviceCheckAll = !this.deviceCheckAll;\r\n      },\r\n      setCheckAllStyle(selectedCount, selectType){\r\n        let type = selectType + \'CheckAll\';\r\n        let type_1 = selectType + \'Select\';\r\n        if (this[type]) {\r\n          if (selectedCount.length < this.$refs[type_1].optionsCount) {\r\n            this[type] = !this[type];\r\n          }\r\n        } else {\r\n          if (selectedCount.length === this.$refs[type_1].optionsCount) {\r\n            this[type] = !this[type];\r\n          }\r\n        }\r\n      },\r\n      deviceChange(values){\r\n        this.setCheckAllStyle(values, "device");\r\n      },\r\n    },\r\n  }\r\n<\/script>\r\n<style>\r\n  .span-style {\r\n    display: inline-block;\r\n    margin-top: 8px;\r\n    font-size: 14px;\r\n  }\r\n</style>\r\n']}])}}]);
//# sourceMappingURL=45.44f244cfdd356ba74bd6.js.map